!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(mv){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(mv),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=l=l||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ie={})[l.DEBUG]="log",Ie[l.VERBOSE]="log",Ie[l.INFO]="info",Ie[l.WARN]="warn",Ie[l.ERROR]="error",Ie),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A={},S=x||self;function O(){}function k(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,C)&&t[C]||(t[C]=++L))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Q,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=S.navigator;if(J){J=J.userAgent;if(J){Q=J;break t}}Q=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=O;var rt,it=Y(Q,"Opera"),ot=Y(Q,"Trident")||Y(Q,"MSIE"),st=Y(Q,"Edge"),ut=st||ot,at=Y(Q,"Gecko")&&!(Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge"))&&!(Y(Q,"Trident")||Y(Q,"MSIE"))&&!Y(Q,"Edge"),ct=Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=Q,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=W(String(rt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",O,e),S.removeEventListener("test",O,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},F(bt,wt);var _t={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function xt(t){this.src=t,this.a={},this.b=0}function At(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),kt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[Et]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Et]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[Ot]=c=new xt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?At(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(At(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Nt(t)))}function Lt(t){return t in kt?kt[t]:kt[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(vt)return Rt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Rt(t,e=new bt(e,this))}function Mt(t){return(t=t[Ot])instanceof xt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==k(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function Ft(){q.call(this),this.c=new xt(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Bt(o,r,!0,e)&&s;if(s=Bt(o=e.a=t,r,!0,e)&&s,s=Bt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Bt(o=e.a=n[i],r,!1,e)&&s}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&At(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,q),Ft.prototype[Et]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},N.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=S.JSON.stringify;function zt(){this.b=this.a=null}var Kt,Ht=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Wt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then($t)}),Xt||(Kt(),Xt=!0),Jt.add(t,e)}zt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new zt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=M(this.Xa,this),this.g=j()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==k(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Zt,Ft),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(I(re=ue,ie=ne=q),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){q.call(this),this.b=t,this.a={}}F(ae,q);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function le(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var de=null;function ye(){return de=de||new Ft}function ve(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ye();qt(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function _e(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(ve,wt),F(me,wt),F(be,wt);var Ee={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ie={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Te(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function xe(){}Te.prototype.a=null;var Ae,x={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Se(){wt.call(this,"d")}function Oe(){wt.call(this,"c")}function ke(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(Se,wt),F(Oe,wt),F(ke,Te),Ae=new ke;var Pe=45e3,Ce={},Le={};function Re(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=j(),Ue(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Ce:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ce){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),qe(t))}function Ue(t){t.T=j()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(M(t.Ta,t),e)}function Fe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(M(u.Qa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=De.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),qe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Me(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},N.Ua=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},N.cancel=function(){this.A=!0,Be(this)},N.Ta=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,qe(this)):je(this,this.T-n)},(N=Ke.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return He(this),this.a.concat()},N.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},N.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ye(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function yn(t,e){return pn(t),e=gn(t,e),Qe(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),K(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function xn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Sn(){this.a=new An}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=xn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var kn=S.JSON.parse;function Dn(t){Ft.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}F(Dn,Ft);var Pn="",Cn=/^https?$/i,Ln=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Un(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))ee(t.za,0,t);else if(qt(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Pa=Gn("retryDelaySeedMs",1e4,t),this.Ka=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=j(),Ue(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Qn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Yn(t)}function Yn(t){_n(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Re(n,r,e)}function Jn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;P(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(M(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new De(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,qt(i=ye(),new be(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=_e(M(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Wa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=U(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(On,o,i,"TestLoadImage: error",!1,r),i.onabort=U(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(On,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Qn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==xn(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Xe(s):new Ye(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.La)).F=t.C,e}function hr(){}function fr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Oe.call(this),this.status=1}function yr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Ae),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Dn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Sa())},N.Sa=function(){Un(this)},N.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=zn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(M(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Yn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.l?((e={}).__data__=Gt(t),Wn(this.a,e)):Wn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},F(pr,Se),F(dr,Oe),F(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(xe.EventType=x).OPEN="a",x.CLOSE="b",x.ERROR="c",x.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Oa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.W,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var vr=Ee,gr=Ie,mr=xe,wr=Dn,br=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ir=(Object.defineProperty(Nr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Nr.prototype.isEqual=function(t){return t instanceof Nr&&t.projectId===this.projectId&&t.database===this.database},Nr),Tr=new h("@firebase/firestore");function Nr(t,e){this.projectId=t,this.database=e||"(default)"}function xr(){return Tr.logLevel}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.DEBUG&&(e=n.map(kr),Tr.debug.apply(Tr,i(["Firestore (8.0.2): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.ERROR&&(e=n.map(kr),Tr.error.apply(Tr,i(["Firestore (8.0.2): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.WARN&&(e=n.map(kr),Tr.warn.apply(Tr,i(["Firestore (8.0.2): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Dr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.0.2) INTERNAL ASSERTION FAILED: "+t;throw Sr(t),new Error(t)}function Pr(t){t||Dr()}var Cr=(Lr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Lr);function Lr(){}function Rr(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Mr(t){return t+"\0"}function Ur(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Fr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var qr,Br,Gr,zr=(si.prototype.get=function(t){var e=this.h(t),e=this._[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.l(o,t))return i}},si.prototype.has=function(t){return void 0!==this.get(t)},si.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},si.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},si.prototype.forEach=function(s){jr(this._,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},si.prototype.T=function(){return Fr(this._)},si),Kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Hr=(n(oi,Gr=Error),oi),Qr=(ii.now=function(){return ii.fromMillis(Date.now())},ii.fromDate=function(t){return ii.fromMillis(t.getTime())},ii.fromMillis=function(t){var e=Math.floor(t/1e3);return new ii(e,1e6*(t-1e3*e))},ii.prototype.toDate=function(){return new Date(this.toMillis())},ii.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ii.prototype.I=function(t){return this.seconds===t.seconds?Rr(this.nanoseconds,t.nanoseconds):Rr(this.seconds,t.seconds)},ii.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ii.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ii.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ii.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ii),Wr=(ri.m=function(t){return new ri(t)},ri.min=function(){return new ri(new Qr(0,0))},ri.prototype.A=function(t){return this.timestamp.I(t.timestamp)},ri.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ri.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ri.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ri.prototype.P=function(){return this.timestamp},ri),Ee=(Object.defineProperty(ni.prototype,"length",{get:function(){return this.g},enumerable:!1,configurable:!0}),ni.prototype.isEqual=function(t){return 0===ni.V(this,t)},ni.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ni?t.forEach(function(t){e.push(t)}):e.push(t),this.p(e)},ni.prototype.limit=function(){return this.offset+this.length},ni.prototype.v=function(t){return t=void 0===t?1:t,this.p(this.segments,this.offset+t,this.length-t)},ni.prototype.S=function(){return this.p(this.segments,this.offset,this.length-1)},ni.prototype.D=function(){return this.segments[this.offset]},ni.prototype.C=function(){return this.get(this.length-1)},ni.prototype.get=function(t){return this.segments[this.offset+t]},ni.prototype.T=function(){return 0===this.length},ni.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ni.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ni.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ni.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},ni.V=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ni),Yr=(n(ei,Br=Ee),ei.prototype.p=function(t,e,n){return new ei(t,e,n)},ei.prototype.M=function(){return this.O().join("/")},ei.prototype.toString=function(){return this.M()},ei.k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ei(n)},ei.$=function(){return new ei([])},ei),Xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Jr=(n(ti,qr=Ee),ti.prototype.p=function(t,e,n){return new ti(t,e,n)},ti.L=function(t){return Xr.test(t)},ti.prototype.M=function(){return this.O().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ti.L(t)||(t="`"+t+"`"),t}).join(".")},ti.prototype.toString=function(){return this.M()},ti.prototype.B=function(){return 1===this.length&&"__name__"===this.get(0)},ti.q=function(){return new ti(["__name__"])},ti.U=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Hr(Kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Hr(Kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Hr(Kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ti(e)},ti.$=function(){return new ti([])},ti),$r=(Zr.K=function(t){return new Zr(Yr.k(t))},Zr.W=function(t){return new Zr(Yr.k(t).v(5))},Zr.prototype.j=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Zr.prototype.isEqual=function(t){return null!==t&&0===Yr.V(this.path,t.path)},Zr.prototype.toString=function(){return this.path.toString()},Zr.V=function(t,e){return Yr.V(t.path,e.path)},Zr.G=function(t){return t.length%2==0},Zr.H=function(t){return new Zr(new Yr(t.slice()))},Zr);function Zr(t){this.path=t}function ti(){return null!==qr&&qr.apply(this,arguments)||this}function ei(){return null!==Br&&Br.apply(this,arguments)||this}function ni(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.g=n}function ri(t){this.timestamp=t}function ii(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function oi(t,e){var n=this;return(n=Gr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function si(t,e){this.h=t,this.l=e,this._={}}function ui(t){return null==t}function ai(t){return 0===t&&1/t==-1/0}function ci(t){return"number"==typeof t&&Number.isInteger(t)&&!ai(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var hi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.J=null};function fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new hi(t,e,n,r,i,o,s)}function li(t){var e=t;return null===e.J&&(t=e.path.M(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.M()+t.op.toString()+po(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.M()+t.dir}).join(","),ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Qu(e.startAt)),e.endAt&&(t+="|ub:",t+=Qu(e.endAt)),e.J=t),e.J}function pi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!co(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Yu(t.startAt,e.startAt)&&Yu(t.endAt,e.endAt)}function di(t){return $r.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.Y,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Y)},vi.prototype.X=function(){return 2*this.Y.length},vi.prototype.A=function(t){return Rr(this.Y,t.Y)},vi.prototype.isEqual=function(t){return this.Y===t.Y},vi);function vi(t){this.Y=t}yi.Z=new yi("");function gi(t){this.count=t}var mi,wi=(bi.prototype.nt=function(t){return new bi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bi.prototype.st=function(t,e){return new bi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bi.prototype.it=function(t){return new bi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},bi);function bi(t,e,n,r,i,o,s){void 0===i&&(i=Wr.min()),void 0===o&&(o=Wr.min()),void 0===s&&(s=yi.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function _i(t){switch(t){case Kr.OK:return Dr(),0;case Kr.CANCELLED:case Kr.UNKNOWN:case Kr.DEADLINE_EXCEEDED:case Kr.RESOURCE_EXHAUSTED:case Kr.INTERNAL:case Kr.UNAVAILABLE:case Kr.UNAUTHENTICATED:return;case Kr.INVALID_ARGUMENT:case Kr.NOT_FOUND:case Kr.ALREADY_EXISTS:case Kr.PERMISSION_DENIED:case Kr.FAILED_PRECONDITION:case Kr.ABORTED:case Kr.OUT_OF_RANGE:case Kr.UNIMPLEMENTED:case Kr.DATA_LOSS:return 1;default:return Dr(),0}}function Ei(t){if(void 0===t)return Sr("GRPC error has no .code"),Kr.UNKNOWN;switch(t){case mi.OK:return Kr.OK;case mi.CANCELLED:return Kr.CANCELLED;case mi.UNKNOWN:return Kr.UNKNOWN;case mi.DEADLINE_EXCEEDED:return Kr.DEADLINE_EXCEEDED;case mi.RESOURCE_EXHAUSTED:return Kr.RESOURCE_EXHAUSTED;case mi.INTERNAL:return Kr.INTERNAL;case mi.UNAVAILABLE:return Kr.UNAVAILABLE;case mi.UNAUTHENTICATED:return Kr.UNAUTHENTICATED;case mi.INVALID_ARGUMENT:return Kr.INVALID_ARGUMENT;case mi.NOT_FOUND:return Kr.NOT_FOUND;case mi.ALREADY_EXISTS:return Kr.ALREADY_EXISTS;case mi.PERMISSION_DENIED:return Kr.PERMISSION_DENIED;case mi.FAILED_PRECONDITION:return Kr.FAILED_PRECONDITION;case mi.ABORTED:return Kr.ABORTED;case mi.OUT_OF_RANGE:return Kr.OUT_OF_RANGE;case mi.UNIMPLEMENTED:return Kr.UNIMPLEMENTED;case mi.DATA_LOSS:return Kr.DATA_LOSS;default:return Dr()}}(Ie=mi=mi||{})[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var Ii=(Si.prototype.rt=function(t,e){return new Si(this.V,this.root.rt(t,e,this.V).copy(null,null,Ni.ot,null,null))},Si.prototype.remove=function(t){return new Si(this.V,this.root.remove(t,this.V).copy(null,null,Ni.ot,null,null))},Si.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.V(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Si.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.V(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Si.prototype.T=function(){return this.root.T()},Object.defineProperty(Si.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Si.prototype.at=function(){return this.root.at()},Si.prototype.ct=function(){return this.root.ct()},Si.prototype.ut=function(t){return this.root.ut(t)},Si.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Si.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Si.prototype.ht=function(t){return this.root.ht(t)},Si.prototype.lt=function(){return new Ti(this.root,null,this.V,!1)},Si.prototype._t=function(t){return new Ti(this.root,t,this.V,!1)},Si.prototype.ft=function(){return new Ti(this.root,null,this.V,!0)},Si.prototype.dt=function(t){return new Ti(this.root,t,this.V,!0)},Si),Ti=(Ai.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.T();)this.Tt.push(t),t=t.left;return e},Ai.prototype.It=function(){return 0<this.Tt.length},Ai.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Ai),Ni=(xi.prototype.copy=function(t,e,n,r,i){return new xi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},xi.prototype.T=function(){return!1},xi.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},xi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},xi.prototype.min=function(){return this.left.T()?this:this.left.min()},xi.prototype.at=function(){return this.min().key},xi.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},xi.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},xi.prototype.Pt=function(){if(this.left.T())return xi.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},xi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.T()||r.left.gt()||r.left.left.gt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.yt()),r.right.T()||r.right.gt()||r.right.left.gt()||(r=r.vt()),0===e(t,r.key)){if(r.right.T())return xi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},xi.prototype.gt=function(){return this.color},xi.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.bt()),t.left.gt()&&t.left.left.gt()&&(t=t.yt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},xi.prototype.Vt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.yt())).bt()).St()),t},xi.prototype.vt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.yt()).St()),t},xi.prototype.bt=function(){var t=this.copy(null,null,xi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},xi.prototype.yt=function(){var t=this.copy(null,null,xi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},xi.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},xi.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},xi.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw Dr();if(this.right.gt())throw Dr();var t=this.left.Ct();if(t!==this.right.Ct())throw Dr();return t+(this.gt()?0:1)},xi);function xi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:xi.RED,this.left=null!=r?r:xi.EMPTY,this.right=null!=i?i:xi.EMPTY,this.size=this.left.size+1+this.right.size}function Ai(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function Si(t,e){this.V=t,this.root=e||Ni.EMPTY}function Oi(){this.size=0}Ni.EMPTY=null,Ni.RED=!0,Ni.ot=!1,Ni.EMPTY=(Object.defineProperty(Oi.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Oi.prototype.copy=function(t,e,n,r,i){return this},Oi.prototype.rt=function(t,e,n){return new Ni(t,e)},Oi.prototype.remove=function(t,e){return this},Oi.prototype.T=function(){return!0},Oi.prototype.ut=function(t){return!1},Oi.prototype.ht=function(t){return!1},Oi.prototype.at=function(){return null},Oi.prototype.ct=function(){return null},Oi.prototype.gt=function(){return!1},Oi.prototype.Dt=function(){return!0},Oi.prototype.Ct=function(){return 0},new Oi);var ki=(Li.prototype.has=function(t){return null!==this.data.get(t)},Li.prototype.first=function(){return this.data.at()},Li.prototype.last=function(){return this.data.ct()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Li.prototype.indexOf=function(t){return this.data.indexOf(t)},Li.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},Li.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.V(r.key,t[1]))return;e(r.key)}},Li.prototype.xt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},Li.prototype.Ft=function(t){t=this.data._t(t);return t.It()?t.Et().key:null},Li.prototype.lt=function(){return new Di(this.data.lt())},Li.prototype._t=function(t){return new Di(this.data._t(t))},Li.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},Li.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Li.prototype.T=function(){return this.data.T()},Li.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Li.prototype.isEqual=function(t){if(!(t instanceof Li))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.V(r,i))return!1}return!0},Li.prototype.O=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Li.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Li.prototype.copy=function(t){var e=new Li(this.V);return e.data=t,e},Li),Di=(Ci.prototype.Et=function(){return this.Mt.Et().key},Ci.prototype.It=function(){return this.Mt.It()},Ci),Pi=new Ii($r.V);function Ci(t){this.Mt=t}function Li(t){this.V=t,this.data=new Ii(this.V)}var Ri=new Ii($r.V);var Vi=new Ii($r.V),Mi=new ki($r.V);function Ui(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Mi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ji=new ki(Rr);var Fi=(no.Lt=function(t){return new no(t.V)},no.prototype.has=function(t){return null!=this.kt.get(t)},no.prototype.get=function(t){return this.kt.get(t)},no.prototype.first=function(){return this.$t.at()},no.prototype.last=function(){return this.$t.ct()},no.prototype.T=function(){return this.$t.T()},no.prototype.indexOf=function(t){t=this.kt.get(t);return t?this.$t.indexOf(t):-1},Object.defineProperty(no.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),no.prototype.forEach=function(n){this.$t.ut(function(t,e){return n(t),!1})},no.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.rt(t.key,t),e.$t.rt(t,null))},no.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},no.prototype.isEqual=function(t){if(!(t instanceof no))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.lt(),n=t.$t.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},no.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},no.prototype.copy=function(t,e){var n=new no;return n.V=this.V,n.kt=t,n.$t=e,n},no),qi=(eo.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Dr()},eo.prototype.qt=function(){var n=[];return this.Bt.ut(function(t,e){n.push(e)}),n},eo),Bi=(to.jt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new to(t,e,Fi.Lt(e),i,n,r,!0,!1)},Object.defineProperty(to.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),to.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Kt===t.Kt&&this.Qt.isEqual(t.Qt)&&vu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},to),Gi=(Zi.Yt=function(t,e){var n=new Map;return n.set(t,zi.Xt(t,e)),new Zi(Wr.min(),n,ji,Pi,Ui())},Zi),zi=($i.Xt=function(t,e){return new $i(yi.Z,e,Ui(),Ui(),Ui())},$i),Ki=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Hi=function(t,e){this.targetId=t,this.re=e},Qi=function(t,e,n,r){void 0===n&&(n=yi.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Wi=(Object.defineProperty(Ji.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Ji.prototype.fe=function(t){0<t.X()&&(this.he=!0,this.ce=t)},Ji.prototype.de=function(){var n=Ui(),r=Ui(),i=Ui();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Dr()}}),new zi(this.ce,this.ue,n,r,i)},Ji.prototype.we=function(){this.he=!1,this.ae=io()},Ji.prototype.Te=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},Ji.prototype.Ee=function(t){this.he=!0,this.ae=this.ae.remove(t)},Ji.prototype.Ie=function(){this.oe+=1},Ji.prototype.me=function(){--this.oe},Ji.prototype.Ae=function(){this.he=!0,this.ue=!0},Ji),Yi=(Xi.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Js?this.ve(r,t.ie):t.ie instanceof $s&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Xi.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.me(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.me(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.xe(t),e.fe(n.resumeToken));break;default:Dr()}})},Xi.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},Xi.prototype.Fe=function(t){var e=t.targetId,n=t.re.count,t=this.Oe(e);t&&(di(t=t.target)?0===n?(t=new $r(t.path),this.be(e,t,new $s(t,Wr.min()))):Pr(1===n):this.Me(e)!==n&&(this.xe(e),this.ye=this.ye.add(e)))},Xi.prototype.ke=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.Oe(e);n&&(t.Zt&&di(n.target)&&(n=new $r(n.target.path),null!==i.ge.get(n)||i.$e(e,n)||i.be(e,n,new $s(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=Ui();this.Ve.forEach(function(t,e){var n=!0;e.xt(function(t){t=i.Oe(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new Gi(r,o,this.ye,this.ge,s);return this.ge=Pi,this.Ve=ro(),this.ye=new ki(Rr),t},Xi.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.$e(t,e.key)?2:0,this.Ce(t).Te(e.key,n),this.ge=this.ge.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Le(e.key).add(t)))},Xi.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.$e(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n)))},Xi.prototype.removeTarget=function(t){this.Pe.delete(t)},Xi.prototype.Me=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},Xi.prototype.Ie=function(t){this.Ce(t).Ie()},Xi.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Wi,this.Pe.set(t,e)),e},Xi.prototype.Le=function(t){var e=this.Ve.get(t);return e||(e=new ki(Rr),this.Ve=this.Ve.rt(t,e)),e},Xi.prototype.Ne=function(t){var e=null!==this.Oe(t);return e||Ar("WatchChangeAggregator","Detected inactive target",t),e},Xi.prototype.Oe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},Xi.prototype.xe=function(e){var n=this;this.Pe.set(e,new Wi),this.Re.Be(e).forEach(function(t){n.be(e,t,null)})},Xi.prototype.$e=function(t,e){return this.Re.Be(t).has(e)},Xi);function Xi(t){this.Re=t,this.Pe=new Map,this.ge=Pi,this.Ve=ro(),this.ye=new ki(Rr)}function Ji(){this.oe=0,this.ae=io(),this.ce=yi.Z,this.ue=!1,this.he=!0}function $i(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Zi(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function to(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Kt=s,this.Wt=u}function eo(){this.Bt=new Ii($r.V)}function no(n){this.V=n?function(t,e){return n(t,e)||$r.V(t.key,e.key)}:function(t,e){return $r.V(t.key,e.key)},this.kt=Ri,this.$t=new Ii(this.V)}function ro(){return new Ii($r.V)}function io(){return new Ii($r.V)}function oo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function so(t){t=yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Qr(t.seconds,t.nanos)}var uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oo(t)?4:10:Dr()}function co(r,i){var t,e=ao(r);if(e!==ao(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return so(r).isEqual(so(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=yo(r.timestampValue),t=yo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,go(r.bytesValue).isEqual(go(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,vo((t=r).geoPointValue.latitude)===vo(e.geoPointValue.latitude)&&vo(t.geoPointValue.longitude)===vo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vo(t.integerValue)===vo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=vo(t.doubleValue),e=vo(e.doubleValue);return t===e?ai(t)===ai(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],co);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ur(e)!==Ur(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!co(e[t],n[t])))return!1;return!0}();default:return Dr()}}function ho(t,e){return void 0!==(t.values||[]).find(function(t){return co(t,e)})}function fo(t,e){var n,r,i=ao(t),o=ao(e);if(i!==o)return Rr(i,o);switch(i){case 0:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return n=e,r=vo(t.integerValue||t.doubleValue),n=vo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return lo(t.timestampValue,e.timestampValue);case 4:return lo(so(t),so(e));case 5:return Rr(t.stringValue,e.stringValue);case 6:return function(t,e){t=go(t),e=go(e);return t.A(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Rr(n[i],r[i]);if(0!==o)return o}return Rr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Rr(vo(i.latitude),vo(r.latitude)))?n:Rr(vo(i.longitude),vo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=fo(n[i],r[i]);if(o)return o}return Rr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Rr(r[s],o[s]);if(0!==u)return u;u=fo(n[r[s]],i[o[s]]);if(0!==u)return u}return Rr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function lo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Rr(t,e);var n=yo(t),t=yo(e),e=Rr(n.seconds,t.seconds);return 0!==e?e:Rr(n.nanos,t.nanos)}function po(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=yo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?go(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,$r.W(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Dr();var e}(t)}function yo(t){if(Pr(!!t),"string"!=typeof t)return{seconds:vo(t.seconds),nanos:vo(t.nanos)};var e=0,n=uo.exec(t);Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function vo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function go(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function mo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.M()}}function wo(t){return t&&"integerValue"in t}function bo(t){return!!t&&"arrayValue"in t}function _o(t){return t&&"nullValue"in t}function Eo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Io(t){return t&&"mapValue"in t}var To={asc:"ASCENDING",desc:"DESCENDING"},No={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xo=function(t,e){this.t=t,this.Ue=e};function Ao(t){return{integerValue:""+t}}function So(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(e)?"-0":e}}function Oo(t,e){return ci(e)?Ao(e):So(t,e)}function ko(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Do(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function Po(t){return Pr(!!t),Wr.m((t=yo(t),new Qr(t.seconds,t.nanos)))}function Co(t,e){return new Yr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).M()}function Lo(t){t=Yr.k(t);return Pr($o(t)),t}function Ro(t,e){return Co(t.t,e.path)}function Vo(t,e){e=Lo(e);if(e.get(1)!==t.t.projectId)throw new Hr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Hr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new $r(Fo(e))}function Mo(t,e){return Co(t.t,e)}function Uo(t){t=Lo(t);return 4===t.length?Yr.$():Fo(t)}function jo(t){return new Yr(["projects",t.t.projectId,"databases",t.t.database]).M()}function Fo(t){return Pr(4<t.length&&"documents"===t.get(4)),t.v(5)}function qo(t,e,n){return{name:Ro(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n,r,i;if(e instanceof Os)n={update:qo(t,e.key,e.value)};else if(e instanceof Fs)n={delete:Ro(t,e.key)};else if(e instanceof ks)n={update:qo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.M())}),{fieldPaths:r})};else if(e instanceof Rs)n={transform:{document:Ro(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ns)return{fieldPath:t.field.M(),setToServerValue:"REQUEST_TIME"};if(e instanceof rs)return{fieldPath:t.field.M(),appendMissingElements:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.M(),removeAllFromArray:{values:e.elements}};if(e instanceof ls)return{fieldPath:t.field.M(),increment:e.Ke};throw Dr()})}};else{if(!(e instanceof qs))return Dr();n={verify:Ro(t,e.key)}}return e.je.We||(n.currentDocument=void 0!==(i=e.je).updateTime?{updateTime:(e=t,t=i.updateTime,ko(e,t.P()))}:void 0!==i.exists?{exists:i.exists}:Dr()),n}function Go(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?bs.updateTime(Po(o.updateTime)):void 0!==o.exists?bs.exists(o.exists):bs.Ge():bs.Ge();if(t.update){t.update.name;var r=Vo(e,t.update.name),i=new Bs({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new vs(o.map(function(t){return Jr.U(t)})));return new ks(r,i,o,n)}return new Os(r,i,n)}if(t.delete){var s=Vo(e,t.delete);return new Fs(s,n)}if(t.transform){i=Vo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Pr("REQUEST_TIME"===e.setToServerValue),r=new ns):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new rs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new as(n)):"increment"in e?r=new ls(t,e.increment):Dr();e=Jr.U(e.fieldPath);return new gs(e,r)}(e,t)});return Pr(!0===n.exists),new Rs(i,s)}if(t.verify){t=Vo(e,t.verify);return new qs(t,n)}return Dr()}function zo(t,e){return{documents:[Mo(t,e.path)]}}function Ko(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Mo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Mo(t,r.S()),n.structuredQuery.from=[{collectionId:r.C()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Eo(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NAN"}};if(_o(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Eo(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NOT_NAN"}};if(_o(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yo(t.field),op:(e=t.op,No[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Yo((t=t).field),direction:(t=t.dir,To[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ue||ui(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Qo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Qo(e.endAt)),n}function Ho(t){var e=Uo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[Jo(t)]:void 0!==t.fieldFilter?[(n=t,Eu.create(Xo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Dr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Dr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Xu(Xo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Wo(n.startAt));var u=null;return n.endAt&&(u=Wo(n.endAt)),iu(e,i,t,o,r,"F",s,u)}function Qo(t){return{before:t.before,values:t.position}}function Wo(t){var e=!!t.before,t=t.values||[];return new Bu(t,e)}function Yo(t){return{fieldPath:t.M()}}function Xo(t){return Jr.U(t.fieldPath)}function Jo(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Xo(t.unaryFilter.field);return Eu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Xo(t.unaryFilter.field);return Eu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=Xo(t.unaryFilter.field);return Eu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=Xo(t.unaryFilter.field);return Eu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Dr()}}function $o(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.ze=void 0};function Zo(t,e){return t instanceof ls?wo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ts,es,ns=(n(os,es=h),os),rs=(n(is,ts=h),is);function is(t){var e=this;return(e=ts.call(this)||this).elements=t,e}function os(){return null!==es&&es.apply(this,arguments)||this}function ss(t,e){for(var n=ys(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return co(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var us,as=(n(cs,us=h),cs);function cs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function hs(t,e){for(var n=ys(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!co(t,e)})}(i[r]);return{arrayValue:{values:n}}}var fs,ls=(n(ps,fs=h),ps);function ps(t,e){var n=this;return(n=fs.call(this)||this).serializer=t,n.Ke=e,n}function ds(t){return vo(t.integerValue||t.doubleValue)}function ys(t){return bo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var vs=(ms.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},ms.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ms),gs=function(t,e){this.field=t,this.transform=e};function ms(t){(this.fields=t).sort(Jr.V)}function ws(t,e){this.version=t,this.transformResults=e}var bs=(_s.Ge=function(){return new _s},_s.exists=function(t){return new _s(void 0,t)},_s.updateTime=function(t){return new _s(t)},Object.defineProperty(_s.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),_s.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},_s);function _s(t,e){this.updateTime=t,this.exists=e}function Es(t,e){return void 0!==t.updateTime?e instanceof Js&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Js}Ee=function(){};function Is(t,e,n){return t instanceof Os?new Js(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof ks?function(t,e,n){if(!Es(t.je,e))return new Zs(t.key,n.version);e=Cs(t,e);return new Js(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Rs?function(t,e,n){if(Pr(null!=n.transformResults),!Es(t.je,e))return new Zs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Js&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof rs?ss(o,s):o instanceof as?hs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ms(t,r.data(),e);return new Js(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new $s(t.key,n.version,{hasCommittedMutations:!0})}function Ts(t,e,n,r){return t instanceof Os?function(t,e){if(!Es(t.je,e))return e;e=xs(e);return new Js(t.key,e,t.value,{Je:!0})}(t,e):t instanceof ks?function(t,e){if(!Es(t.je,e))return e;var n=xs(e),e=Cs(t,e);return new Js(t.key,n,e,{Je:!0})}(t,e):t instanceof Rs?function(t,e,n,r){if(!Es(t.je,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Js&&(h=n.field(a.field)),null===h&&r instanceof Js&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof ns?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof rs?ss(c,i):c instanceof as?hs(c,i):(c=Zo(h=c,i),i=ds(c)+ds(h.Ke),wo(c)&&wo(h.Ke)?Ao(i):So(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ms(t,i.data(),r);return new Js(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Es((t=t).je,e)?new $s(t.key,Wr.min()):e)}function Ns(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.je.isEqual(e.je)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Vr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof rs&&e instanceof rs||t instanceof as&&e instanceof as?Vr(t.elements,e.elements,co):t instanceof ls&&e instanceof ls?co(t.Ke,e.Ke):t instanceof ns&&e instanceof ns)}))}function xs(t){return t instanceof Js?t.version:Wr.min()}var As,Ss,Os=(n(Ps,Ss=Ee),Ps),ks=(n(Ds,As=Ee),Ds);function Ds(t,e,n,r){var i=this;return(i=As.call(this)||this).key=t,i.data=e,i.Qe=n,i.je=r,i.type=1,i}function Ps(t,e,n){var r=this;return(r=Ss.call(this)||this).key=t,r.value=e,r.je=n,r.type=0,r}function Cs(t,e){return n=t,e=e instanceof Js?e.data():Bs.empty(),r=new Gs(e),n.Qe.fields.forEach(function(t){var e;t.T()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var Ls,Rs=(n(Vs,Ls=Ee),Vs);function Vs(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.je=bs.exists(!0),n}function Ms(t,e,n){for(var r=new Gs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var Us,js,Fs=(n(Qs,js=Ee),Qs),qs=(n(Hs,Us=Ee),Hs),Bs=(Ks.empty=function(){return new Ks({mapValue:{}})},Ks.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Io(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.C()])||null},Ks.prototype.isEqual=function(t){return co(this.proto,t.proto)},Ks),Gs=(zs.prototype.set=function(t,e){return this.tn(t,e),this},zs.prototype.delete=function(t){return this.tn(t,null),this},zs.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ao(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.C(),e)},zs.prototype.Ye=function(){var t=this.en(Jr.$(),this.Ze);return null!=t?new Bs(t):this.Xe},zs.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Io(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},zs);function zs(t){void 0===t&&(t=Bs.empty()),this.Xe=t,this.Ze=new Map}function Ks(t){this.proto=t}function Hs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.je=e,n.type=4,n}function Qs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.je=e,n.type=3,n}var Ws,Ys,Xs,Ie=function(t,e){this.key=t,this.version=e},Js=(n(ru,Xs=Ie),ru.prototype.field=function(t){return this.nn.field(t)},ru.prototype.data=function(){return this.nn},ru.prototype.sn=function(){return this.nn.proto},ru.prototype.isEqual=function(t){return t instanceof ru&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},ru.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ru),$s=(n(nu,Ys=Ie),nu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(nu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),nu.prototype.isEqual=function(t){return t instanceof nu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},nu),Zs=(n(eu,Ws=Ie),eu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(eu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),eu.prototype.isEqual=function(t){return t instanceof eu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},eu),tu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.an=null,this.startAt,this.endAt};function eu(){return null!==Ws&&Ws.apply(this,arguments)||this}function nu(t,e,n){var r=this;return(r=Ys.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ru(t,e,n,r){var i=this;return(i=Xs.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function iu(t,e,n,r,i,o,s,u){return new tu(t,e,n,r,i,o,s,u)}function ou(t){return new tu(t)}function su(t){return!ui(t.limit)&&"F"===t.limitType}function uu(t){return!ui(t.limit)&&"L"===t.limitType}function au(t){return 0<t.rn.length?t.rn[0].field:null}function cu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function hu(t){return null!==t.collectionGroup}function fu(t){var e=t;if(null===e.on){e.on=[];var n=cu(e),t=au(e);if(null!==n&&null===t)n.B()||e.on.push(new Xu(n)),e.on.push(new Xu(Jr.q(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.B()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new Xu(Jr.q(),n)))}}return e.on}function lu(t){var e=t;if(!e.an)if("F"===e.limitType)e.an=fi(e.path,e.collectionGroup,fu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=fu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Xu(o.field,s))}var u=e.endAt?new Bu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Bu(e.startAt.position,!e.startAt.before):null;e.an=fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function pu(t,e,n){return new tu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function du(t,e){return new tu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function yu(t,e){return new tu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function vu(t,e){return pi(lu(t),lu(e))&&t.limitType===e.limitType}function gu(t){return li(lu(t))+"|lt:"+t.limitType}function mu(t){return"Query(target="+(e=lu(t),n=e.path.M(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.M()+" "+t.op+" "+po(t.value)}).join(", ")+"]"),ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.M()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Qu(e.startAt)),e.endAt&&(n+=", endAt: "+Qu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function wu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.j(e.collectionGroup)&&e.path.N(n):$r.G(e.path)?e.path.isEqual(n):e.path.F(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.B()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Wu(t.startAt,fu(t),n))&&(!t.endAt||!Wu(t.endAt,fu(t),n)));var e,n}function bu(u){return function(t,e){for(var n=!1,r=0,i=fu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.B()?$r.V(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?fo(n,t):Dr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Dr()}}(o,t,e);if(0!==s)return s;n=n||o.field.B()}return 0}}var _u,Eu=(n(Iu,_u=function(){}),Iu.create=function(t,e,n){return t.B()?"in"===e||"not-in"===e?this.un(t,e,n):new Au(t,e,n):"array-contains"===e?new Uu(t,n):"in"===e?new ju(t,n):"not-in"===e?new Fu(t,n):"array-contains-any"===e?new qu(t,n):new Iu(t,e,n)},Iu.un=function(t,e,n){return new("in"===e?Su:Ou)(t,n)},Iu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.hn(fo(t,this.value)):null!==t&&ao(this.value)===ao(t)&&this.hn(fo(t,this.value))},Iu.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Dr()}},Iu.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Iu);function Iu(t,e,n){var r=this;return(r=_u.call(this)||this).field=t,r.op=e,r.value=n,r}var Tu,Nu,xu,Au=(n(Pu,xu=Eu),Pu.prototype.matches=function(t){t=$r.V(t.key,this.key);return this.hn(t)},Pu),Su=(n(Du,Nu=Eu),Du.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Du),Ou=(n(ku,Tu=Eu),ku.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ku);function ku(t,e){var n=this;return(n=Tu.call(this,t,"not-in",e)||this).keys=Cu(0,e),n}function Du(t,e){var n=this;return(n=Nu.call(this,t,"in",e)||this).keys=Cu(0,e),n}function Pu(t,e,n){var r=this;return(r=xu.call(this,t,e,n)||this).key=$r.W(n.referenceValue),r}function Cu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return $r.W(t.referenceValue)})}var Lu,Ru,Vu,Mu,Uu=(n(Hu,Mu=Eu),Hu.prototype.matches=function(t){t=t.field(this.field);return bo(t)&&ho(t.arrayValue,this.value)},Hu),ju=(n(Ku,Vu=Eu),Ku.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ho(this.value.arrayValue,t)},Ku),Fu=(n(zu,Ru=Eu),zu.prototype.matches=function(t){if(ho(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ho(this.value.arrayValue,t)},zu),qu=(n(Gu,Lu=Eu),Gu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!bo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ho(e.value.arrayValue,t)})},Gu),Bu=function(t,e){this.position=t,this.before=e};function Gu(t,e){return Lu.call(this,t,"array-contains-any",e)||this}function zu(t,e){return Ru.call(this,t,"not-in",e)||this}function Ku(t,e){return Vu.call(this,t,"in",e)||this}function Hu(t,e){return Mu.call(this,t,"array-contains",e)||this}function Qu(t){return(t.before?"b":"a")+":"+t.position.map(po).join(",")}function Wu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.B()?$r.V($r.W(s.referenceValue),n.key):fo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Yu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!co(t.position[n],e.position[n]))return!1;return!0}var Xu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Ju,$u=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Zu=(aa.prototype.reset=function(){this.Tn=0},aa.prototype.mn=function(){this.Tn=this.wn},aa.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Rn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Ar("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.Pn(this._n,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.dn,this.Tn<this.fn&&(this.Tn=this.fn),this.Tn>this.wn&&(this.Tn=this.wn)},aa.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},aa.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},aa.prototype.Rn=function(){return(Math.random()-.5)*this.Tn},aa),ta=(ua.prototype.catch=function(t){return this.next(void 0,t)},ua.prototype.next=function(r,i){var o=this;return this.bn&&Dr(),this.bn=!0,this.vn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new ua(function(e,n){o.yn=function(t){o.Dn(r,t).next(e,n)},o.pn=function(t){o.Sn(i,t).next(e,n)}})},ua.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ua.prototype.Nn=function(t){try{var e=t();return e instanceof ua?e:ua.resolve(e)}catch(t){return ua.reject(t)}},ua.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):ua.resolve(e)},ua.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):ua.reject(e)},ua.resolve=function(n){return new ua(function(t,e){t(n)})},ua.reject=function(n){return new ua(function(t,e){e(n)})},ua.xn=function(t){return new ua(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ua.Fn=function(t){for(var n=ua.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ua.resolve(t):e()})}(r[e]);return n},ua.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},ua),ea=(sa.delete=function(t){return Ar("SimpleDb","Removing database:",t),da(window.indexedDB.deleteDatabase(t)).Cn()},sa.kn=function(){if("undefined"==typeof indexedDB)return!1;if(sa.$n())return!0;var t=p(),e=sa.Mn(t),n=0<e&&e<10,e=sa.Ln(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},sa.$n=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},sa.qn=function(t,e){return t.store(e)},sa.Mn=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},sa.Ln=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},sa.prototype.Un=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Ar("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new ra(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Hr(Kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ra(o,t))},r.onupgradeneeded=function(t){Ar("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.On.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Ar("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return i.Qn(t)}),this.db)]}})})},sa.prototype.Kn=function(e){this.Qn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},sa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Un(u)];case 2:return s.db=t.sent(),e=ha.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ta.reject(t)}).Cn(),r={},n.catch(function(){}),[4,e.Wn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Ar("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},sa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},sa),na=(Object.defineProperty(oa.prototype,"vn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(oa.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(oa.prototype,"cursor",{set:function(t){this.jn=t},enumerable:!1,configurable:!0}),oa.prototype.done=function(){this.Gn=!0},oa.prototype.Jn=function(t){this.zn=t},oa.prototype.delete=function(){return da(this.jn.delete())},oa),ra=(n(ia,Ju=Hr),ia);function ia(t,e){var n=this;return(n=Ju.call(this,Kr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function oa(t){this.jn=t,this.Gn=!1,this.zn=null}function sa(t,e,n){this.name=t,this.version=e,this.On=n,12.2===sa.Mn(p())&&Sr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ua(t){var e=this;this.yn=null,this.pn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t(function(t){e.vn=!0,e.result=t,e.yn&&e.yn(t)},function(t){e.vn=!0,e.error=t,e.pn&&e.pn(t)})}function aa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function ca(t){return"IndexedDbTransactionError"===t.name}var ha=(pa.open=function(t,e,n,r){try{return new pa(e,t.transaction(r,n))}catch(t){throw new ra(e,t)}},Object.defineProperty(pa.prototype,"Wn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),pa.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(Ar("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},pa.prototype.store=function(t){t=this.transaction.objectStore(t);return new fa(t)},pa),fa=(la.prototype.put=function(t,e){t=void 0!==e?(Ar("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Ar("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return da(t)},la.prototype.add=function(t){return Ar("SimpleDb","ADD",this.store.name,t,t),da(this.store.add(t))},la.prototype.get=function(e){var n=this;return da(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Ar("SimpleDb","GET",n.store.name,e,t),t})},la.prototype.delete=function(t){return Ar("SimpleDb","DELETE",this.store.name,t),da(this.store.delete(t))},la.prototype.count=function(){return Ar("SimpleDb","COUNT",this.store.name),da(this.store.count())},la.prototype.Xn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Zn(e,function(t,e){n.push(e)}).next(function(){return n})},la.prototype.ts=function(t,e){Ar("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.es=!1;e=this.cursor(e);return this.Zn(e,function(t,e,n){return n.delete()})},la.prototype.ns=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Zn(n,e)},la.prototype.ss=function(r){var t=this.cursor({});return new ta(function(n,e){t.onerror=function(t){t=va(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},la.prototype.Zn=function(t,i){var o=[];return new ta(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new na(n),(t=i(n.primaryKey,n.value,e))instanceof ta&&(t=t.catch(function(t){return e.done(),ta.reject(t)}),o.push(t)),e.vn?r():null===e.Hn?n.continue():n.continue(e.Hn)):r()}}).next(function(){return ta.xn(o)})},la.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},la.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},la);function la(t){this.store=t}function pa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Yn=new $u,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){t.error?n.Yn.reject(new ra(e,t.error)):n.Yn.resolve()},this.transaction.onerror=function(t){t=va(t.target.error);n.Yn.reject(new ra(e,t))}}function da(t){return new ta(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=va(t.target.error);n(t)}})}var ya=!1;function va(t){var e=ea.Mn(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Hr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ya||(ya=!0,setTimeout(function(){throw n},0)),n}}return t}function ga(){return"undefined"!=typeof window?window:null}function ma(){return"undefined"!=typeof document?document:null}var wa=(Ea.hs=function(t,e,n,r,i){i=new Ea(t,e,Date.now()+n,r,i);return i.start(n),i},Ea.prototype.start=function(t){var e=this;this.ls=setTimeout(function(){return e._s()},t)},Ea.prototype.Vn=function(){return this._s()},Ea.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.us.reject(new Hr(Kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ea.prototype._s=function(){var e=this;this.rs.fs(function(){return null!==e.ls?(e.clearTimeout(),e.op().then(function(t){return e.us.resolve(t)})):Promise.resolve()})},Ea.prototype.clearTimeout=function(){null!==this.ls&&(this.cs(this),clearTimeout(this.ls),this.ls=null)},Ea),ba=(Object.defineProperty(_a.prototype,"Vs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),_a.prototype.fs=function(t){this.enqueue(t)},_a.prototype.ys=function(t){this.ps(),this.vs(t)},_a.prototype.bs=function(){var t;this.Ts||(this.Ts=!0,(t=ma())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs))},_a.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise(function(t){}):this.vs(t)},_a.prototype.Ss=function(t){var e=this;this.fs(function(){return e.ws.push(t),e.Ds()})},_a.prototype.Ds=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.ws.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return t.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Ar("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ws.length&&this.Ps.An(function(){return n.Ds()}),t.label=5;case 5:return[2]}})})},_a.prototype.vs=function(t){var r=this,e=this.ds.then(function(){return r.As=!0,t().catch(function(t){throw r.Is=t,r.As=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.As=!1,t})});return this.ds=e},_a.prototype.Pn=function(t,e,n){var r=this;this.ps(),-1<this.Rs.indexOf(t)&&(e=0);n=wa.hs(this,t,e,n,function(t){return r.Cs(t)});return this.Es.push(n),n},_a.prototype.ps=function(){this.Is&&Dr()},_a.prototype.Ns=function(){},_a.prototype.xs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.ds)return[3,0];t.label=3;case 3:return[2]}})})},_a.prototype.Fs=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},_a.prototype.Os=function(r){var i=this;return this.xs().then(function(){i.Es.sort(function(t,e){return t.os-e.os});for(var t=0,e=i.Es;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n._n===r)break}return i.xs()})},_a.prototype.Ms=function(t){this.Rs.push(t)},_a.prototype.Cs=function(t){t=this.Es.indexOf(t);this.Es.splice(t,1)},_a);function _a(){var e=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new Zu(this,"async_queue_retry"),this.gs=function(){var t=ma();t&&Ar("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ps.gn()};var t=ma();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.gs)}function Ea(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.cs=i,this.us=new $u,this.then=this.us.promise.then.bind(this.us.promise),this.us.promise.catch(function(t){})}function Ia(t,e){if(Sr("AsyncQueue",e+": "+t),ca(t))return new Hr(Kr.UNAVAILABLE,e+": "+t);throw t}function Ta(){this.queries=new zr(gu,vu),this.onlineState="Unknown",this.$s=new Set}var Na=function(){this.ks=void 0,this.listeners=[]};function xa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Na),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ls(n)];case 2:return o.ks=t.sent(),[3,4];case 3:return o=t.sent(),o=Ia(o,"Initialization of query '"+mu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Bs(e.onlineState),i.ks&&u.qs(i.ks)&&Sa(e),[2]}})})}function Aa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Us(n))]:[2]})})}function Sa(t){t.$s.forEach(function(t){t.next()})}var Oa=(Pa.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Bi(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Kt,!0)}var o=!1;return this.Ks?this.js(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.Ws=t,o},Pa.prototype.onError=function(t){this.Qs.error(t)},Pa.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.Ws&&!this.Ks&&this.Gs(this.Ws,t)&&(this.zs(this.Ws),e=!0),e},Pa.prototype.Gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Hs&&n||t.docs.T()&&"Offline"!==e)},Pa.prototype.js=function(t){if(0<t.docChanges.length)return!0;var e=this.Ws&&this.Ws.hasPendingWrites!==t.hasPendingWrites;return!(!t.Kt&&!e)&&!0===this.options.includeMetadataChanges},Pa.prototype.zs=function(t){t=Bi.jt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.Qs.next(t)},Pa),ka=(Da.prototype.Js=function(){return null!=this.uid},Da.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},Da.prototype.isEqual=function(t){return t.uid===this.uid},Da);function Da(t){this.uid=t}function Pa(t,e,n){this.query=t,this.Qs=e,this.Ks=!1,this.Ws=null,this.onlineState="Unknown",this.options=n||{}}ka.UNAUTHENTICATED=new ka(null),ka.Xs=new ka("google-credentials-uid"),ka.Zs=new ka("first-party-uid");function Ca(t,e){this.user=e,this.type="OAuth",this.ti={},this.ti.Authorization="Bearer "+t}var La=(Ha.prototype.getToken=function(){return Promise.resolve(null)},Ha.prototype.ni=function(){},Ha.prototype.si=function(t){(this.ei=t)(ka.UNAUTHENTICATED)},Ha.prototype.ii=function(){this.ei=null},Ha),Ra=(Ka.prototype.getToken=function(){var e=this,n=this.ai,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ai!==n?(Ar("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new Ca(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ka.prototype.ni=function(){this.forceRefresh=!0},Ka.prototype.si=function(t){this.ei=t,this.oi&&t(this.currentUser)},Ka.prototype.ii=function(){this.auth&&this.auth.removeAuthTokenListener(this.ri),this.ri=null,this.ei=null},Ka.prototype.ci=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new ka(t)},Ka),Va=(Object.defineProperty(za.prototype,"ti",{get:function(){var t={"X-Goog-AuthUser":this.hi},e=this.ui.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),za),Ma=(Ga.prototype.getToken=function(){return Promise.resolve(new Va(this.ui,this.hi))},Ga.prototype.si=function(t){t(ka.Zs)},Ga.prototype.ii=function(){},Ga.prototype.ni=function(){},Ga),Ua=(Ba.prototype._i=function(t,e,n){for(var r=n.fi,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Is(o,e,r[i]))}return e},Ba.prototype.di=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ts(i,e,e,this.li))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ts(a,e,o,this.li))}return e},Ba.prototype.wi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.di(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ui())},Ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,Ns)&&Vr(this.baseMutations,t.baseMutations,Ns)},Ba),ja=(qa.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=Vi,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new qa(t,e,n,r)},qa),h=(Fa.prototype.Ai=function(t){t=this.Ii.get(t);return t?t.readTime:Wr.min()},Fa.prototype.Ri=function(t,e){this.Pi(),this.Ii.set(t.key,{gi:t,readTime:e})},Fa.prototype.Vi=function(t,e){void 0===e&&(e=null),this.Pi(),this.Ii.set(t,{gi:null,readTime:e})},Fa.prototype.yi=function(t,e){this.Pi();var n=this.Ii.get(e);return void 0!==n?ta.resolve(n.gi):this.pi(t,e)},Fa.prototype.getEntries=function(t,e){return this.vi(t,e)},Fa.prototype.apply=function(t){return this.Pi(),this.mi=!0,this.bi(t)},Fa.prototype.Pi=function(){},Fa);function Fa(){this.Ii=new zr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mi=!1}function qa(t,e,n,r){this.batch=t,this.Ti=e,this.fi=n,this.Ei=r}function Ba(t,e,n,r){this.batchId=t,this.li=e,this.baseMutations=n,this.mutations=r}function Ga(t,e){this.ui=t,this.hi=e}function za(t,e){this.ui=t,this.hi=e,this.type="FirstParty",this.user=ka.Zs}function Ka(t){var e=this;this.ri=null,this.currentUser=ka.UNAUTHENTICATED,this.oi=!1,this.ai=0,this.ei=null,this.forceRefresh=!1,this.ri=function(){e.ai++,e.currentUser=e.ci(),e.oi=!0,e.ei&&e.ei(e.currentUser)},this.ai=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ri):(this.ri(null),t.get().then(function(t){e.auth=t,e.ri&&e.auth.addAuthTokenListener(e.ri)},function(){}))}function Ha(){this.ei=null}function Qa(t){return new xo(t,!0)}function Wa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Ya="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ee=(nc.prototype.Di=function(t){this.Si.push(t)},nc.prototype.Ci=function(){this.Si.forEach(function(t){return t()})},nc),Xa=(ec.prototype.Oi=function(e,n){var r=this;return this.xi.Mi(e,n).next(function(t){return r.ki(e,n,t)})},ec.prototype.ki=function(t,r,i){return this.Ni.yi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].di(r,t);return t})},ec.prototype.$i=function(t,e,i){var o=Pi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].di(t,e);o=o.rt(t,e)}),o},ec.prototype.Li=function(e,t){var n=this;return this.Ni.getEntries(e,t).next(function(t){return n.Bi(e,t)})},ec.prototype.Bi=function(e,r){var i=this;return this.xi.qi(e,r).next(function(t){var t=i.$i(e,r,t),n=Pi;return t.forEach(function(t,e){e=e||new $s(t,Wr.min()),n=n.rt(t,e)}),n})},ec.prototype.Ui=function(t,e,n){return r=e,$r.G(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Qi(t,e.path):hu(e)?this.Ki(t,e,n):this.Wi(t,e,n);var r},ec.prototype.Qi=function(t,e){return this.Oi(t,new $r(e)).next(function(t){var e=Ri;return t instanceof Js&&(e=e.rt(t.key,t)),e})},ec.prototype.Ki=function(n,r,i){var o=this,s=r.collectionGroup,u=Ri;return this.Fi.ji(n,s).next(function(t){return ta.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new tu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Wi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},ec.prototype.Wi=function(e,n,t){var c,h,r=this;return this.Ni.Ui(e,n,t).next(function(t){return c=t,r.xi.Gi(e,n)}).next(function(t){return h=t,r.zi(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ts(s,a,a,r.li);c=a instanceof Js?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){wu(n,e)||(c=c.remove(t))}),c})},ec.prototype.zi=function(t,e,n){for(var r=Ui(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ks&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Ni.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Js&&(c=c.rt(t,e))}),c})},ec),Ja=(tc.Yi=function(t,e){for(var n=Ui(),r=Ui(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new tc(t,e.fromCache,n,r)},tc),$a=(Za.prototype.Zi=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Za.prototype.next=function(){var t=++this.previousValue;return this.tr&&this.tr(t),t},Za);function Za(t,e){var n=this;this.previousValue=t,e&&(e.Xi=function(t){return n.Zi(t)},this.tr=function(t){return e.er(t)})}function tc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hi=n,this.Ji=r}function ec(t,e,n){this.Ni=t,this.xi=e,this.Fi=n}function nc(){this.Si=[]}function rc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Rr(n,t);return 0===t?Rr(r,e):t}$a.nr=-1;var ic=(ac.prototype.rr=function(){return++this.ir},ac.prototype.ar=function(t){var e=[t,this.rr()];this.buffer.size<this.sr?this.buffer=this.buffer.add(e):rc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(ac.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),ac),oc={cr:!1,ur:0,hr:0,lr:0},sc=(uc.Tr=function(t){return new uc(t,uc.Er,uc.Ir)},uc);function uc(t,e,n){this._r=t,this.dr=e,this.wr=n}function ac(t){this.sr=t,this.buffer=new ki(rc),this.ir=0}sc.Er=10,sc.Ir=1e3,sc.mr=new sc(41943040,sc.Er,sc.Ir),sc.Ar=new sc(-1,0,0);var cc=(lc.prototype.start=function(t){-1!==this.Rr.params._r&&this.Vr(t)},lc.prototype.stop=function(){this.gr&&(this.gr.cancel(),this.gr=null)},Object.defineProperty(lc.prototype,"yr",{get:function(){return null!==this.gr},enumerable:!1,configurable:!0}),lc.prototype.Vr=function(n){var t=this,e=this.Pr?3e5:6e4;Ar("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gr=this.rs.Pn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.gr=null,this.Pr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.pr(this.Rr)];case 2:return t.sent(),[3,7];case 3:return ca(e=t.sent())?(Ar("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Zh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Vr(n)];case 8:return t.sent(),[2]}})})})},lc),hc=(fc.prototype.br=function(t,e){return this.vr.Sr(t).next(function(t){return Math.floor(e/100*t)})},fc.prototype.Dr=function(t,e){var n=this;if(0===e)return ta.resolve($a.nr);var r=new ic(e);return this.vr.De(t,function(t){return r.ar(t.sequenceNumber)}).next(function(){return n.vr.Cr(t,function(t){return r.ar(t)})}).next(function(){return r.maxValue})},fc.prototype.Nr=function(t,e,n){return this.vr.Nr(t,e,n)},fc.prototype.Fr=function(t,e){return this.vr.Fr(t,e)},fc.prototype.Or=function(e,n){var r=this;return-1===this.params._r?(Ar("LruGarbageCollector","Garbage collection skipped; disabled"),ta.resolve(oc)):this.Mr(e).next(function(t){return t<r.params._r?(Ar("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params._r),oc):r.kr(e,n)})},fc.prototype.Mr=function(t){return this.vr.Mr(t)},fc.prototype.kr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.br(e,this.params.dr).next(function(t){return i=t>h.params.wr?(Ar("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.wr+" from "+t),h.params.wr):t,s=Date.now(),h.Dr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Nr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Fr(e,r)}).next(function(t){return c=Date.now(),xr()<=l.DEBUG&&Ar("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ta.resolve({cr:!0,ur:i,hr:o,lr:t})})},fc);function fc(t,e){this.vr=t,this.params=e}function lc(t,e){this.Rr=t,this.rs=e,this.Pr=!1,this.gr=null}function pc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=dc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return dc(e)}function dc(t){return t+"\x01\x01"}function yc(t){var e=t.length;if(Pr(2<=e),2===e)return Pr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Yr.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Dr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Dr()}o=s+2}return new Yr(r)}var vc=function(t){this.$r=t};function gc(t,e){if(e.document)return n=t.$r,r=e.document,i=!!e.hasCommittedMutations,t=Vo(n,r.name),n=Po(r.updateTime),r=new Bs({mapValue:{fields:r.fields}}),new Js(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=$r.H(e.noDocument.path),o=Ec(e.noDocument.readTime);return new $s(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=$r.H(e.unknownDocument.path),e=Ec(e.unknownDocument.version);return new Zs(o,e)}return Dr()}function mc(t,e,n){var r=wc(n),n=e.key.path.S().O();if(e instanceof Js){var i={name:Ro(i=t.$r,(o=e).key),fields:o.sn().mapValue.fields,updateTime:ko(i,o.version.P())},o=e.hasCommittedMutations;return new rh(null,null,i,o,r,n)}if(e instanceof $s){var i=e.key.path.O(),o=_c(e.version),s=e.hasCommittedMutations;return new rh(null,new eh(i,o),null,s,r,n)}if(e instanceof Zs){s=e.key.path.O(),e=_c(e.version);return new rh(new nh(s,e),null,null,!0,r,n)}return Dr()}function wc(t){t=t.P();return[t.seconds,t.nanoseconds]}function bc(t){t=new Qr(t[0],t[1]);return Wr.m(t)}function _c(t){t=t.P();return new Hc(t.seconds,t.nanoseconds)}function Ec(t){t=new Qr(t.seconds,t.nanoseconds);return Wr.m(t)}function Ic(e,t){var n=(t.baseMutations||[]).map(function(t){return Go(e.$r,t)}),r=t.mutations.map(function(t){return Go(e.$r,t)}),i=Qr.fromMillis(t.localWriteTimeMs);return new Ua(t.batchId,i,n,r)}function Tc(t){var e=Ec(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Ec(t.lastLimboFreeSnapshotVersion):Wr.min(),r=void 0!==t.query.documents?(Pr(1===(r=t.query).documents.length),lu(ou(Uo(r.documents[0])))):lu(Ho(t.query));return new wi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,yi.fromBase64String(t.resumeToken))}function Nc(t,e){var n=_c(e.et),r=_c(e.lastLimboFreeSnapshotVersion),i=(di(e.target)?zo:Ko)(t.$r,e.target),t=e.resumeToken.toBase64();return new oh(e.targetId,li(e.target),n,t,e.sequenceNumber,r,i)}function xc(t){var e=Ho({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?pu(e,e.limit,"L"):e}var Ac=(Sc.qr=function(t,e,n,r){return Pr(""!==t.uid),new Sc(t.Js()?t.uid:"",e,n,r)},Sc.prototype.Ur=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dc(t).ns({index:$c.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Sc.prototype.Qr=function(d,y,v,g){var m=this,w=Pc(d),b=Dc(d);return b.add({}).next(function(t){Pr("number"==typeof t);for(var e,n,r,i,o,s=new Ua(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Bo(e.$r,t)}),o=r.mutations.map(function(t){return Bo(e.$r,t)}),new $c(n,r.batchId,r.li.toMillis(),i,o)),a=[],c=new ki(function(t,e){return Rr(t.M(),e.M())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Zc.key(m.userId,l.key.path,t),c=c.add(l.key.path.S());a.push(b.put(u)),a.push(w.put(p,Zc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Fi.Kr(d,t))}),d.Di(function(){m.Br[t]=s.keys()}),ta.xn(a).next(function(){return s})})},Sc.prototype.Wr=function(t,e){var n=this;return Dc(t).get(e).next(function(t){return t?(Pr(t.userId===n.userId),Ic(n.serializer,t)):null})},Sc.prototype.jr=function(t,e){var n=this;return this.Br[e]?ta.resolve(this.Br[e]):this.Wr(t,e).next(function(t){if(t){t=t.keys();return n.Br[e]=t}return null})},Sc.prototype.Gr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Dc(t).ns({index:$c.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Pr(e.batchId>=i),o=Ic(r.serializer,e)),n.done()}).next(function(){return o})},Sc.prototype.zr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Dc(t).ns({index:$c.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Sc.prototype.Hr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dc(t).Xn($c.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ic(e.serializer,t)})})},Sc.prototype.Mi=function(o,s){var u=this,t=Zc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Pc(o).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=yc(i);if(r===u.userId&&s.path.isEqual(i))return Dc(o).get(t).next(function(t){if(!t)throw Dr();Pr(t.userId===u.userId),a.push(Ic(u.serializer,t))});n.done()}).next(function(){return a})},Sc.prototype.qi=function(e,t){var s=this,u=new ki(Rr),n=[];return t.forEach(function(o){var t=Zc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Pc(e).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=yc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ta.xn(n).next(function(){return s.Jr(e,u)})},Sc.prototype.Gi=function(t,e){var o=this,s=e.path,u=s.length+1,e=Zc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new ki(Rr);return Pc(t).ns({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=yc(i);r===o.userId&&s.N(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Jr(t,a)})},Sc.prototype.Jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Dc(e).get(t).next(function(t){if(null===t)throw Dr();Pr(t.userId===n.userId),r.push(Ic(n.serializer,t))}))}),ta.xn(i).next(function(){return r})},Sc.prototype.Yr=function(e,n){var r=this;return kc(e.Xr,this.userId,n).next(function(t){return e.Di(function(){r.Zr(n.batchId)}),ta.forEach(t,function(t){return r.Lr.eo(e,t)})})},Sc.prototype.Zr=function(t){delete this.Br[t]},Sc.prototype.no=function(e){var i=this;return this.Ur(e).next(function(t){if(!t)return ta.resolve();var t=IDBKeyRange.lowerBound(Zc.prefixForUser(i.userId)),r=[];return Pc(e).ns({range:t},function(t,e,n){t[0]===i.userId?(t=yc(t[1]),r.push(t)):n.done()}).next(function(){Pr(0===r.length)})})},Sc.prototype.so=function(t,e){return Oc(t,this.userId,e)},Sc.prototype.io=function(t){var e=this;return Cc(t).get(this.userId).next(function(t){return t||new Jc(e.userId,-1,"")})},Sc);function Sc(t,e,n,r){this.userId=t,this.serializer=e,this.Fi=n,this.Lr=r,this.Br={}}function Oc(t,o,e){var e=Zc.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Pc(t).ns({range:e,es:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function kc(t,e,n){var r=t.store($c.store),i=t.store(Zc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ns({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Pr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Zc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ta.xn(o).next(function(){return u})}function Dc(t){return Dh.qn(t,$c.store)}function Pc(t){return Dh.qn(t,Zc.store)}function Cc(t){return Dh.qn(t,Jc.store)}var Lc,Rc=(Uc.prototype.Ri=function(t,e,n){return Fc(t).put(qc(e),n)},Uc.prototype.Vi=function(t,e){t=Fc(t),e=qc(e);return t.delete(e)},Uc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ro(e,t)})},Uc.prototype.yi=function(t,e){var n=this;return Fc(t).get(qc(e)).next(function(t){return n.oo(t)})},Uc.prototype.ao=function(t,e){var n=this;return Fc(t).get(qc(e)).next(function(t){var e=n.oo(t);return e?{gi:e,size:Bc(t)}:null})},Uc.prototype.getEntries=function(t,e){var n=this,r=Pi;return this.co(t,e,function(t,e){e=n.oo(e);r=r.rt(t,e)}).next(function(){return r})},Uc.prototype.uo=function(t,e){var r=this,i=Pi,o=new Ii($r.V);return this.co(t,e,function(t,e){var n=r.oo(e);o=n?(i=i.rt(t,n),o.rt(t,Bc(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{ho:i,lo:o}})},Uc.prototype.co=function(t,e,i){if(e.T())return ta.resolve();var n=IDBKeyRange.bound(e.first().path.O(),e.last().path.O()),o=e.lt(),s=o.Et();return Fc(t).ns({range:n},function(t,e,n){for(var r=$r.H(t);s&&$r.V(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.O()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},Uc.prototype.Ui=function(t,r,e){var n,i=this,o=Ri,s=r.path.length+1,u={};return e.isEqual(Wr.min())?(n=r.path.O(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.O(),e=wc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=rh.collectionReadTimeIndex),Fc(t).ns(u,function(t,e,n){t.length===s&&(e=gc(i.serializer,e),r.path.N(e.key.path)?e instanceof Js&&wu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},Uc.prototype._o=function(t){return new Vc(this,!!t&&t.fo)},Uc.prototype.wo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Uc.prototype.getMetadata=function(t){return jc(t).get(ih.key).next(function(t){return Pr(!!t),t})},Uc.prototype.ro=function(t,e){return jc(t).put(ih.key,e)},Uc.prototype.oo=function(t){if(t){t=gc(this.serializer,t);return t instanceof $s&&t.version.isEqual(Wr.min())?null:t}return null},Uc),Vc=(n(Mc,Lc=h),Mc.prototype.bi=function(i){var o=this,s=[],u=0,a=new ki(function(t,e){return Rr(t.M(),e.M())});return this.Ii.forEach(function(t,e){var n,r=o.Eo.get(t);e.gi?(n=mc(o.To.serializer,e.gi,o.Ai(t)),a=a.add(t.path.S()),e=Bc(n),u+=e-r,s.push(o.To.Ri(i,t,n))):(u-=r,o.fo?(r=mc(o.To.serializer,new $s(t,Wr.min()),o.Ai(t)),s.push(o.To.Ri(i,t,r))):s.push(o.To.Vi(i,t)))}),a.forEach(function(t){s.push(o.To.Fi.Kr(i,t))}),s.push(this.To.updateMetadata(i,u)),ta.xn(s)},Mc.prototype.pi=function(t,e){var n=this;return this.To.ao(t,e).next(function(t){return null===t?(n.Eo.set(e,0),null):(n.Eo.set(e,t.size),t.gi)})},Mc.prototype.vi=function(t,e){var n=this;return this.To.uo(t,e).next(function(t){var e=t.ho;return t.lo.forEach(function(t,e){n.Eo.set(t,e)}),e})},Mc);function Mc(t,e){var n=this;return(n=Lc.call(this)||this).To=t,n.fo=e,n.Eo=new zr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Uc(t,e){this.serializer=t,this.Fi=e}function jc(t){return Dh.qn(t,ih.store)}function Fc(t){return Dh.qn(t,rh.store)}function qc(t){return t.path.O()}function Bc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Dr();e=t.noDocument}return JSON.stringify(e).length}var Gc=(Xc.prototype.Kr=function(t,e){return this.Io.add(e),ta.resolve()},Xc.prototype.ji=function(t,e){return ta.resolve(this.Io.getEntries(e))},Xc),zc=(Yc.prototype.add=function(t){var e=t.C(),n=t.S(),r=this.index[e]||new ki(Yr.V),t=!r.has(n);return this.index[e]=r.add(n),t},Yc.prototype.has=function(t){var e=t.C(),t=t.S(),e=this.index[e];return e&&e.has(t)},Yc.prototype.getEntries=function(t){return(this.index[t]||new ki(Yr.V)).O()},Yc),Kc=(Wc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Pr(t<r&&0<=t&&r<=11);var o=new ha("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Qc.store),(s=e).createObjectStore(Jc.store,{keyPath:Jc.keyPath}),s.createObjectStore($c.store,{keyPath:$c.keyPath,autoIncrement:!0}).createIndex($c.userMutationsIndex,$c.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Zc.store),ch(e),e.createObjectStore(rh.store));var s,u=ta.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(sh.store),s.deleteObjectStore(oh.store),s.deleteObjectStore(uh.store),ch(e)),u=u.next(function(){return t=o.store(uh.store),e=new uh(0,0,Wr.min().P(),0),t.put(uh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store($c.store).Xn().next(function(t){n.deleteObjectStore($c.store),n.createObjectStore($c.store,{keyPath:$c.keyPath,autoIncrement:!0}).createIndex($c.userMutationsIndex,$c.userMutationsKeyPath,{unique:!0});var e=r.store($c.store),t=t.map(function(t){return e.put(t)});return ta.xn(t)});var n,r})),u=u.next(function(){e.createObjectStore(hh.store,{keyPath:hh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(ih.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(rh.store)).createIndex(rh.readTimeIndex,rh.readTimeIndexPath,{unique:!1}),t.createIndex(rh.collectionReadTimeIndex,rh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(fh.store,{keyPath:fh.keyPath}),e.createObjectStore(lh.store,{keyPath:lh.keyPath})})),u},Wc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(rh.store).ns(function(t,e){n+=Bc(e)}).next(function(){var t=new ih(n);return e.store(ih.store).put(ih.key,t)})},Wc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Jc.store),i=n.store($c.store);return t.Xn().next(function(t){return ta.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Xn($c.userMutationsIndex,t).next(function(t){return ta.forEach(t,function(t){Pr(t.userId===e.userId);t=Ic(r.serializer,t);return kc(n,e.userId,t).next(function(){})})})})})},Wc.prototype.ensureSequenceNumbers=function(t){var o=t.store(sh.store),e=t.store(rh.store);return t.store(uh.store).get(uh.key).next(function(r){var i=[];return e.ns(function(t,e){var n=new Yr(t),t=[0,pc(n)];i.push(o.get(t).next(function(t){return t?ta.resolve():o.put(new sh(0,pc(n),r.highestListenSequenceNumber))}))}).next(function(){return ta.xn(i)})})},Wc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ah.store,{keyPath:ah.keyPath});function r(t){if(i.add(t)){var e=t.C(),t=t.S();return n.put({collectionId:e,parent:pc(t)})}}var n=e.store(ah.store),i=new zc;return e.store(rh.store).ns({es:!0},function(t,e){t=new Yr(t);return r(t.S())}).next(function(){return e.store(Zc.store).ns({es:!0},function(t,e){t[0];var n=t[1],n=(t[2],yc(n));return r(n.S())})})},Wc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(oh.store);return r.ns(function(t,e){e=Tc(e),e=Nc(n.serializer,e);return r.put(e)})},Wc),Hc=function(t,e){this.seconds=t,this.nanoseconds=e},Qc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Wc(t){this.serializer=t}function Yc(){this.index={}}function Xc(){this.Io=new zc}Qc.store="owner",Qc.key="owner";var Jc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Jc.store="mutationQueues",Jc.keyPath="userId";var $c=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};$c.store="mutations",$c.keyPath="batchId",$c.userMutationsIndex="userMutationsIndex",$c.userMutationsKeyPath=["userId","batchId"];var Zc=(th.prefixForUser=function(t){return[t]},th.prefixForPath=function(t,e){return[t,pc(e)]},th.key=function(t,e,n){return[t,pc(e),n]},th);function th(){}Zc.store="documentMutations",Zc.PLACEHOLDER=new Zc;var eh=function(t,e){this.path=t,this.readTime=e},nh=function(t,e){this.path=t,this.version=e},rh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};rh.store="remoteDocuments",rh.readTimeIndex="readTimeIndex",rh.readTimeIndexPath="readTime",rh.collectionReadTimeIndex="collectionReadTimeIndex",rh.collectionReadTimeIndexPath=["parentPath","readTime"];var ih=function(t){this.byteSize=t};ih.store="remoteDocumentGlobal",ih.key="remoteDocumentGlobalKey";var oh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};oh.store="targets",oh.keyPath="targetId",oh.queryTargetsIndexName="queryTargetsIndex",oh.queryTargetsKeyPath=["canonicalId","targetId"];var sh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};sh.store="targetDocuments",sh.keyPath=["targetId","path"],sh.documentTargetsIndex="documentTargetsIndex",sh.documentTargetsKeyPath=["path","targetId"];var uh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};uh.key="targetGlobalKey",uh.store="targetGlobal";var ah=function(t,e){this.collectionId=t,this.parent=e};function ch(t){t.createObjectStore(sh.store,{keyPath:sh.keyPath}).createIndex(sh.documentTargetsIndex,sh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(oh.store,{keyPath:oh.keyPath}).createIndex(oh.queryTargetsIndexName,oh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(uh.store)}ah.store="collectionParents",ah.keyPath=["collectionId","parent"];var hh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};hh.store="clientMetadata",hh.keyPath="clientId";var fh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};fh.store="bundles",fh.keyPath="bundleId";var lh=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};lh.store="namedQueries",lh.keyPath="name";var ph=i(i(i(i([Jc.store,$c.store,Zc.store,rh.store,oh.store,Qc.store,uh.store,sh.store],[hh.store]),[ih.store]),[ah.store]),[fh.store,lh.store]),dh=(yh.prototype.mo=function(t,e){return vh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:Ec(t.createTime),version:t.version}})},yh.prototype.Ao=function(t,e){return vh(t).put({bundleId:(e=e).id,createTime:_c(Po(e.createTime)),version:e.version})},yh.prototype.Ro=function(t,e){return gh(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:xc(t.bundledQuery),readTime:Ec(t.readTime)}})},yh.prototype.Po=function(t,e){return gh(t).put({name:(e=e).name,readTime:_c(Po(e.readTime)),bundledQuery:e.bundledQuery})},yh);function yh(t){this.serializer=t}function vh(t){return Dh.qn(t,fh.store)}function gh(t){return Dh.qn(t,lh.store)}var mh=(wh.prototype.Kr=function(t,e){var n=this;if(this.Vo.has(e))return ta.resolve();var r=e.C(),i=e.S();t.Di(function(){n.Vo.add(e)});i={collectionId:r,parent:pc(i)};return bh(t).put(i)},wh.prototype.ji=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Mr(i),""],!1,!0);return bh(t).Xn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(yc(r.parent))}return o})},wh);function wh(){this.Vo=new zc}function bh(t){return Dh.qn(t,ah.store)}var _h=(Th.prototype.next=function(){return this.yo+=2,this.yo},Th.po=function(){return new Th(0)},Th.vo=function(){return new Th(-1)},Th),Eh=(Ih.prototype.bo=function(n){var r=this;return this.So(n).next(function(t){var e=new _h(t.highestTargetId);return t.highestTargetId=e.next(),r.Do(n,t).next(function(){return t.highestTargetId})})},Ih.prototype.Co=function(t){return this.So(t).next(function(t){return Wr.m(new Qr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Ih.prototype.No=function(t){return this.So(t).next(function(t){return t.highestListenSequenceNumber})},Ih.prototype.xo=function(e,n,r){var i=this;return this.So(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.P()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Do(e,t)})},Ih.prototype.Fo=function(e,n){var r=this;return this.Oo(e,n).next(function(){return r.So(e).next(function(t){return t.targetCount+=1,r.Mo(n,t),r.Do(e,t)})})},Ih.prototype.ko=function(t,e){return this.Oo(t,e)},Ih.prototype.$o=function(e,t){var n=this;return this.Lo(e,t.targetId).next(function(){return Nh(e).delete(t.targetId)}).next(function(){return n.So(e)}).next(function(t){return Pr(0<t.targetCount),--t.targetCount,n.Do(e,t)})},Ih.prototype.Nr=function(n,r,i){var o=this,s=0,u=[];return Nh(n).ns(function(t,e){e=Tc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.$o(n,e)))}).next(function(){return ta.xn(u)}).next(function(){return s})},Ih.prototype.De=function(t,n){return Nh(t).ns(function(t,e){e=Tc(e);n(e)})},Ih.prototype.So=function(t){return xh(t).get(uh.key).next(function(t){return Pr(null!==t),t})},Ih.prototype.Do=function(t,e){return xh(t).put(uh.key,e)},Ih.prototype.Oo=function(t,e){return Nh(t).put(Nc(this.serializer,e))},Ih.prototype.Mo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Ih.prototype.Bo=function(t){return this.So(t).next(function(t){return t.targetCount})},Ih.prototype.qo=function(t,r){var e=li(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Nh(t).ns({range:e,index:oh.queryTargetsIndexName},function(t,e,n){e=Tc(e);pi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Ih.prototype.Uo=function(n,t,r){var i=this,o=[],s=Ah(n);return t.forEach(function(t){var e=pc(t.path);o.push(s.put(new sh(r,e))),o.push(i.Lr.Qo(n,r,t))}),ta.xn(o)},Ih.prototype.Ko=function(n,t,r){var i=this,o=Ah(n);return ta.forEach(t,function(t){var e=pc(t.path);return ta.xn([o.delete([r,e]),i.Lr.Wo(n,r,t)])})},Ih.prototype.Lo=function(t,e){t=Ah(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Ih.prototype.jo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Ah(t),r=Ui();return t.ns({range:e,es:!0},function(t,e,n){t=yc(t[1]),t=new $r(t);r=r.add(t)}).next(function(){return r})},Ih.prototype.so=function(t,e){var e=pc(e.path),e=IDBKeyRange.bound([e],[Mr(e)],!1,!0),i=0;return Ah(t).ns({index:sh.documentTargetsIndex,es:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Ih.prototype.qe=function(t,e){return Nh(t).get(e).next(function(t){return t?Tc(t):null})},Ih);function Ih(t,e){this.Lr=t,this.serializer=e}function Th(t){this.yo=t}function Nh(t){return Dh.qn(t,oh.store)}function xh(t){return Dh.qn(t,uh.store)}function Ah(t){return Dh.qn(t,sh.store)}var Sh,Oh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",kh=(n(Ch,Sh=Ee),Ch),Dh=(Ph.qn=function(t,e){if(t instanceof kh)return ea.qn(t.Xr,e);throw Dr()},Ph.prototype.start=function(){var e=this;return this.ca().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Hr(Kr.FAILED_PRECONDITION,Oh);return e.ua(),e.ha(),e.la(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ra.No(t)})}).then(function(t){e.Jo=new $a(t,e.zo)}).then(function(){e.Yo=!0}).catch(function(t){return e.ia&&e.ia.close(),Promise.reject(t)})},Ph.prototype._a=function(n){var t=this;return this.na=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.yr?[2,n(e)]:[2]})})},n(this.isPrimary)},Ph.prototype.fa=function(n){var t=this;this.ia.Kn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ph.prototype.da=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.yr?[4,this.ca()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ph.prototype.ca=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Rh(e).put(new hh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.wa(e).next(function(t){t||(n.isPrimary=!1,n.ln.Ss(function(){return n.na(!1)}))})}).next(function(){return n.Ta(e)}).next(function(t){return n.isPrimary&&!t?n.Ea(e).next(function(){return!1}):!!t&&n.Ia(e).next(function(){return!0})})}).catch(function(t){if(ca(t))return Ar("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Ar("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.ln.Ss(function(){return n.na(t)}),n.isPrimary=t})},Ph.prototype.wa=function(t){var e=this;return Lh(t).get(Qc.key).next(function(t){return ta.resolve(e.ma(t))})},Ph.prototype.Aa=function(t){return Rh(t).delete(this.clientId)},Ph.prototype.Ra=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Pa(this.ea,18e5)?[3,2]:(this.ea=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ph.qn(t,hh.store);return r.Xn().next(function(t){var e=o.ga(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ta.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.aa)for(n=0,r=e;n<r.length;n++)i=r[n],this.aa.removeItem(this.Va(i.clientId));t.label=2;case 2:return[2]}})})},Ph.prototype.la=function(){var t=this;this.ta=this.ln.Pn("client_metadata_refresh",4e3,function(){return t.ca().then(function(){return t.Ra()}).then(function(){return t.la()})})},Ph.prototype.ma=function(t){return!!t&&t.ownerId===this.clientId},Ph.prototype.Ta=function(e){var r=this;return this.Ho?ta.resolve(!0):Lh(e).get(Qc.key).next(function(t){if(null!==t&&r.Pa(t.leaseTimestampMs,5e3)&&!r.ya(t.ownerId)){if(r.ma(t)&&r.networkEnabled)return!0;if(!r.ma(t)){if(!t.allowTabSynchronization)throw new Hr(Kr.FAILED_PRECONDITION,Oh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Rh(e).Xn().next(function(t){return void 0===r.ga(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Ar("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ph.prototype.pa=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Yo=!1,this.va(),this.ta&&(this.ta.cancel(),this.ta=null),this.ba(),this.Sa(),[4,this.ia.runTransaction("shutdown","readwrite",[Qc.store,hh.store],function(t){var e=new kh(t,$a.nr);return n.Ea(e).next(function(){return n.Aa(e)})})];case 1:return t.sent(),this.ia.close(),this.Da(),[2]}})})},Ph.prototype.ga=function(t,e){var n=this;return t.filter(function(t){return n.Pa(t.updateTimeMs,e)&&!n.ya(t.clientId)})},Ph.prototype.Ca=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Rh(t).Xn().next(function(t){return e.ga(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Ph.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),Ph.prototype.Na=function(t){return Ac.qr(t,this.serializer,this.Fi,this.Lr)},Ph.prototype.xa=function(){return this.ra},Ph.prototype.Fa=function(){return this.Ni},Ph.prototype.Oa=function(){return this.Fi},Ph.prototype.Ma=function(){return this.oa},Ph.prototype.runTransaction=function(e,n,r){var i=this;Ar("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.ia.runTransaction(e,t,ph,function(t){return o=new kh(t,i.Jo?i.Jo.next():$a.nr),"readwrite-primary"===n?i.wa(o).next(function(t){return!!t||i.Ta(o)}).next(function(t){if(!t)throw Sr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.ln.Ss(function(){return i.na(!1)}),new Hr(Kr.FAILED_PRECONDITION,Ya);return r(o)}).next(function(t){return i.Ia(o).next(function(){return t})}):i.ka(o).next(function(){return r(o)})}).then(function(t){return o.Ci(),t})},Ph.prototype.ka=function(t){var e=this;return Lh(t).get(Qc.key).next(function(t){if(null!==t&&e.Pa(t.leaseTimestampMs,5e3)&&!e.ya(t.ownerId)&&!e.ma(t)&&!(e.Ho||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Hr(Kr.FAILED_PRECONDITION,Oh)})},Ph.prototype.Ia=function(t){var e=new Qc(this.clientId,this.allowTabSynchronization,Date.now());return Lh(t).put(Qc.key,e)},Ph.kn=function(){return ea.kn()},Ph.prototype.Ea=function(t){var e=this,n=Lh(t);return n.get(Qc.key).next(function(t){return e.ma(t)?(Ar("IndexedDbPersistence","Releasing primary lease."),n.delete(Qc.key)):ta.resolve()})},Ph.prototype.Pa=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Sr("Detected an update time that is in the future: "+t+" > "+n),1))},Ph.prototype.ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Zo=function(){t.ln.fs(function(){return t.inForeground="visible"===t.document.visibilityState,t.ca()})},this.document.addEventListener("visibilitychange",this.Zo),this.inForeground="visible"===this.document.visibilityState)},Ph.prototype.ba=function(){this.Zo&&(this.document.removeEventListener("visibilitychange",this.Zo),this.Zo=null)},Ph.prototype.ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Xo=function(){e.va(),e.ln.fs(function(){return e.pa()})},this.window.addEventListener("unload",this.Xo))},Ph.prototype.Sa=function(){this.Xo&&(this.window.removeEventListener("unload",this.Xo),this.Xo=null)},Ph.prototype.ya=function(t){try{var e=null!==(null===(e=this.aa)||void 0===e?void 0:e.getItem(this.Va(t)));return Ar("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Sr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ph.prototype.va=function(){if(this.aa)try{this.aa.setItem(this.Va(this.clientId),String(Date.now()))}catch(t){Sr("Failed to set zombie client id.",t)}},Ph.prototype.Da=function(){if(this.aa)try{this.aa.removeItem(this.Va(this.clientId))}catch(t){}},Ph.prototype.Va=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ph);function Ph(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.ln=i,this.window=o,this.document=s,this.zo=a,this.Ho=c,this.Jo=null,this.Yo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Xo=null,this.inForeground=!1,this.Zo=null,this.ta=null,this.ea=Number.NEGATIVE_INFINITY,this.na=function(t){return Promise.resolve()},!Ph.kn())throw new Hr(Kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Lr=new Vh(this,r),this.sa=e+"main",this.serializer=new vc(u),this.ia=new ea(this.sa,11,new Kc(this.serializer)),this.ra=new Eh(this.Lr,this.serializer),this.Fi=new mh,this.Ni=(e=this.serializer,u=this.Fi,new Rc(e,u)),this.oa=new dh(this.serializer),this.window&&this.window.localStorage?this.aa=this.window.localStorage:(this.aa=null,!1===c&&Sr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Ch(t,e){var n=this;return(n=Sh.call(this)||this).Xr=t,n.Go=e,n}function Lh(t){return Dh.qn(t,Qc.store)}function Rh(t){return Dh.qn(t,hh.store)}var Vh=(Mh.prototype.Sr=function(t){var n=this.$a(t);return this.db.xa().Bo(t).next(function(e){return n.next(function(t){return e+t})})},Mh.prototype.$a=function(t){var e=0;return this.Cr(t,function(t){e++}).next(function(){return e})},Mh.prototype.De=function(t,e){return this.db.xa().De(t,e)},Mh.prototype.Cr=function(t,n){return this.La(t,function(t,e){return n(e)})},Mh.prototype.Qo=function(t,e,n){return Uh(t,n)},Mh.prototype.Wo=function(t,e,n){return Uh(t,n)},Mh.prototype.Nr=function(t,e,n){return this.db.xa().Nr(t,e,n)},Mh.prototype.eo=Uh,Mh.prototype.Ba=function(t,e){return r=e,i=!1,Cc(n=t).ss(function(t){return Oc(n,t,r).next(function(t){return t&&(i=!0),ta.resolve(!t)})}).next(function(){return i});var n,r,i},Mh.prototype.Fr=function(n,r){var i=this,o=this.db.Fa()._o(),s=[],u=0;return this.La(n,function(e,t){t<=r&&(t=i.Ba(n,e).next(function(t){if(!t)return u++,o.yi(n,e).next(function(){return o.Vi(e),Ah(n).delete([0,pc(e.path)])})}),s.push(t))}).next(function(){return ta.xn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Mh.prototype.removeTarget=function(t,e){e=e.nt(t.Go);return this.db.xa().ko(t,e)},Mh.prototype.qa=Uh,Mh.prototype.La=function(t,r){var i,t=Ah(t),o=$a.nr;return t.ns({index:sh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==$a.nr&&r(new $r(yc(i)),o),o=e,i=t):o=$a.nr}).next(function(){o!==$a.nr&&r(new $r(yc(i)),o)})},Mh.prototype.Mr=function(t){return this.db.Fa().wo(t)},Mh);function Mh(t,e){this.db=t,this.Rr=new hc(this,e)}function Uh(t,e){return Ah(t).put((t=t.Go,new sh(0,pc(e.path),t)))}function jh(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Fh=(qh.prototype.pr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Or(t,n.Qa)})},qh);function qh(t,e,n,r){this.persistence=t,this.Ua=e,this.serializer=r,this.Qa=new Ii(Rr),this.Ka=new zr(li,pi),this.Wa=Wr.min(),this.xi=t.Na(n),this.ja=t.Fa(),this.ra=t.xa(),this.Ga=new Xa(this.ja,this.xi,this.persistence.Oa()),this.oa=t.Ma(),this.Ua.za(this.Ga)}function Bh(t,e,n,r){return new Fh(t,e,n,r)}function Gh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).xi,m=e.Ga,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.xi.Hr(v).next(function(t){return g=t,n=e.persistence.Na(o),m=new Xa(e.ja,n,e.persistence.Oa()),n.Hr(v)}).next(function(t){for(var e=[],n=[],r=Ui(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Li(v,r).next(function(t){return{Ha:t,Ja:e,Ya:n}})})})];case 1:return r=t.sent(),[2,(e.xi=n,e.Ga=m,e.Ua.za(e.Ga),r)]}})})}function zh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.ja._o({fo:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ta.resolve(),n.forEach(function(n){u=u.next(function(){return o.yi(r,n)}).next(function(t){var e=t,t=i.Ei.get(n);Pr(null!==t),(!e||e.version.A(t)<0)&&(e=s._i(n,e,i))&&o.Ri(e,i.Ti)})}),u.next(function(){return e.xi.Yr(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.xi.no(t)}).next(function(){return f.Ga.Li(t,a)})})}function Kh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ra.Co(t)})}function Hh(t,o){var h=t,f=o.et,l=h.Qa;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.ja._o({fo:!0});l=h.Qa;var u=[];o.Gt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.ra.Ko(s,t.ne,e).next(function(){return h.ra.Uo(s,t.te,e)})),0<(i=t.resumeToken).X()&&(n=o.st(i,f).nt(s.Go),l=l.rt(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.X()),(0===r.resumeToken.X()||3e8<=o.et.R()-r.et.R()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(h.ra.ko(s,n))))});var e,a,n,c,r,i=Pi;return o.Ht.forEach(function(t,e){o.Jt.has(t)&&u.push(h.persistence.Lr.qa(s,t))}),u.push((e=s,a=t,n=o.Ht,c=f,r=Ui(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Pi;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof $s&&e.version.isEqual(Wr.min())?(a.Vi(t,r),o=o.rt(t,e)):null==n||0<e.version.A(n.version)||0===e.version.A(n.version)&&n.hasPendingWrites?(a.Ri(e,r),o=o.rt(t,e)):Ar("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(Wr.min())||(e=h.ra.Co(s).next(function(t){return h.ra.xo(s,s.Go,f)}),u.push(e)),ta.xn(u).next(function(){return t.apply(s)}).next(function(){return h.Ga.Bi(s,i)})}).then(function(t){return h.Qa=l,t})}function Qh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ra.qo(e,r).next(function(t){return t?(n=t,ta.resolve(n)):i.ra.bo(e).next(function(t){return n=new wi(r,t,0,e.Go),i.ra.Fo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Qa.get(t.targetId);return(null===e||0<t.et.A(e.et))&&(i.Qa=i.Qa.rt(t.targetId,t),i.Ka.set(r,t.targetId)),t})}function Wh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Qa.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Lr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ca(r=t.sent()))throw r;return Ar("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Qa=e.Qa.remove(o),e.Ka.delete(n.target),[2]}})})}function Yh(t,o,s){var u=t,a=Wr.min(),c=Ui();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=lu(o),(void 0!==(t=(i=t).Ka.get(r))?ta.resolve(i.Qa.get(t)):i.ra.qo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ra.jo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Ua.Ui(e,o,s?a:Wr.min(),s?c:Ui())}).next(function(t){return{documents:t,Xa:c}});var t,n,r,i})}function Xh(t,e){var n=t,r=n.ra,t=n.Qa.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function Jh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.ja,n=t,t=s.Wa,r=e,i=Pi,o=wc(t),t=Fc(n),n=IDBKeyRange.lowerBound(o,!0),t.ns({index:rh.readTimeIndex,range:n},function(t,e){var n=gc(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Za:i,readTime:bc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Za,t=t.readTime;return s.Wa=t,e})}function $h(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Fc(t),r=Wr.min(),t.ns({index:rh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=bc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Wa=t})]})})}function Zh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Kr.FAILED_PRECONDITION||e.message!==Ya)throw e;return Ar("LocalStore","Unexpectedly lost primary lease"),[2]})})}function tf(t,e,n,r,i){var o=this;this.Kc=t,this.Wc=e,this.rs=n,this.jc={},this.Gc=[],this.zc=new Map,this.Hc=new Set,this.Jc=[],this.Yc=i,this.Yc.Xc(function(t){n.fs(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ef(this)?(Ar("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hc.add(4),[4,yf(e)];case 1:return t.sent(),e.Zc.set("Unknown"),e.Hc.delete(4),[4,df(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zc=new af(n,r)}var ef,nf,rf,Ie=(pf.prototype.rc=function(){return 1===this.state||2===this.state||4===this.state},pf.prototype.oc=function(){return 2===this.state},pf.prototype.start=function(){3!==this.state?this.auth():this.ac()},pf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.rc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},pf.prototype.cc=function(){this.state=0,this.Ps.reset()},pf.prototype.uc=function(){var t=this;this.oc()&&null===this.ic&&(this.ic=this.ln.Pn(this.tc,6e4,function(){return t.hc()}))},pf.prototype.lc=function(t){this._c(),this.stream.send(t)},pf.prototype.hc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oc()?[2,this.close(0)]:[2]})})},pf.prototype._c=function(){this.ic&&(this.ic.cancel(),this.ic=null)},pf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._c(),this.Ps.cancel(),this.sc++,3!==e?this.Ps.reset():n&&n.code===Kr.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.Ps.mn()):n&&n.code===Kr.UNAUTHENTICATED&&this.nc.ni(),null!==this.stream&&(this.fc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dc(n)];case 1:return t.sent(),[2]}})})},pf.prototype.fc=function(){},pf.prototype.auth=function(){var n=this;this.state=1;var t=this.wc(this.sc),e=this.sc;this.nc.getToken().then(function(t){n.sc===e&&n.Tc(t)},function(e){t(function(){var t=new Hr(Kr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ec(t)})})},pf.prototype.Tc=function(t){var e=this,n=this.wc(this.sc);this.stream=this.Ic(t),this.stream.mc(function(){n(function(){return e.state=2,e.listener.mc()})}),this.stream.dc(function(t){n(function(){return e.Ec(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},pf.prototype.ac=function(){var t=this;this.state=4,this.Ps.An(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},pf.prototype.Ec=function(t){return Ar("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},pf.prototype.wc=function(e){var n=this;return function(t){n.ln.fs(function(){return n.sc===e?t():(Ar("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},pf),of=(n(lf,rf=Ie),lf.prototype.Ic=function(t){return this.ec.Ac("Listen",t)},lf.prototype.onMessage=function(t){this.Ps.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Dr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(Pr(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Kr.UNKNOWN:Ei(s.code),new Hr(o,s.message||"")),r=new Qi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Vo(t,u.document.name),a=Po(u.document.updateTime),s=new Bs({mapValue:{fields:u.document.fields}}),a=new Js(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Ki(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Vo(t,u.document),c=u.readTime?Po(u.readTime):Wr.min(),c=new $s(a,c),u=u.removedTargetIds||[];r=new Ki([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Vo(t,c.document),c=c.removedTargetIds||[];r=new Ki([],c,h,null)}else{if(!("filter"in e))return Dr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new gi(e),h=h.targetId;r=new Hi(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Wr.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Po(t.readTime):Wr.min()}(t);return this.listener.Rc(e,t)},lf.prototype.Pc=function(t){var e,n,r,i={};i.database=jo(this.serializer),i.addTarget=(e=this.serializer,(r=di(r=(n=t).target)?{documents:zo(e,r)}:{query:Ko(e,r)}).targetId=n.targetId,0<n.resumeToken.X()?r.resumeToken=Do(e,n.resumeToken):0<n.et.A(Wr.min())&&(r.readTime=ko(e,n.et.P())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.lc(i)},lf.prototype.gc=function(t){var e={};e.database=jo(this.serializer),e.removeTarget=t,this.lc(e)},lf),sf=(n(ff,nf=Ie),Object.defineProperty(ff.prototype,"yc",{get:function(){return this.Vc},enumerable:!1,configurable:!0}),ff.prototype.start=function(){this.Vc=!1,this.lastStreamToken=void 0,nf.prototype.start.call(this)},ff.prototype.fc=function(){this.Vc&&this.vc([])},ff.prototype.Ic=function(t){return this.ec.Ac("Write",t)},ff.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vc){this.Ps.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Po(t.updateTime):Po(e);n.isEqual(Wr.min())&&(n=Po(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new ws(n,e)}(t,r)})):[]),n=Po(t.commitTime);return this.listener.bc(n,e)}var n,r;return Pr(!t.writeResults||0===t.writeResults.length),this.Vc=!0,this.listener.Sc()},ff.prototype.Dc=function(){var t={};t.database=jo(this.serializer),this.lc(t)},ff.prototype.vc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.lc(t)},ff),uf=(n(hf,ef=function(){}),hf.prototype.Nc=function(){if(this.Cc)throw new Hr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},hf.prototype.xc=function(e,n,r){var i=this;return this.Nc(),this.credentials.getToken().then(function(t){return i.ec.xc(e,n,r,t)}).catch(function(t){throw t.code===Kr.UNAUTHENTICATED&&i.credentials.ni(),t})},hf.prototype.Fc=function(e,n,r){var i=this;return this.Nc(),this.credentials.getToken().then(function(t){return i.ec.Fc(e,n,r,t)}).catch(function(t){throw t.code===Kr.UNAUTHENTICATED&&i.credentials.ni(),t})},hf.prototype.terminate=function(){this.Cc=!1},hf),af=(cf.prototype.Lc=function(){var t=this;0===this.Mc&&(this.Bc("Unknown"),this.kc=this.rs.Pn("online_state_timeout",1e4,function(){return t.kc=null,t.qc("Backend didn't respond within 10 seconds."),t.Bc("Offline"),Promise.resolve()}))},cf.prototype.Uc=function(t){"Online"===this.state?this.Bc("Unknown"):(this.Mc++,1<=this.Mc&&(this.Qc(),this.qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Bc("Offline")))},cf.prototype.set=function(t){this.Qc(),this.Mc=0,"Online"===t&&(this.$c=!1),this.Bc(t)},cf.prototype.Bc=function(t){t!==this.state&&(this.state=t,this.Oc(t))},cf.prototype.qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.$c?(Sr(t),this.$c=!1):Ar("OnlineStateTracker",t)},cf.prototype.Qc=function(){null!==this.kc&&(this.kc.cancel(),this.kc=null)},cf);function cf(t,e){this.rs=t,this.Oc=e,this.state="Unknown",this.Mc=0,this.kc=null,this.$c=!0}function hf(t,e,n){var r=this;return(r=ef.call(this)||this).credentials=t,r.ec=e,r.serializer=n,r.Cc=!1,r}function ff(t,e,n,r,i){var o=this;return(o=nf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vc=!1,o}function lf(t,e,n,r,i){var o=this;return(o=rf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function pf(t,e,n,r,i,o){this.ln=t,this.tc=n,this.ec=r,this.nc=i,this.listener=o,this.state=0,this.sc=0,this.ic=null,this.stream=null,this.Ps=new Zu(t,e)}function df(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Ef(r))return[3,4];e=0,n=r.Jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function vf(t,e){t.zc.has(e.targetId)||(t.zc.set(e.targetId,e),_f(t)?bf(t):Df(t).oc()&&mf(t,e))}function gf(t,e){var n=t,t=Df(n);n.zc.delete(e),t.oc()&&wf(n,e),0===n.zc.size&&(t.oc()?t.uc():Ef(n)&&n.Zc.set("Unknown"))}function mf(t,e){t.tu.Ie(e.targetId),Df(t).Pc(e)}function wf(t,e){t.tu.Ie(e),Df(t).gc(e)}function bf(e){e.tu=new Yi({Be:function(t){return e.jc.Be(t)},qe:function(t){return e.zc.get(t)||null}}),Df(e).start(),e.Zc.Lc()}function _f(t){return Ef(t)&&!Df(t).rc()&&0<t.zc.size}function Ef(t){return 0===t.Hc.size}function If(t){t.tu=void 0}function Tf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zc.set("Online"),!(u instanceof Qi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zc.has(i)?[4,o.jc.eu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zc.delete(i),o.tu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ar("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Nf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ki?s.tu.pe(u):u instanceof Hi?s.tu.Fe(u):s.tu.Se(u),a.isEqual(Wr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Kh(s.Kc)];case 8:return o=t.sent(),0<=a.A(o)?[4,(i=a,(e=(r=s).tu.ke(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.X()&&((n=r.zc.get(e))&&r.zc.set(e,n.st(t.resumeToken,i)))}),e.zt.forEach(function(t){var e=r.zc.get(t);e&&(r.zc.set(t,e.st(yi.Z,e.et)),wf(r,t),e=new wi(e.target,t,1,e.sequenceNumber),mf(r,e))}),r.jc.nu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ar("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Nf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Nf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ca(r))throw r;return n.Hc.add(1),[4,yf(n)];case 1:return t.sent(),n.Zc.set("Offline"),i=i||function(){return Kh(n.Kc)},n.rs.Ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ar("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hc.delete(1),[4,df(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function xf(e,n){return n().catch(function(t){return Nf(e,t,n)})}function Af(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Pf(i=a),s=0<i.Gc.length?i.Gc[i.Gc.length-1].batchId:-1,t.label=1;case 1:if(!(Ef(i)&&i.Gc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Kc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.xi.Gr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Gc.length&&o.uc(),[3,7]):(s=u.batchId,function(t,e){t.Gc.push(e);t=Pf(t);t.oc()&&t.yc&&t.vc(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Nf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Sf(i)&&Of(i),[2]}var e,n,r})})}function Sf(t){return Ef(t)&&!Pf(t).rc()&&0<t.Gc.length}function Of(t){Pf(t).start()}function kf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hc.delete(2),[4,df(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hc.add(2),[4,yf(e)]);case 3:t.sent(),e.Zc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Df(n){var t,e,r,i=this;return n.ru||(n.ru=(t=n.Wc,e=n.rs,r={mc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zc.forEach(function(t,e){mf(n,t)}),[2]})})}.bind(null,n),dc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return If(e),_f(e)?(e.Zc.Uc(n),bf(e)):e.Zc.set("Unknown"),[2]})})}.bind(null,n),Rc:Tf.bind(null,n)},t.Nc(),new of(e,t.ec,t.credentials,t.serializer,r)),n.Jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ru.cc(),_f(n)?bf(n):n.Zc.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ru.stop()];case 2:t.sent(),If(n),t.label=3;case 3:return[2]}})})})),n.ru}function Pf(n){var t,e,r,i=this;return n.ou||(n.ou=(t=n.Wc,e=n.rs,r={mc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Pf(e).Dc(),[2]})})}.bind(null,n),dc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Pf(e).yc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return _i(n=i.code)&&n!==Kr.ABORTED?(e=r.Gc.shift(),Pf(r).cc(),[4,xf(r,function(){return r.jc.iu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Af(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Sf(e)&&Of(e),[2]}})})}.bind(null,n),Sc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Pf(o),n=0,r=o.Gc;n<r.length;n++)i=r[n],e.vc(i.mutations);return[2]})})}.bind(null,n),bc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Gc.shift(),n=ja.from(e,i,o),[4,xf(r,function(){return r.jc.su(n)})];case 1:return t.sent(),[4,Af(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Nc(),new sf(e,t.ec,t.credentials,t.serializer,r)),n.Jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ou.cc(),[4,Af(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ou.stop()];case 3:t.sent(),0<n.Gc.length&&(Ar("RemoteStore","Stopping write stream with "+n.Gc.length+" pending writes"),n.Gc=[]),t.label=4;case 4:return[2]}})})})),n.ou}var Cf=(Vf.prototype.T=function(){return this.au.T()},Vf.prototype.Qo=function(t,e){e=new Lf(t,e);this.au=this.au.add(e),this.uu=this.uu.add(e)},Vf.prototype.lu=function(t,e){var n=this;t.forEach(function(t){return n.Qo(t,e)})},Vf.prototype.Wo=function(t,e){this._u(new Lf(t,e))},Vf.prototype.fu=function(t,e){var n=this;t.forEach(function(t){return n.Wo(t,e)})},Vf.prototype.du=function(t){var e=this,n=new $r(new Yr([])),r=new Lf(n,t),t=new Lf(n,t+1),i=[];return this.uu.Nt([r,t],function(t){e._u(t),i.push(t.key)}),i},Vf.prototype.wu=function(){var e=this;this.au.forEach(function(t){return e._u(t)})},Vf.prototype._u=function(t){this.au=this.au.delete(t),this.uu=this.uu.delete(t)},Vf.prototype.Tu=function(t){var e=new $r(new Yr([])),n=new Lf(e,t),t=new Lf(e,t+1),r=Ui();return this.uu.Nt([n,t],function(t){r=r.add(t.key)}),r},Vf.prototype.so=function(t){var e=new Lf(t,0),e=this.au.Ft(e);return null!==e&&t.isEqual(e.key)},Vf),Lf=(Rf.cu=function(t,e){return $r.V(t.key,e.key)||Rr(t.Eu,e.Eu)},Rf.hu=function(t,e){return Rr(t.Eu,e.Eu)||$r.V(t.key,e.key)},Rf);function Rf(t,e){this.key=t,this.Eu=e}function Vf(){this.au=new ki(Lf.cu),this.uu=new ki(Lf.hu)}function Mf(t,e){return"firestore_clients_"+t+"_"+e}function Uf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Js()&&(n+="_"+e.uid),n}function jf(t,e){return"firestore_targets_"+t+"_"+e}var Ff=(ul.Iu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Hr(r.error.code,r.error.message)),i?new ul(t,e,r.state,o):(Sr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},ul.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ul),qf=(sl.Iu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Hr(n.error.code,n.error.message)),r?new sl(t,n.state,i):(Sr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},sl.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},sl),Bf=(ol.Iu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ji,o=0;r&&o<n.activeTargetIds.length;++o)r=ci(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new ol(t,i):(Sr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},ol),Gf=(il.Iu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new il(e.clientId,e.onlineState):(Sr("SharedClientState","Failed to parse online state: "+t),null)},il),zf=(rl.prototype.Au=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},rl.prototype.Ru=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},rl.prototype.mu=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},rl),Kf=(nl.kn=function(t){return!(!t||!t.localStorage)},nl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.gu.Ca()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pu&&(i=this.getItem(Mf(this.persistenceKey,r)))&&(o=Bf.Iu(r,i))&&(this.pu=this.pu.rt(o.clientId,o));for(this.Ou(),(s=this.storage.getItem(this.xu))&&(u=this.Mu(s))&&this.ku(u),a=0,c=this.vu;a<c.length;a++)h=c[a],this.yu(h);return this.vu=[],this.window.addEventListener("unload",function(){return f.pa()}),this.yr=!0,[2]}})})},nl.prototype.er=function(t){this.setItem(this.Su,JSON.stringify(t))},nl.prototype.$u=function(){return this.Lu(this.pu)},nl.prototype.Bu=function(n){var r=!1;return this.pu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},nl.prototype.qu=function(t){this.Uu(t,"pending")},nl.prototype.Qu=function(t,e,n){this.Uu(t,e,n),this.Ku(t)},nl.prototype.Wu=function(t){var e,n="not-current";return this.Bu(t)&&(!(e=this.storage.getItem(jf(this.persistenceKey,t)))||(e=qf.Iu(t,e))&&(n=e.state)),this.ju.Au(t),this.Ou(),n},nl.prototype.Gu=function(t){this.ju.Ru(t),this.Ou()},nl.prototype.zu=function(t){return this.ju.activeTargetIds.has(t)},nl.prototype.Hu=function(t){this.removeItem(jf(this.persistenceKey,t))},nl.prototype.Ju=function(t,e,n){this.Yu(t,e,n)},nl.prototype.Xu=function(t,e,n){var r=this;e.forEach(function(t){r.Ku(t)}),this.currentUser=t,n.forEach(function(t){r.qu(t)})},nl.prototype.Zu=function(t){this.th(t)},nl.prototype.eh=function(){this.nh()},nl.prototype.pa=function(){this.yr&&(this.window.removeEventListener("storage",this.Vu),this.removeItem(this.bu),this.yr=!1)},nl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ar("SharedClientState","READ",t,e),e},nl.prototype.setItem=function(t,e){Ar("SharedClientState","SET",t,e),this.storage.setItem(t,e)},nl.prototype.removeItem=function(t){Ar("SharedClientState","REMOVE",t),this.storage.removeItem(t)},nl.prototype.yu=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Ar("SharedClientState","EVENT",o.key,o.newValue),o.key===this.bu)return void Sr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ln.Ss(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.yr){if(null!==o.key)if(this.Du.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Cu.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.ah(n)]}else if(this.Nu.test(o.key)){if(null!==o.newValue&&(r=this.uh(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xu){if(null!==o.newValue&&(i=this.Mu(o.newValue)))return[2,this.ku(i)]}else if(o.key===this.Su)(i=function(t){var e=$a.nr;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Sr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==$a.nr&&this.Xi(i);else if(o.key===this.Fu)return[2,this.gu.lh()]}else this.vu.push(o);return[2]})})})}},Object.defineProperty(nl.prototype,"ju",{get:function(){return this.pu.get(this.Pu)},enumerable:!1,configurable:!0}),nl.prototype.Ou=function(){this.setItem(this.bu,this.ju.mu())},nl.prototype.Uu=function(t,e,n){n=new Ff(this.currentUser,t,e,n),t=Uf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.mu())},nl.prototype.Ku=function(t){t=Uf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},nl.prototype.th=function(t){t={clientId:this.Pu,onlineState:t};this.storage.setItem(this.xu,JSON.stringify(t))},nl.prototype.Yu=function(t,e,n){var r=jf(this.persistenceKey,t),n=new qf(t,e,n);this.setItem(r,n.mu())},nl.prototype.nh=function(){this.setItem(this.Fu,"value-not-used")},nl.prototype.sh=function(t){t=this.Du.exec(t);return t?t[1]:null},nl.prototype.rh=function(t,e){t=this.sh(t);return Bf.Iu(t,e)},nl.prototype.oh=function(t,e){var n=this.Cu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Ff.Iu(new ka(n),t,e)},nl.prototype.uh=function(t,e){t=this.Nu.exec(t),t=Number(t[1]);return qf.Iu(t,e)},nl.prototype.Mu=function(t){return Gf.Iu(t)},nl.prototype.ah=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.gu._h(e.batchId,e.state,e.error)]:(Ar("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},nl.prototype.hh=function(t){return this.gu.fh(t.targetId,t.state,t.error)},nl.prototype.ih=function(t,e){var n=this,r=e?this.pu.rt(t,e):this.pu.remove(t),i=this.Lu(this.pu),o=this.Lu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.gu.dh(s,u).then(function(){n.pu=r})},nl.prototype.ku=function(t){this.pu.get(t.clientId)&&this.Oc(t.onlineState)},nl.prototype.Lu=function(t){var n=ji;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},nl),Hf=(el.prototype.qu=function(t){},el.prototype.Qu=function(t,e,n){},el.prototype.Wu=function(t){return this.wh.Au(t),this.Th[t]||"not-current"},el.prototype.Ju=function(t,e,n){this.Th[t]=e},el.prototype.Gu=function(t){this.wh.Ru(t)},el.prototype.zu=function(t){return this.wh.activeTargetIds.has(t)},el.prototype.Hu=function(t){delete this.Th[t]},el.prototype.$u=function(){return this.wh.activeTargetIds},el.prototype.Bu=function(t){return this.wh.activeTargetIds.has(t)},el.prototype.start=function(){return this.wh=new zf,Promise.resolve()},el.prototype.Xu=function(t,e,n){},el.prototype.Zu=function(t){},el.prototype.pa=function(){},el.prototype.er=function(t){},el.prototype.eh=function(){},el),Qf=function(t){this.key=t},Wf=function(t){this.key=t},Yf=(Object.defineProperty(tl.prototype,"Ph",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),tl.prototype.gh=function(t,e){var s=this,u=e?e.Vh:new qi,a=(e||this).Rh,c=(e||this).Qt,h=a,f=!1,l=su(this.query)&&a.size===this.query.limit?a.last():null,p=uu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof Js?e:null)&&(wu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.yh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),su(this.query)||uu(this.query))for(;h.size>this.query.limit;){var n=su(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,Vh:u,ph:f,Qt:c}},tl.prototype.yh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},tl.prototype.bi=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.Qt=t.Qt;var i=t.Vh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],n=0===this.mh.size&&this.Zt?1:0,e=n!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Bi(this.query,t.Rh,r,i,t.Qt,0==n,e,!1),Dh:s}:{Dh:s}},tl.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.bi({Rh:this.Rh,Vh:new qi,Qt:this.Qt,ph:!1},!1)):{Dh:[]}},tl.prototype.Ch=function(t){return!this.Eh.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).Je},tl.prototype.bh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Eh=e.Eh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Eh=e.Eh.delete(t)}),this.Zt=t.Zt)},tl.prototype.Sh=function(){var e=this;if(!this.Zt)return[];var n=this.mh;this.mh=Ui(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Wf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Qf(t))}),r},tl.prototype.Nh=function(t){this.Eh=t.Xa,this.mh=Ui();t=this.gh(t.documents);return this.bi(t,!0)},tl.prototype.xh=function(){return Bi.jt(this.query,this.Rh,this.Qt,0===this.Ih)},tl),Xf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Jf=function(t){this.key=t,this.Fh=!1},$f=(Object.defineProperty(Zf.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),Zf);function Zf(t,e,n,r,i,o){this.Kc=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new zr(gu,vu),this.qh=new Map,this.Uh=[],this.Qh=new Ii($r.V),this.Kh=new Map,this.Wh=new Cf,this.jh={},this.Gh=new Map,this.zh=_h.vo(),this.onlineState="Unknown",this.Hh=void 0}function tl(t,e){this.query=t,this.Eh=e,this.Ih=null,this.Zt=!1,this.mh=Ui(),this.Qt=Ui(),this.Ah=bu(t),this.Rh=new Fi(this.Ah)}function el(){this.wh=new zf,this.Th={},this.Oc=null,this.Xi=null}function nl(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.Pu=r,this.gu=null,this.Oc=null,this.Xi=null,this.Vu=this.yu.bind(this),this.pu=new Ii(Rr),this.yr=!1,this.vu=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.bu=Mf(this.persistenceKey,this.Pu),this.Su="firestore_sequence_number_"+this.persistenceKey,this.pu=this.pu.rt(this.Pu,new zf),this.Du=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Cu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Nu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xu="firestore_online_state_"+this.persistenceKey,this.Fu="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Vu)}function rl(){this.activeTargetIds=ji}function il(t,e){this.clientId=t,this.onlineState=e}function ol(t,e){this.clientId=t,this.activeTargetIds=e}function sl(t,e,n){this.targetId=t,this.state=e,this.error=n}function ul(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function al(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Yh(r.Kc,i.query,!1).then(function(t){t=t.documents;return i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.bi(e,r.Jh,n),[2,(ml(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Yh(i.Kc,o,!0)];case 1:return n=t.sent(),r=new Yf(o,n.Xa),e=r.gh(n.documents),n=zi.Xt(s,u&&"Offline"!==i.onlineState),n=r.bi(e,i.Jh,n),ml(i,s,n.Dh),r=new Xf(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function cl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Al(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Kc,a=p,h=i,f=Qr.now(),o=a.reduce(function(t,e){return t.add(e.key)},Ui()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ga.Li(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Rs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Js?t.field(i.field):void 0,o=Zo(i.transform,o||null);null!=o&&(e=(null==e?new Gs:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new ks(i.key,o,function s(t){var u=[];return jr(t.fields||{},function(t,e){var n=new Jr([t]);if(Io(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new vs(u)}(o.proto.mapValue),bs.exists(!0)))}return h.xi.Qr(u,f,e,a)})}).then(function(t){var e=t.wi(c);return{batchId:t.batchId,Ii:e}}))];case 2:return s=t.sent(),u.kh.qu(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.Ys()])||new Ii(Rr)).rt(n,r),e.jh[e.currentUser.Ys()]=i,[4,bl(u,s.Ii)];case 3:return t.sent(),[4,Af(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ia(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function hl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Hh(n.Kc,i)];case 2:return e=t.sent(),i.Gt.forEach(function(t,e){e=n.Kh.get(e);e&&(Pr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Fh=!0:0<t.ee.size?Pr(e.Fh):0<t.ne.size&&(Pr(e.Fh),e.Fh=!1))}),[4,bl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Zh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function fl(t,n,e){var r,t=t;(t.Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){e=e.view.Bs(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Bs(i)&&(o=!0)}),o&&Sa(t)}(t.Mh,n),r.length&&t.Lh.Rc(r),t.onlineState=n,t.Jh&&t.kh.Zu(n))}function ll(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.xi.Wr(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.xi.Yr(e,t)}).next(function(){return i.xi.no(e)}).next(function(){return i.Ga.Li(e,n)})}))];case 2:return o=t.sent(),yl(n,u,a),dl(n,u),n.kh.Qu(u,"rejected",a),[4,bl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Zh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function pl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Ef((n=o).Oh)||Ar("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Kc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.xi.zr(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ia(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function dl(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function yl(t,e,n){var r=t,i=r.jh[r.currentUser.Ys()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.Ys()]=i)}function vl(e,t,n){void 0===n&&(n=null),e.kh.Gu(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.du(t).forEach(function(t){e.Wh.so(t)||gl(e,t)})}function gl(t,e){var n=t.Qh.get(e);null!==n&&(gf(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),wl(t))}function ml(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Qf?(t.Wh.Qo(o.key,e),function(t,e){e=e.key;t.Qh.get(e)||(Ar("SyncEngine","New document in limbo: "+e),t.Uh.push(e),wl(t))}(t,o)):o instanceof Wf?(Ar("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.Wo(o.key,e),t.Wh.so(o.key)||gl(t,o.key)):Dr()}}function wl(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Jf(e)),t.Qh=t.Qh.rt(e,n),vf(t.Oh,new wi(lu(ou(e.path)),n,2,$a.nr))}}function bl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.T()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ju(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ja.Yi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.Rc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ta.forEach(c,function(e){return ta.forEach(e.Hi,function(t){return r.persistence.Lr.Qo(n,e.targetId,t)}).next(function(){return ta.forEach(e.Ji,function(t){return r.persistence.Lr.Wo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Ar("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Qa.get(o),u=s.et,u=s.it(u),r.Qa=r.Qa.rt(o,u));return[2]}})})}(n.Kc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function _l(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ar("SyncEngine","User change. New user:",o.Ys()),[4,Gh(n.Kc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new Hr(Kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xu(o,r.Ja,r.Ya),[4,bl(n,r.Ha)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function El(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Kc,n=a,i=(r=e).xi,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.jr(e,n).next(function(t){return t?r.Ga.Li(e,t):ta.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Af(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(yl(o,a,h||null),dl(o,a),o.Kc.xi.Zr(a)):Dr(),t.label=4;case 4:return[4,bl(o,s)];case 5:return t.sent(),[3,7];case 6:Ar("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Il(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return xl(r=h),Al(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$u(),[4,Tl(r,e.O())]);case 1:return i=t.sent(),r.Hh=!0,[4,kf(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],vf(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.zu(e)?a.push(e):c=c.then(function(){return vl(r,e),Wh(r.Kc,e,!0)}),gf(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,Tl(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){gf(n.Oh,e)}),n.Wh.wu(),n.Kh=new Map,n.Qh=new Ii($r.V),r.Hh=!1,[4,kf(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Tl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,Qh(e.Kc,lu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Yh((e=r).Kc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&ml(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Xh(e.Kc,s)];case 8:return l=t.sent(),[4,Qh(e.Kc,l)];case 9:return u=t.sent(),[4,al(e,Nl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.Rc(r),n)]}})})}function Nl(t){return iu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function xl(t){return t.Oh.jc.nu=hl.bind(null,t),t.Oh.jc.Be=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Ui().add(t.key);var r=Ui();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Ot(s.view.Ph);return r}.bind(null,t),t.Oh.jc.eu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ju(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new Ii($r.V)).rt(n,new $s(n,Wr.min())),i=Ui().add(n),i=new Gi(Wr.min(),new Map,new ki(Rr),r,i),[4,hl(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),wl(e),[3,4];case 2:return[4,Wh(e.Kc,s,!1).then(function(){return vl(e,s,u)}).catch(Zh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.Rc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].qs(s)&&(r=!0);u.ks=s}}r&&Sa(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function Al(t){return t.Oh.jc.su=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,zh(e.Kc,o)];case 2:return r=t.sent(),yl(e,n,null),dl(e,n),e.kh.Qu(n,"acknowledged"),[4,bl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Zh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Oh.jc.iu=ll.bind(null,t),t}var Sl,Ol,kl,Dl,Pl,Cl=(gp.prototype.za=function(t){this.Zh=t},gp.prototype.Ui=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.B())||i.isEqual(Wr.min())?this.tl(e,r):this.Zh.Li(e,o).next(function(t){var n=s.el(r,t);return(su(r)||uu(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(xr()<=l.DEBUG&&Ar("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mu(r)),s.Zh.Ui(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},gp.prototype.el=function(n,t){var r=new ki(bu(n));return t.forEach(function(t,e){e instanceof Js&&wu(n,e)&&(r=r.add(e))}),r},gp.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.A(r))},gp.prototype.tl=function(t,e){return xr()<=l.DEBUG&&Ar("IndexFreeQueryEngine","Using full collection scan to execute query:",mu(e)),this.Zh.Ui(t,e,Wr.min())},gp),Ll=(vp.prototype.Ur=function(t){return ta.resolve(0===this.xi.length)},vp.prototype.Qr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.xi.length&&this.xi[this.xi.length-1];n=new Ua(i,e,n,r);this.xi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new Lf(u.key,i)),this.Fi.Kr(t,u.key.path.S())}return ta.resolve(n)},vp.prototype.Wr=function(t,e){return ta.resolve(this.il(e))},vp.prototype.Gr=function(t,e){e+=1,e=this.rl(e),e=e<0?0:e;return ta.resolve(this.xi.length>e?this.xi[e]:null)},vp.prototype.zr=function(){return ta.resolve(0===this.xi.length?-1:this.nl-1)},vp.prototype.Hr=function(t){return ta.resolve(this.xi.slice())},vp.prototype.Mi=function(t,e){var n=this,r=new Lf(e,0),e=new Lf(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Nt([r,e],function(t){t=n.il(t.Eu);i.push(t)}),ta.resolve(i)},vp.prototype.qi=function(t,e){var n=this,r=new ki(Rr);return e.forEach(function(t){var e=new Lf(t,0),t=new Lf(t,Number.POSITIVE_INFINITY);n.sl.Nt([e,t],function(t){r=r.add(t.Eu)})}),ta.resolve(this.ol(r))},vp.prototype.Gi=function(t,e){var n=e.path,r=n.length+1,e=n;$r.G(e)||(e=e.child(""));var e=new Lf(new $r(e),0),i=new ki(Rr);return this.sl.xt(function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(i=i.add(t.Eu)),!0)},e),ta.resolve(this.ol(i))},vp.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){t=e.il(t);null!==t&&n.push(t)}),n},vp.prototype.Yr=function(n,r){var i=this;Pr(0===this.al(r.batchId,"removed")),this.xi.shift();var o=this.sl;return ta.forEach(r.mutations,function(t){var e=new Lf(t.key,r.batchId);return o=o.delete(e),i.Lr.eo(n,t.key)}).next(function(){i.sl=o})},vp.prototype.Zr=function(t){},vp.prototype.so=function(t,e){var n=new Lf(e,0),n=this.sl.Ft(n);return ta.resolve(e.isEqual(n&&n.key))},vp.prototype.no=function(t){return this.xi.length,ta.resolve()},vp.prototype.al=function(t,e){return this.rl(t)},vp.prototype.rl=function(t){return 0===this.xi.length?0:t-this.xi[0].batchId},vp.prototype.il=function(t){t=this.rl(t);return t<0||t>=this.xi.length?null:this.xi[t]},vp),Rl=(yp.prototype.Ri=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.cl(e);return this.docs=this.docs.rt(r,{gi:e,size:i,readTime:n}),this.size+=i-o,this.Fi.Kr(t,r.path.S())},yp.prototype.Vi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},yp.prototype.yi=function(t,e){e=this.docs.get(e);return ta.resolve(e?e.gi:null)},yp.prototype.getEntries=function(t,e){var n=this,r=Pi;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.gi:null)}),ta.resolve(r)},yp.prototype.Ui=function(t,e,n){for(var r=Ri,i=new $r(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,s=a.gi,a=a.readTime;if(!e.path.N(u.path))break;a.A(n)<=0||s instanceof Js&&wu(e,s)&&(r=r.rt(s.key,s))}return ta.resolve(r)},yp.prototype.ul=function(t,e){return ta.forEach(this.docs,function(t){return e(t)})},yp.prototype._o=function(t){return new Vl(this)},yp.prototype.wo=function(t){return ta.resolve(this.size)},yp),Vl=(n(dp,Pl=h),dp.prototype.bi=function(n){var r=this,i=[];return this.Ii.forEach(function(t,e){e&&e.gi?i.push(r.To.Ri(n,e.gi,r.Ai(t))):r.To.Vi(t)}),ta.xn(i)},dp.prototype.pi=function(t,e){return this.To.yi(t,e)},dp.prototype.vi=function(t,e){return this.To.getEntries(t,e)},dp),Ml=(pp.prototype.De=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),ta.resolve()},pp.prototype.Co=function(t){return ta.resolve(this.lastRemoteSnapshotVersion)},pp.prototype.No=function(t){return ta.resolve(this.ll)},pp.prototype.bo=function(t){return this.highestTargetId=this.fl.next(),ta.resolve(this.highestTargetId)},pp.prototype.xo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),ta.resolve()},pp.prototype.Oo=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},pp.prototype.Fo=function(t,e){return this.Oo(e),this.targetCount+=1,ta.resolve()},pp.prototype.ko=function(t,e){return this.Oo(e),ta.resolve()},pp.prototype.$o=function(t,e){return this.hl.delete(e.target),this._l.du(e.targetId),--this.targetCount,ta.resolve()},pp.prototype.Nr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.Lo(n,e.targetId)),s++)}),ta.xn(u).next(function(){return s})},pp.prototype.Bo=function(t){return ta.resolve(this.targetCount)},pp.prototype.qo=function(t,e){e=this.hl.get(e)||null;return ta.resolve(e)},pp.prototype.Uo=function(t,e,n){return this._l.lu(e,n),ta.resolve()},pp.prototype.Ko=function(e,t,n){this._l.fu(t,n);var r=this.persistence.Lr,i=[];return r&&t.forEach(function(t){i.push(r.eo(e,t))}),ta.xn(i)},pp.prototype.Lo=function(t,e){return this._l.du(e),ta.resolve()},pp.prototype.jo=function(t,e){e=this._l.Tu(e);return ta.resolve(e)},pp.prototype.so=function(t,e){return ta.resolve(this._l.so(e))},pp),Ul=(lp.prototype.mo=function(t,e){return ta.resolve(this.dl.get(e))},lp.prototype.Ao=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Po(e.createTime)}),ta.resolve()},lp.prototype.Ro=function(t,e){return ta.resolve(this.wl.get(e))},lp.prototype.Po=function(t,e){return this.wl.set(e.name,{name:(e=e).name,query:xc(e.bundledQuery),readTime:Po(e.readTime)}),ta.resolve()},lp),jl=(fp.prototype.start=function(){return Promise.resolve()},fp.prototype.pa=function(){return this.Yo=!1,Promise.resolve()},Object.defineProperty(fp.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),fp.prototype.fa=function(){},fp.prototype.da=function(){},fp.prototype.Oa=function(){return this.Fi},fp.prototype.Na=function(t){var e=this.Tl[t.Ys()];return e||(e=new Ll(this.Fi,this.Lr),this.Tl[t.Ys()]=e),e},fp.prototype.xa=function(){return this.ra},fp.prototype.Fa=function(){return this.Ni},fp.prototype.Ma=function(){return this.oa},fp.prototype.runTransaction=function(t,e,n){var r=this;Ar("MemoryPersistence","Starting transaction:",t);var i=new Fl(this.Jo.next());return this.Lr.Il(),n(i).next(function(t){return r.Lr.ml(i).next(function(){return t})}).Cn().then(function(t){return i.Ci(),t})},fp.prototype.Al=function(e,n){return ta.Fn(Object.values(this.Tl).map(function(t){return function(){return t.so(e,n)}}))},fp),Fl=(n(hp,Dl=Ee),hp),ql=(cp.gl=function(t){return new cp(t)},Object.defineProperty(cp.prototype,"Vl",{get:function(){if(this.Pl)return this.Pl;throw Dr()},enumerable:!1,configurable:!0}),cp.prototype.Qo=function(t,e,n){return this.Rl.Qo(n,e),this.Vl.delete(n.toString()),ta.resolve()},cp.prototype.Wo=function(t,e,n){return this.Rl.Wo(n,e),this.Vl.add(n.toString()),ta.resolve()},cp.prototype.eo=function(t,e){return this.Vl.add(e.toString()),ta.resolve()},cp.prototype.removeTarget=function(t,e){var n=this;this.Rl.du(e.targetId).forEach(function(t){return n.Vl.add(t.toString())});var r=this.persistence.xa();return r.jo(t,e.targetId).next(function(t){t.forEach(function(t){return n.Vl.add(t.toString())})}).next(function(){return r.$o(t,e)})},cp.prototype.Il=function(){this.Pl=new Set},cp.prototype.ml=function(n){var r=this,i=this.persistence.Fa()._o();return ta.forEach(this.Vl,function(t){var e=$r.K(t);return r.yl(n,e).next(function(t){t||i.Vi(e)})}).next(function(){return r.Pl=null,i.apply(n)})},cp.prototype.qa=function(t,e){var n=this;return this.yl(t,e).next(function(t){t?n.Vl.delete(e.toString()):n.Vl.add(e.toString())})},cp.prototype.El=function(t){return 0},cp.prototype.yl=function(t,e){var n=this;return ta.Fn([function(){return ta.resolve(n.Rl.so(e))},function(){return n.persistence.xa().so(t,e)},function(){return n.persistence.Al(t,e)}])},cp),Bl=(ap.prototype.mc=function(t){this.bl=t},ap.prototype.dc=function(t){this.Sl=t},ap.prototype.onMessage=function(t){this.Dl=t},ap.prototype.close=function(){this.vl()},ap.prototype.send=function(t){this.pl(t)},ap.prototype.Cl=function(){this.bl()},ap.prototype.Nl=function(t){this.Sl(t)},ap.prototype.xl=function(t){this.Dl(t)},ap),Gl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zl=(up.prototype.xc=function(e,t,n,r){var i=this.kl(e,t);Ar("RestConnection","Sending: ",i,n);t={};return this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Ar("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},up.prototype.Fc=function(t,e,n,r){return this.xc(t,e,n,r)},up.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2",t["Content-Type"]="text/plain",e)for(var n in e.ti)e.ti.hasOwnProperty(n)&&(t[n]=e.ti[n])},up.prototype.kl=function(t,e){t=Gl[t];return this.Ol+"/v1/"+e+":"+t},n(sp,kl=up),sp.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Ar("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Ar("Connection",'RPC "'+o+'" timed out'),r(new Hr(Kr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Ar("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Kr).indexOf(e)?e:Kr.UNKNOWN,r(new Hr(e,t.message))):r(new Hr(Kr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Hr(Kr.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Ar("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},sp.prototype.Ac=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Ar("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Bl({pl:function(t){u?Ar("Connection","Not sending because WebChannel is closed:",t):(s||(Ar("Connection","Opening WebChannel transport."),o.open(),s=!0),Ar("Connection","WebChannel sending:",t),o.send(t))},vl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Ar("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Ar("Connection","WebChannel transport closed"),a.Nl())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Or("Connection","WebChannel transport errored:",t),a.Nl(new Hr(Kr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ar("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=mi[r];if(void 0!==t)return Ei(t)}(),i=n.message,void 0===t&&(t=Kr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Nl(new Hr(t,i)),o.close()):(Ar("Connection","WebChannel received:",e),a.xl(e)))}),setTimeout(function(){a.Cl()},0),a},sp),Kl=(op.prototype.Xc=function(t){this.Kl.push(t)},op.prototype.pa=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},op.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},op.prototype.ql=function(){Ar("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},op.prototype.Ql=function(){Ar("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},op.kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},op),Hl=(ip.prototype.Xc=function(t){},ip.prototype.pa=function(){},ip),Ql=(rp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Qa(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Kc=this.Jl(e),[2]}})})},rp.prototype.Hl=function(t){return null},rp.prototype.Jl=function(t){return Bh(this.persistence,new Cl,t.Yl,this.serializer)},rp.prototype.Gl=function(t){return new jl(ql.gl,this.serializer)},rp.prototype.jl=function(t){return new Hf},rp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.pa()];case 1:return t.sent(),[4,this.persistence.pa()];case 2:return t.sent(),[2]}})})},rp),Wl=(n(np,Ol=Ql),np.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ol.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,$h(this.Kc)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,Al(this.Xl.gu)];case 4:return t.sent(),[4,Af(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},np.prototype.Jl=function(t){return Bh(this.persistence,new Cl,t.Yl,this.serializer)},np.prototype.Hl=function(t){var e=this.persistence.Lr.Rr;return new cc(e,t.rs)},np.prototype.Gl=function(t){var e=jh(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?sc.Tr(this.cacheSizeBytes):sc.mr;return new Dh(this.synchronizeTabs,e,t.clientId,n,t.rs,ga(),ma(),this.serializer,this.kh,!!this.forceOwnership)},np.prototype.jl=function(t){return new Hf},np),Yl=(n(ep,Sl=Wl),ep.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Sl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.gu,this.kh instanceof Kf?(this.kh.gu={_h:El.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Ar("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Jh(e.Kc)];case 3:return n=t.sent(),r=Gi.Yt(o,"current"===s),[4,bl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Wh(e.Kc,o,!0)];case 6:return t.sent(),vl(e,o,u),[3,8];case 7:Dr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=xl(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Ar("SyncEngine","Adding an already active target "+r),[3,5]):[4,Xh(n.Kc,r)]):[3,6];case 2:return i=t.sent(),[4,Qh(n.Kc,i)];case 3:return o=t.sent(),[4,al(n,Nl(i),o.targetId,!1)];case 4:t.sent(),vf(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,Wh(n.Kc,e,!1).then(function(){gf(n.Oh,e),vl(n,e)}).catch(Zh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ca:function(t){return t.Kc.persistence.Ca()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Jh((e=n).Kc).then(function(t){return bl(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence._a(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Il(this.Xl.gu,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.yr?this.zl.start(this.Kc):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},ep.prototype.jl=function(t){var e=ga();if(!Kf.kn(e))throw new Hr(Kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=jh(t.Fl.t,t.Fl.persistenceKey);return new Kf(e,t.rs,n,t.clientId,t.Yl)},ep),Xl=(tp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Kc?[3,2]:(this.Kc=n.Kc,this.kh=n.kh,this.Wc=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.gu=this.n_(r,!n.synchronizeTabs),this.kh.Oc=function(t){return fl(e.gu,t,1)},this.Oh.jc.s_=_l.bind(null,this.gu),[4,kf(this.Oh,this.gu.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},tp.prototype.e_=function(t){return new Ta},tp.prototype.Zl=function(t){var e=Qa(t.Fl.t),n=(n=t.Fl,new zl(n));return t=t.credentials,new uf(t,n,e)},tp.prototype.t_=function(t){var e=this,n=this.Kc,r=this.Wc,i=t.rs,o=function(t){return fl(e.gu,t,0)},t=new(Kl.kn()?Kl:Hl);return new tf(n,r,i,o,t)},tp.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new $f(t,e,n,r,i,o);return s&&(o.Hh=!0),o}(this.Kc,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},tp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ar("RemoteStore","RemoteStore shutting down."),e.Hc.add(5),[4,yf(e)];case 1:return t.sent(),e.Yc.pa(),e.Zc.set("Unknown"),[2]}})})}(this.Oh)},tp),Jl=(Zl.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Zl.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Zl.prototype.r_=function(){this.muted=!0},Zl.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Zl),$l=function(t){this.o_=t};function Zl(t){this.observer=t,this.muted=!1}function tp(){}function ep(t,e){var n=this;return(n=Sl.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function np(t,e,n){var r=this;return(r=Ol.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function rp(){this.synchronizeTabs=!1}function ip(){}function op(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function sp(t){var e=this;return(e=kl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function up(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function ap(t){this.pl=t.pl,this.vl=t.vl}function cp(t){this.persistence=t,this.Rl=new Cf,this.Pl=null}function hp(t){var e=this;return(e=Dl.call(this)||this).Go=t,e}function fp(t,e){var n=this;this.Tl={},this.Jo=new $a(0),this.Yo=!1,this.Yo=!0,this.Lr=t(this),this.ra=new Ml(this),this.Fi=new Gc,this.Ni=(t=this.Fi,new Rl(t,function(t){return n.Lr.El(t)})),this.serializer=new vc(e),this.oa=new Ul(this.serializer)}function lp(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function pp(t){this.persistence=t,this.hl=new zr(li,pi),this.lastRemoteSnapshotVersion=Wr.min(),this.highestTargetId=0,this.ll=0,this._l=new Cf,this.targetCount=0,this.fl=_h.po()}function dp(t){var e=this;return(e=Pl.call(this)||this).To=t,e}function yp(t,e){this.Fi=t,this.cl=e,this.docs=new Ii($r.V),this.size=0}function vp(t,e){this.Fi=t,this.Lr=e,this.xi=[],this.nl=1,this.sl=new ki(Lf.cu)}function gp(){}function mp(t,e,n){if(!n)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function wp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function bp(t,e,n,r){if(!0===e&&!0===r)throw new Hr(Kr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function _p(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Dr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ep(t,e){if(t instanceof $l&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new Hr(Kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=_p(t);throw new Hr(Kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Ip(t,e){if(e<=0)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Tp,Np=function(t){this.a_=t},xp=(n(Ap,Tp=Np),Ap.prototype.c_=function(t){if(2!==t.u_)throw 1===t.u_?t.h_(this.a_+"() can only appear at the top level of your update data"):t.h_(this.a_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Ap.prototype.isEqual=function(t){return t instanceof Ap},Ap);function Ap(){return null!==Tp&&Tp.apply(this,arguments)||this}function Sp(t,e,n){return new Td({u_:3,l_:e.settings.l_,methodName:t.a_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Op,kp,Dp,Pp,Cp=(n(Qp,Pp=Np),Qp.prototype.c_=function(t){return new gs(t.path,new ns)},Qp.prototype.isEqual=function(t){return t instanceof Qp},Qp),Lp=(n(Hp,Dp=Np),Hp.prototype.c_=function(t){var e=Sp(this,t,!0),n=this.f_.map(function(t){return Pd(t,e)}),n=new rs(n);return new gs(t.path,n)},Hp.prototype.isEqual=function(t){return this===t},Hp),Rp=(n(Kp,kp=Np),Kp.prototype.c_=function(t){var e=Sp(this,t,!0),n=this.f_.map(function(t){return Pd(t,e)}),n=new as(n);return new gs(t.path,n)},Kp.prototype.isEqual=function(t){return this===t},Kp),Vp=(n(zp,Op=Np),zp.prototype.c_=function(t){var e=new ls(t.serializer,Oo(t.serializer,this.d_));return new gs(t.path,e)},zp.prototype.isEqual=function(t){return this===t},zp),Mp=(Object.defineProperty(Gp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Gp.prototype,"longitude",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Gp.prototype.isEqual=function(t){return this.w_===t.w_&&this.T_===t.T_},Gp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.T_}},Gp.prototype.I=function(t){return Rr(this.w_,t.w_)||Rr(this.T_,t.T_)},Gp),Up=(Bp.fromBase64String=function(t){try{return new Bp(yi.fromBase64String(t))}catch(t){throw new Hr(Kr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Bp.fromUint8Array=function(t){return new Bp(yi.fromUint8Array(t))},Bp.prototype.toBase64=function(){return this.E_.toBase64()},Bp.prototype.toUint8Array=function(){return this.E_.toUint8Array()},Bp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Bp.prototype.isEqual=function(t){return this.E_.isEqual(t.E_)},Bp),jp=new Map,Fp=(qp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},qp);function qp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Hr(Kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Hr(Kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,bp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Bp(t){this.E_=t}function Gp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Hr(Kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Hr(Kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.T_=e}function zp(t,e){var n=this;return(n=Op.call(this,t)||this).d_=e,n}function Kp(t,e){var n=this;return(n=kp.call(this,t)||this).f_=e,n}function Hp(t,e){var n=this;return(n=Dp.call(this,t)||this).f_=e,n}function Qp(){return null!==Pp&&Pp.apply(this,arguments)||this}function Wp(){if("undefined"==typeof Uint8Array)throw new Hr(Kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Yp(){if("undefined"==typeof atob)throw new Hr(Kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Xp,Jp,$p,Zp=(n(sd,$p=Up),sd.fromBase64String=function(t){Yp();try{return new sd(yi.fromBase64String(t))}catch(t){throw new Hr(Kr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},sd.fromUint8Array=function(t){return Wp(),new sd(yi.fromUint8Array(t))},sd.prototype.toBase64=function(){return Yp(),$p.prototype.toBase64.call(this)},sd.prototype.toUint8Array=function(){return Wp(),$p.prototype.toUint8Array.call(this)},sd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},sd),h=(od.prototype.I_=function(t,e){switch(void 0===e&&(e="none"),ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vo(t.integerValue||t.doubleValue);case 3:return this.m_(t.timestampValue);case 4:return this.A_(t,e);case 5:return t.stringValue;case 6:return this.R_(go(t.bytesValue));case 7:return this.P_(t.referenceValue);case 8:return this.g_(t.geoPointValue);case 9:return this.V_(t.arrayValue,e);case 10:return this.y_(t.mapValue,e);default:throw Dr()}},od.prototype.y_=function(t,n){var r=this,i={};return jr(t.fields||{},function(t,e){i[t]=r.I_(e,n)}),i},od.prototype.g_=function(t){return new Mp(vo(t.latitude),vo(t.longitude))},od.prototype.V_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.I_(t,e)})},od.prototype.A_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return oo(e)?t(e):e}(t);return null==n?null:this.I_(n,e);case"estimate":return this.m_(so(t));default:return null}},od.prototype.m_=function(t){t=yo(t);return new Qr(t.seconds,t.nanos)},od.prototype.p_=function(t,e){var n=Yr.k(t);Pr($o(n));t=new Ir(n.get(1),n.get(3)),n=new $r(n.v(5));return t.isEqual(e)||Sr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},od),td=(n(id,Jp=h),id.prototype.R_=function(t){return new Zp(t)},id.prototype.P_=function(t){t=this.p_(t,this.firestore.v_);return Vy.b_(t,this.firestore,null)},id),Ee=(Object.defineProperty(rd.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"ref",{get:function(){return new hd(this.S_,this.x_,this.C_)},enumerable:!1,configurable:!0}),rd.prototype.exists=function(){return null!==this.N_},rd.prototype.data=function(){if(this.N_){if(this.x_){var t=new ed(this.S_,this.D_,this.C_,this.N_,null);return this.x_.fromFirestore(t)}return this.D_.I_(this.N_.sn())}},rd.prototype.get=function(t){if(this.N_){t=this.N_.data().field(ud("DocumentSnapshot.get",t));if(null!==t)return this.D_.I_(t)}},rd),ed=(n(nd,Xp=Ee),nd.prototype.data=function(){return Xp.prototype.data.call(this)},nd);function nd(){return null!==Xp&&Xp.apply(this,arguments)||this}function rd(t,e,n,r,i){this.S_=t,this.D_=e,this.C_=n,this.N_=r,this.x_=i}function id(t){var e=this;return(e=Jp.call(this)||this).firestore=t,e}function od(){}function sd(){return null!==$p&&$p.apply(this,arguments)||this}function ud(t,e){return"string"==typeof e?Ud(t,e):(e instanceof $l?e.o_:e).F_}var ad,cd=(vd.prototype.isEqual=function(t){return this.F_.isEqual(t.F_)},vd),hd=(Object.defineProperty(yd.prototype,"O_",{get:function(){return this.C_.path},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"path",{get:function(){return this.C_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"parent",{get:function(){return new ld(this.firestore,this.x_,this.C_.path.S())},enumerable:!1,configurable:!0}),yd.prototype.withConverter=function(t){return new yd(this.firestore,t,this.C_)},yd),fd=(dd.prototype.withConverter=function(t){return new dd(this.firestore,t,this.M_)},dd),ld=(n(pd,ad=fd),Object.defineProperty(pd.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"parent",{get:function(){var t=this.O_.S();return t.T()?null:new hd(this.firestore,null,new $r(t))},enumerable:!1,configurable:!0}),pd.prototype.withConverter=function(t){return new pd(this.firestore,t,this.O_)},pd);function pd(t,e,n){var r=this;return(r=ad.call(this,t,e,ou(n))||this).firestore=t,r.O_=n,r.type="collection",r}function dd(t,e,n){this.x_=e,this.M_=n,this.type="query",this.firestore=t}function yd(t,e,n){this.x_=e,this.C_=n,this.type="document",this.firestore=t}function vd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new Jr(t)}function gd(t){var e=t.k_(),n=Qa(t.v_);return new Nd(t.v_,!!e.ignoreUndefinedProperties,n)}var md=/^__.*__$/,wd=(Ed.prototype.L_=function(t,e){var n=[];return null!==this.Qe?n.push(new ks(t,this.data,this.Qe,e)):n.push(new Os(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Rs(t,this.fieldTransforms)),n},Ed),bd=(_d.prototype.L_=function(t,e){e=[new ks(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new Rs(t,this.fieldTransforms)),e},_d);function _d(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Ed(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Id(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Dr()}}var Td=(Object.defineProperty(Ad.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"u_",{get:function(){return this.settings.u_},enumerable:!1,configurable:!0}),Ad.prototype.q_=function(t){return new Ad(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Ad.prototype.U_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.q_({path:e,__:!1});return e.Q_(t),e},Ad.prototype.K_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.q_({path:t,__:!1});return t.B_(),t},Ad.prototype.W_=function(t){return this.q_({path:void 0,__:!0})},Ad.prototype.h_=function(t){return jd(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.l_)},Ad.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.N(t)})||void 0!==this.fieldTransforms.find(function(t){return e.N(t.field)})},Ad.prototype.B_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Q_(this.path.get(t))},Ad.prototype.Q_=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Id(this.u_)&&md.test(t))throw this.h_('Document fields cannot begin and end with "__"')},Ad),Nd=(xd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Td({u_:t,methodName:e,l_:n,path:Jr.$(),__:!1,j_:r},this.t,this.serializer,this.ignoreUndefinedProperties)},xd);function xd(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Qa(t)}function Ad(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.B_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Sd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Rd("Data must be an object, but it was:",s,r);var u,a,r=Cd(r,s);if(o.merge)u=new vs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Vd(e,f[h],n);if(!s.contains(l))throw new Hr(Kr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Fd(c,l)||c.push(l)}u=new vs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new wd(new Bs(r),u,a)}function Od(t,r,i,e){var o=t.G_(1,r,i);Rd("Data must be an object, but it was:",o,e);var s=[],u=new Gs;jr(e,function(t,e){var n=Ud(r,t,i);e instanceof $l&&(e=e.o_);t=o.K_(n);e instanceof xp?s.push(n):null!=(t=Pd(e,t))&&(s.push(n),u.set(n,t))});e=new vs(s);return new bd(u.Ye(),e,o.fieldTransforms)}function kd(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Vd(e,r,n)],a=[i];if(o.length%2!=0)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Vd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Gs,y=u.length-1;0<=y;--y){Fd(p,u[y])||(h=u[y],(f=a[y])instanceof $l&&(f=f.o_),l=s.K_(h),f instanceof xp?p.push(h):null!=(l=Pd(f,l))&&(p.push(h),d.set(h,l)))}i=new vs(p);return new bd(d.Ye(),i,s.fieldTransforms)}function Dd(t,e,n,r){return void 0===r&&(r=!1),Pd(n,t.G_(r?4:3,e))}function Pd(s,t){if(s instanceof $l&&(s=s.o_),Ld(s))return Rd("Unsupported field value:",t,s),Cd(s,t);if(s instanceof Np)return function(t,e){if(!Id(e.u_))throw e.h_(t.a_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.a_+"() is not currently supported inside arrays");t=t.c_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.u_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Pd(i[r],t.W_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof $l&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Oo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Qr.fromDate(t);return{timestampValue:ko(e.serializer,n)}}if(t instanceof Qr){var r=new Qr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ko(e.serializer,r)}}if(t instanceof Mp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Up)return{bytesValue:Do(e.serializer,t.E_)};if(t instanceof hd){n=e.t,r=t.firestore.v_;if(!r.isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Co(t.firestore.v_||e.t,t.C_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+_p(t))}(s,t)}function Cd(t,n){var r={};return Fr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):jr(t,function(t,e){e=Pd(e,n.U_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Ld(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Qr||t instanceof Mp||t instanceof Up||t instanceof hd||t instanceof Np)}function Rd(t,e,n){if(!Ld(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=_p(n);throw"an object"===n?e.h_(t+" a custom object"):e.h_(t+" "+n)}var r}function Vd(t,e,n){if(e instanceof $l&&(e=e.o_),e instanceof cd)return e.F_;if("string"==typeof e)return Ud(t,e);throw jd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Md=new RegExp("[~\\*/\\[\\]]");function Ud(e,n,r){if(0<=n.search(Md))throw jd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(cd.bind.apply(cd,i([void 0],n.split("."))))).F_}catch(t){throw jd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function jd(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Hr(Kr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Fd(t,e){return t.some(function(t){return t.isEqual(e)})}var qd=(Hd.prototype.X_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Z_(),0<this.mutations.length)throw new Hr(Kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=jo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Ro(n.serializer,t)})},[4,n.Fc("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=Vo(t,e.found.name),t=Po(e.found.updateTime),e=new Bs({mapValue:{fields:e.found.fields}});return new Js(n,t,e,{})}(e,t):"missing"in t?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);t=Vo(t,e.missing),e=Po(e.readTime);return new $s(t,e)}(e,t):Dr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Pr(!!t),o.push(t)}),o)]}})})}(this.Wc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Js?n.tf(t):Dr()}),e)]}})})},Hd.prototype.set=function(t,e){this.write(e.L_(t,this.je(t))),this.Y_.add(t.toString())},Hd.prototype.update=function(t,e){try{this.write(e.L_(t,this.ef(t)))}catch(t){this.J_=t}this.Y_.add(t.toString())},Hd.prototype.delete=function(t){this.write([new Fs(t,this.je(t))]),this.Y_.add(t.toString())},Hd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Z_(),this.J_)throw this.J_;return e=this.z_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=$r.K(e);n.mutations.push(new qs(e,n.je(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=jo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Bo(e.serializer,t)})},[4,e.xc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wc,this.mutations)];case 1:return t.sent(),this.H_=!0,[2]}})})},Hd.prototype.tf=function(t){var e;if(t instanceof Js)e=t.version;else{if(!(t instanceof $s))throw Dr();e=Wr.min()}var n=this.z_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Hr(Kr.ABORTED,"Document version changed between two reads.")}else this.z_.set(t.key.toString(),e)},Hd.prototype.je=function(t){var e=this.z_.get(t.toString());return!this.Y_.has(t.toString())&&e?bs.updateTime(e):bs.Ge()},Hd.prototype.ef=function(t){var e=this.z_.get(t.toString());if(this.Y_.has(t.toString())||!e)return bs.exists(!0);if(e.isEqual(Wr.min()))throw new Hr(Kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bs.updateTime(e)},Hd.prototype.write=function(t){this.Z_(),this.mutations=this.mutations.concat(t)},Hd.prototype.Z_=function(){},Hd),Bd=(Kd.prototype.run=function(){this.sf()},Kd.prototype.sf=function(){var t=this;this.Ps.An(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new qd(this.Wc),(n=this.rf(e))&&n.then(function(t){r.rs.fs(function(){return e.commit().then(function(){r.us.resolve(t)}).catch(function(t){r.af(t)})})}).catch(function(t){r.af(t)}),[2]})})})},Kd.prototype.rf=function(t){try{var e=this.updateFunction(t);return!ui(e)&&e.catch&&e.then?e:(this.us.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.us.reject(t),null}},Kd.prototype.af=function(t){var e=this;0<this.nf&&this.cf(t)?(--this.nf,this.rs.fs(function(){return e.sf(),Promise.resolve()})):this.us.reject(t)},Kd.prototype.cf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!_i(t)},Kd),Gd=(zd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.oi.promise];case 1:return[2,(t.sent(),{rs:this.rs,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},zd.prototype.hf=function(t){var e=this;this.uf=t,this.oi.promise.then(function(){return e.uf(e.user)})},zd.prototype.lf=function(){if(this.rs.Vs)throw new Hr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},zd.prototype.terminate=function(){var t=this;this.rs.bs();var n=new $u;return this.rs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this._f?[4,this._f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ff?[4,this.ff.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.ii(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ia(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},zd);function zd(t,e,n){var r=this;this.credentials=t,this.rs=e,this.Fl=n,this.user=ka.UNAUTHENTICATED,this.clientId=Cr.u(),this.uf=function(){},this.oi=new $u,this.credentials.si(function(t){Ar("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.uf(t)),r.oi.resolve()})}function Kd(t,e,n,r){this.rs=t,this.Wc=e,this.updateFunction=n,this.us=r,this.nf=5,this.Ps=new Zu(this.rs,"transaction_retry")}function Hd(t){this.Wc=t,this.z_=new Map,this.mutations=[],this.H_=!1,this.J_=null,this.Y_=new Set}function Qd(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.rs.Ns(),Ar("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.hf(function(e){return r.rs.Ss(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Gh(i.Kc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.fa(function(){return r.terminate()}),r.ff=i,[2]}})})}function Wd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.rs.Ns(),[4,Yd(r)];case 1:return e=t.sent(),Ar("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.hf(function(t){return r.rs.Ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).rs.Ns(),Ar("RemoteStore","RemoteStore received new credentials"),n=Ef(e),e.Hc.add(3),[4,yf(e)];case 1:return t.sent(),n&&e.Zc.set("Unknown"),[4,e.jc.s_(i)];case 2:return t.sent(),e.Hc.delete(3),[4,df(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r._f=i,[2]}})})}function Yd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ff?[3,2]:(Ar("FirestoreClient","Using default OfflineComponentProvider"),[4,Qd(e,new Ql)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ff]}})})}function Xd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e._f?[3,2]:(Ar("FirestoreClient","Using default OnlineComponentProvider"),[4,Wd(e,new Xl)]);case 1:t.sent(),t.label=2;case 2:return[2,e._f]}})})}function Jd(t){return Yd(t).then(function(t){return t.persistence})}function $d(t){return Yd(t).then(function(t){return t.Kc})}function Zd(t){return Xd(t).then(function(t){return t.Oh})}function ty(t){return Xd(t).then(function(t){return t.gu})}function ey(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Xd(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ls=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=xl(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wu(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,Qh(e.Kc,lu(u))];case 2:return i=t.sent(),o=e.kh.Wu(i.targetId),n=i.targetId,[4,al(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&vf(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.gu),n.Us=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!vu(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Gu(n.targetId),e.kh.Bu(n.targetId)?[3,2]:[4,Wh(e.Kc,n.targetId,!1).then(function(){e.kh.Hu(n.targetId),gf(e.Oh,n.targetId),vl(e,n.targetId)}).catch(Zh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return vl(e,n.targetId),[4,Wh(e.Kc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.gu),n)]}})})}function ny(n,r){var t=this,i=new $u;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=cl,[4,ty(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function ry(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Ga.Oi(t,e)}))];case 1:return(r=t.sent())instanceof Js?s.resolve(r):r instanceof $s?s.resolve(null):s.reject(new Hr(Kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ia(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}function iy(n,r,i,o,s){var t=new Jl({next:function(t){r.fs(function(){return Aa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Hr(Kr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Hr(Kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Oa(ou(i.path),t,{includeMetadataChanges:!0,Hs:!0});return xa(n,u)}var oy,sy=(Object.defineProperty(ay.prototype,"app",{get:function(){if(!this.If)throw new Hr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.If},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"mf",{get:function(){return this.Tf},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"Af",{get:function(){return void 0!==this.Rf},enumerable:!1,configurable:!0}),ay.prototype.Pf=function(t){if(this.Tf)throw new Hr(Kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.wf=new Fp(t),void 0!==t.credentials&&(this.Ef=function(t){if(!t)return new La;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ma(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Hr(Kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},ay.prototype.gf=function(){return this.wf},ay.prototype.k_=function(){return this.Tf=!0,this.wf},ay.prototype._delete=function(){return this.Rf||(this.Rf=this.Vf()),this.Rf},ay.prototype.Vf=function(){return t=this,(e=jp.get(t))&&(Ar("ComponentProvider","Removing Datastore"),jp.delete(t),e.terminate()),Promise.resolve();var t,e},n(uy,oy=ay),uy.prototype.Vf=function(){return this.pf||Py(this),this.pf.terminate()},uy);function uy(t,e){var n=this;return(n=oy.call(this,t,e)||this).yf=new ba,n.df="name"in t?t.name:"[DEFAULT]",n}function ay(t,e){this.df="(lite)",this.wf=new Fp({}),this.Tf=!1,t instanceof Ir?(this.v_=t,this.Ef=new La):(this.If=t,this.v_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Hr(Kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(t.options.projectId)}(t),this.Ef=new Ra(e))}function cy(n,r,i){var t=this,o=new $u;return n.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Qd(n,i)];case 1:return t.sent(),[4,Wd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Kr.FAILED_PRECONDITION||t.code===Kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function hy(t){if(t.mf||t.Af)throw new Hr(Kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var fy,ly,py=(n(my,ly=Ee),my.prototype.exists=function(){return ly.prototype.exists.call(this)},my.prototype.data=function(t){if(void 0===t&&(t={}),this.N_){if(this.x_){var e=new dy(this.S_,this.D_,this.C_,this.N_,this.metadata,null);return this.x_.fromFirestore(e,t)}return this.D_.I_(this.N_.sn(),t.serverTimestamps)}},my.prototype.get=function(t,e){if(void 0===e&&(e={}),this.N_){t=this.N_.data().field(ud("DocumentSnapshot.get",t));if(null!==t)return this.D_.I_(t,e.serverTimestamps)}},my),dy=(n(gy,fy=py),gy.prototype.data=function(t){return void 0===t&&(t={}),fy.prototype.data.call(this,t)},gy),yy=(Object.defineProperty(vy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"size",{get:function(){return this.bf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),vy.prototype.forEach=function(e,n){var r=this;this.bf.docs.forEach(function(t){e.call(n,new dy(r.S_,r.D_,t.key,t,new Gy(r.bf.Qt.has(t.key),r.bf.fromCache),r.query.x_))})},vy.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.bf.Wt)throw new Hr(Kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Sf&&this.Df===t||(this.Sf=function(i,e){if(i.bf.Ut.T()){var n=0;return i.bf.docChanges.map(function(t){var e=new dy(i.S_,i.D_,t.doc.key,t.doc,new Gy(i.bf.Qt.has(t.doc.key),i.bf.fromCache),i.query.x_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.bf.Ut;return i.bf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new dy(i.S_,i.D_,t.doc.key,t.doc,new Gy(i.bf.Qt.has(t.doc.key),i.bf.fromCache),i.query.x_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Df=t),this.Sf},vy);function vy(t,e,n,r){this.S_=t,this.D_=e,this.bf=r,this.metadata=new Gy(r.hasPendingWrites,r.fromCache),this.query=n}function gy(){return null!==fy&&fy.apply(this,arguments)||this}function my(t,e,n,r,i,o){var s=this;return(s=ly.call(this,t,e,n,r,o)||this).S_=t,s.vf=t,s.metadata=i,s}function wy(t,e){return t instanceof py&&e instanceof py?t.S_===e.S_&&t.C_.isEqual(e.C_)&&(null===t.N_?null===e.N_:t.N_.isEqual(e.N_))&&t.x_===e.x_:t instanceof yy&&e instanceof yy&&t.S_===e.S_&&(n=t.query,r=e.query,n instanceof fd&&r instanceof fd&&n.firestore===r.firestore&&vu(n.M_,r.M_)&&n.x_===r.x_)&&t.metadata.isEqual(e.metadata)&&t.bf.isEqual(e.bf);var n,r}var by,_y=(n(Ey,by=h),Ey.prototype.R_=function(t){return new Up(t)},Ey.prototype.P_=function(t){t=this.p_(t,this.firestore.v_);return new hd(this.firestore,null,t)},Ey);function Ey(t){var e=this;return(e=by.call(this)||this).firestore=t,e}function Iy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Ep(t.firestore,sy),s=gd(o);return e instanceof $l&&(e=e.o_),Ty(o,("string"==typeof e||e instanceof cd?kd(s,"updateDoc",t.C_,e,n,r):Od(s,"updateDoc",t.C_,e)).L_(t.C_,bs.exists(!0)))}function Ty(t,e){return ny(Dy(t),e)}function Ny(t,e,n){var r=n.docs.get(e.C_),i=new _y(t);return new py(t,i,e.C_,r,new Gy(n.hasPendingWrites,n.fromCache),e.x_)}var xy,Ay=(ky.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){hy(t);var n=Dy(t),r=t.k_(),t=new Xl;return cy(n,t,new Wl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},ky.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){hy(t);var e=Dy(t),n=t.k_(),t=new Xl;return cy(e,t,new Yl(t,n.cacheSizeBytes))}(t.o_)},ky.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.mf&&!n.Af)throw new Hr(Kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new $u;return n.yf.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ea.kn()?(e=n+"main",[4,ea.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(jh(n.v_,n.df))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},ky),Sy=(n(Oy,xy=$l),Object.defineProperty(Oy.prototype,"v_",{get:function(){return this.o_.v_},enumerable:!1,configurable:!0}),Oy.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.gf()),t)).merge,this.o_.Pf(t)},Oy.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.gf().host&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Oy.prototype.enableNetwork=function(){return function(r){var t=this;return r.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Jd(r)];case 1:return e=t.sent(),[4,Zd(r)];case 2:return n=t.sent(),[2,(e.da(!0),(t=n).Hc.delete(0),df(t))]}})})})}(Dy(this.o_))},Oy.prototype.disableNetwork=function(){return function(r){var t=this;return r.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Jd(r)];case 1:return e=t.sent(),[4,Zd(r)];case 2:return n=t.sent(),[2,(e.da(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hc.add(0),[4,yf(e)];case 1:return t.sent(),e.Zc.set("Offline"),[2]}})})}(n))]}})})})}(Dy(this.o_))},Oy.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&bp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Cf.enableMultiTabIndexedDbPersistence(this):this.Cf.enableIndexedDbPersistence(this,n)},Oy.prototype.clearPersistence=function(){return this.Cf.clearIndexedDbPersistence(this)},Oy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},Oy.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new $u;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=pl,[4,ty(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Dy(this.o_))},Oy.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Dy(t),e=Wa(e)?e:{next:e},i=new Jl(e);return t.yf.fs(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.$s.add(e),e.next()},[4,ey(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.yf.fs(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.$s.delete(e)},[4,ey(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(Oy.prototype,"app",{get:function(){if(!this.Nf)throw new Hr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nf},enumerable:!1,configurable:!0}),Oy.prototype.collection=function(t){return mp("Firestore.collection","path",t),Dy(this.o_),new ov(Yr.k(t),this,null)},Oy.prototype.doc=function(t){return mp("Firestore.doc","path",t),Dy(this.o_),Vy.xf(Yr.k(t),this,null)},Oy.prototype.collectionGroup=function(t){if(mp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Dy(this.o_),new nv((t=t,new tu(Yr.$(),t)),this,null)},Oy.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new $u;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Xd(n).then(function(t){return t.Wc})];case 1:return e=t.sent(),new Bd(n.rs,e,r,i).run(),[2]}})})}),i.promise}(Dy(this.o_),function(t){return e(new Ly(n,t))})},Oy.prototype.batch=function(){return Dy(this.o_),new Ry(this)},Oy);function Oy(t,e,n){var r=this;return(r=xy.call(this,e)||this).Cf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ir||(r.Nf=t),r}function ky(){}function Dy(t){return t.pf||Py(t),t.pf.lf(),t.pf}function Py(t){var e,n,r=t.k_(),r=(e=t.v_,n=t.df,new Er(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.pf=new Gd(t.Ef,t.yf,r)}var Cy,Ly=(jy.prototype.get=function(t){var e=this,n=hv(0,t,this.S_),r=new td(this.S_);return this.Ff.X_([n.C_]).then(function(t){if(!t||1!==t.length)return Dr();t=t[0];if(t instanceof $s)return new zy(e.S_,new py(e.S_.o_,r,n.C_,null,new Gy(!1,!1),n.x_));if(t instanceof Js)return new zy(e.S_,new py(e.S_.o_,r,n.C_,t,new Gy(!1,!1),n.x_));throw Dr()})},jy.prototype.set=function(t,e,n){t=hv(0,t,this.S_);n=wp("Transaction.set",n);e=fv(t.x_,e,n),n=Sd(this.Of,"Transaction.set",t.C_,e,null!==t.x_,n);return this.Ff.set(t.C_,n),this},jy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=hv(0,t,this.S_);return e instanceof $l&&(e=e.o_),e="string"==typeof e||e instanceof cd?kd(this.Of,"Transaction.update",t.C_,e,n,r):Od(this.Of,"Transaction.update",t.C_,e),this.Ff.update(t.C_,e),this},jy.prototype.delete=function(t){t=hv(0,t,this.S_);return this.Ff.delete(t.C_),this},jy),Ry=(Uy.prototype.set=function(t,e,n){this.$f();t=hv(0,t,this.S_);n=wp("WriteBatch.set",n);e=fv(t.x_,e,n),n=Sd(this.Of,"WriteBatch.set",t.C_,e,null!==t.x_,n);return this.Mf=this.Mf.concat(n.L_(t.C_,bs.Ge())),this},Uy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.$f();t=hv(0,t,this.S_);return e instanceof $l&&(e=e.o_),e="string"==typeof e||e instanceof cd?kd(this.Of,"WriteBatch.update",t.C_,e,n,r):Od(this.Of,"WriteBatch.update",t.C_,e),this.Mf=this.Mf.concat(e.L_(t.C_,bs.exists(!0))),this},Uy.prototype.delete=function(t){this.$f();t=hv(0,t,this.S_);return this.Mf=this.Mf.concat(new Fs(t.C_,bs.Ge())),this},Uy.prototype.commit=function(){return this.$f(),this.kf=!0,0<this.Mf.length?ny(Dy(this.S_.o_),this.Mf):Promise.resolve()},Uy.prototype.$f=function(){if(this.kf)throw new Hr(Kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Uy),Vy=(n(My,Cy=$l),My.xf=function(t,e,n){if(t.length%2!=0)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.M()+" has "+t.length);return new My(e,new hd(e.o_,n,new $r(t)))},My.b_=function(t,e,n){return new My(e,new hd(e.o_,n,t))},Object.defineProperty(My.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(My.prototype,"parent",{get:function(){return new ov(this.o_.O_.S(),this.firestore,this.o_.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(My.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),My.prototype.collection=function(t){if(mp("DocumentReference.collection","path",t),!t)throw new Hr(Kr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=Yr.k(t);return new ov(this.o_.O_.child(t),this.firestore,null)},My.prototype.isEqual=function(t){return t instanceof $l&&(t=t.o_),t instanceof hd&&(((e=this.o_)instanceof hd||e instanceof ld)&&(t instanceof hd||t instanceof ld)&&e.firestore===t.firestore&&e.path===t.path&&e.x_===t.x_);var e},My.prototype.set=function(t,e){e=wp("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=Ep(n.firestore,sy),r=fv(n.x_,r,i),Ty(o,Sd(gd(o),"setDoc",n.C_,r,null!==n.x_,i).L_(n.C_,bs.Ge()))}catch(t){throw Fy(t,"setDoc","DocumentReference.set")}var n,r,i,o},My.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Iy(this.o_,t):Iy.apply(void 0,i([this.o_,t,e],n))}catch(t){throw Fy(t,"updateDoc","DocumentReference.update")}},My.prototype.delete=function(){return Ty(Ep((t=this.o_).firestore,sy),[new Fs(t.C_,bs.Ge())]);var t},My.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i,o=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!Wa(n))return n}return{}}(),n={next:function(t){i.next&&i.next(new zy(e.firestore,new py(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_)))},error:null===(n=(i=Wa((n=r)[0])?n[0]:Wa(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(n=i.complete)||void 0===n?void 0:n.bind(i)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||Wa(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};Wa(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof hd?(s=Ep(e.firestore,sy),u=ou(e.C_.path),h={next:function(t){n[o]&&n[o](Ny(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Ep(e.firestore,sy),u=e.M_,c=new _y(s),h={next:function(t){n[o]&&n[o](new yy(s,c,e,t))},error:n[o+1],complete:n[o+2]},$y(e.M_));var l=Dy(s),p=new Jl(h),d=new Oa(u,p,f);return s.yf.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xa,[4,ey(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.yf.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Aa,[4,ey(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}(this.o_,o,n)},My.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Ep(e.firestore,sy),r=Dy(n),i=new _y(n),o=new $u;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,$d(r)];case 1:return[4,ry(t.sent(),e.C_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new py(n,i,e.C_,t,new Gy(t instanceof Js&&t.Je,!0),e.x_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Ep(e.firestore,sy),r=Dy(n),i=new $u;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ey(r)];case 1:return[4,iy(t.sent(),n.yf,e.C_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Ny(n,e,t)})}:function(e){var t=this,n=Ep(e.firestore,sy),r=Dy(n),i=new $u;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ey(r)];case 1:return[4,iy(t.sent(),n.yf,e.C_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Ny(n,e,t)})})(this.o_).then(function(t){return new zy(e.firestore,new py(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_))})},My.prototype.withConverter=function(t){return new My(this.firestore,this.o_.withConverter(t))},My);function My(t,e){var n=this;return(n=Cy.call(this,e)||this).firestore=t,n.D_=new td(t),n}function Uy(t){this.S_=t,this.Mf=[],this.kf=!1,this.Of=gd(this.S_.o_)}function jy(t,e){this.S_=t,this.Ff=e,this.Of=gd(this.S_.o_)}function Fy(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var qy,By,Gy=(Wy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Wy),zy=(n(Qy,By=$l),Object.defineProperty(Qy.prototype,"ref",{get:function(){return new Vy(this.S_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Qy.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Qy.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Qy.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Qy.prototype.data=function(t){return this.o_.data(t)},Qy.prototype.get=function(t,e){return this.o_.get(t,e)},Qy.prototype.isEqual=function(t){return wy(this.o_,t.o_)},Qy),Ky=(n(Hy,qy=zy),Hy.prototype.data=function(t){return this.o_.data(t)},Hy);function Hy(){return null!==qy&&qy.apply(this,arguments)||this}function Qy(t,e){var n=this;return(n=By.call(this,e)||this).S_=t,n}function Wy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yy(t,e,n){if(n instanceof $l&&(n=n.o_),"string"==typeof n){if(""===n)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!hu(e)&&-1!==n.indexOf("/"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Yr.k(n));if(!$r.G(e))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return mo(t,new $r(e))}if(n instanceof hd)return mo(t,n.C_);throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+_p(n)+".")}function Xy(t,e){if(!Array.isArray(t)||0===t.length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Jy(t,e,n){if(!n.isEqual(e))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function $y(t){if(uu(t)&&0===t.rn.length)throw new Hr(Kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zy,tv,ev,nv=(cv.prototype.where=function(t,e,n){t=Vd("Query.where",t),e=function(t,e,n,r,i,o){if(r.B()){if("array-contains"===i||"array-contains-any"===i)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Xy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Yy(n,t,c))}h={arrayValue:{values:s}}}else h=Yy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Xy(o,i),h=Dd(e,"Query.where",o,"in"===i||"not-in"===i);var h=Eu.create(r,i,h);return function(t,e){if(e.cn()){var n=cu(t);if(null!==n&&!n.isEqual(e.field))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=au(t);null!==n&&Jy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.M_,this.Lf,this.firestore.v_,t,e,n);return new cv((n=this.M_,e=n.filters.concat([e]),new tu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.x_)},cv.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Hr(Kr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Vd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new Xu(e,n);return n=e,null!==au(t)||null!==(t=cu(t))&&Jy(0,t,n.field),e}(this.M_,t,n);return new cv((n=this.M_,t=n.rn.concat([t]),new tu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.x_)},cv.prototype.limit=function(t){return Ip("Query.limit",t),new cv(pu(this.M_,t,"F"),this.firestore,this.x_)},cv.prototype.limitToLast=function(t){return Ip("Query.limitToLast",t),new cv(pu(this.M_,t,"L"),this.firestore,this.x_)},cv.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.startAt",t,e,!0);return new cv(du(this.M_,t),this.firestore,this.x_)},cv.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.startAfter",t,e,!1);return new cv(du(this.M_,t),this.firestore,this.x_)},cv.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.endBefore",t,e,!0);return new cv(yu(this.M_,t),this.firestore,this.x_)},cv.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.endAt",t,e,!1);return new cv(yu(this.M_,t),this.firestore,this.x_)},cv.prototype.isEqual=function(t){return t instanceof cv&&this.firestore===t.firestore&&vu(this.M_,t.M_)&&this.x_===t.x_},cv.prototype.withConverter=function(t){return new cv(this.M_,this.firestore,t)},cv.prototype.Bf=function(c,t,e,n){if(t instanceof zy)return function(t,e,n,r){if(!n)throw new Hr(Kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=fu(t);o<s.length;o++){var u=s[o];if(u.field.B())i.push(mo(e,n.key));else{var a=n.field(u.field);if(oo(a))throw new Hr(Kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.M();throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Bu(i,r)}(this.M_,this.firestore.v_,t.o_.N_,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Hr(Kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.B()){if("string"!=typeof c)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!hu(t)&&-1!==c.indexOf("/"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Yr.k(c));if(!$r.G(h))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new $r(h);u.push(mo(e,h))}else{c=Dd(n,r,c);u.push(c)}}return new Bu(u,o)}(this.M_,this.firestore.v_,this.Lf,c,e,n)},cv.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||Wa(n[s])||(o=n[s],s++),Wa(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new iv(e.firestore,new yy(e.firestore.o_,e.D_,new fd(e.firestore.o_,e.x_,e.M_),t)))},error:n[s+1],complete:n[s+2]};return $y(this.M_),function(n,t,e){var r=this,i=new Jl(u),o=new Oa(t,i,e);return n.rs.fs(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xa,[4,ey(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.rs.fs(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Aa,[4,ey(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Dy(this.firestore.o_),this.M_,o)},cv.prototype.get=function(t){var e=this;$y(this.M_);var n=Dy(this.firestore.o_);return(t&&"cache"===t.source?function(n,r){var t=this,i=new $u;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Yh(r,i,!0)];case 1:return n=t.sent(),e=new Yf(i,n.Xa),n=e.gh(n.documents),n=e.bi(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ia(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,$d(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.M_):function(n,r,i){var t=this;void 0===i&&(i={});var o=new $u;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Jl({next:function(t){n.fs(function(){return Aa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Hr(Kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Oa(t,o,{includeMetadataChanges:!0,Hs:!0});return xa(e,s)},[4,ey(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.rs,r,i,o])]}})})}),o.promise}(n,this.M_,t)).then(function(t){return new iv(e.firestore,new yy(e.firestore.o_,e.D_,new fd(e.firestore.o_,e.x_,e.M_),t))})},cv),rv=(n(av,ev=$l),Object.defineProperty(av.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"doc",{get:function(){return new Ky(this.S_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"newIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),av),iv=(n(uv,tv=$l),Object.defineProperty(uv.prototype,"query",{get:function(){return new nv(this.o_.query.M_,this.S_,this.o_.query.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Ky(e.S_,t)})},enumerable:!1,configurable:!0}),uv.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new rv(e.S_,t)})},uv.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Ky(r.S_,t))})},uv.prototype.isEqual=function(t){return wy(this.o_,t.o_)},uv),ov=(n(sv,Zy=nv),Object.defineProperty(sv.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(sv.prototype,"parent",{get:function(){var t=this.M_.path.S();return t.T()?null:Vy.xf(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(sv.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),sv.prototype.doc=function(t){0===arguments.length&&(t=Cr.u()),mp("CollectionReference.doc","path",t);t=Yr.k(t);return Vy.xf(this.M_.path.child(t),this.firestore,this.x_)},sv.prototype.add=function(t){var t=this.x_?this.x_.toFirestore(t):t,e=this.doc();return Vy.b_(e.o_.C_,this.firestore,null).set(t).then(function(){return e})},sv.prototype.withConverter=function(t){return new sv(this.O_,this.firestore,t)},sv);function sv(t,e,n){var r=this;if(((r=Zy.call(this,ou(t),e,n)||this).O_=t).length%2!=1)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.M()+" has "+t.length);return r}function uv(t,e){var n=this;return(n=tv.call(this,e)||this).S_=t,n}function av(t,e){var n=this;return(n=ev.call(this,e)||this).S_=t,n}function cv(t,e,n){this.M_=t,this.firestore=e,this.x_=n,this.Lf=gd(e.o_),this.D_=new td(e)}function hv(t,e,n){e=Ep(e,hd);if(e.firestore!==n.o_)throw new Hr(Kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function fv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var lv,pv,dv,Ee=(n(gv,pv=$l),gv.documentId=function(){return new gv(Jr.q().M())},gv.prototype.isEqual=function(t){return t instanceof $l&&(t=t.o_),t instanceof cd&&this.o_.F_.isEqual(t.F_)},gv),h=(n(vv,lv=$l),vv.serverTimestamp=function(){var t=new Cp("serverTimestamp");return t.a_="FieldValue.serverTimestamp",new vv(t)},vv.delete=function(){var t=new xp("deleteField");return t.a_="FieldValue.delete",new vv(t)},vv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lp("arrayUnion",t)}.apply(void 0,t);return n.a_="FieldValue.arrayUnion",new vv(n)},vv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rp("arrayRemove",t)}.apply(void 0,t);return n.a_="FieldValue.arrayRemove",new vv(n)},vv.increment=function(t){t=new Vp("increment",t);return t.a_="FieldValue.increment",new vv(t)},vv.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},vv),yv={Firestore:Sy,GeoPoint:Mp,Timestamp:Qr,Blob:Zp,Transaction:Ly,WriteBatch:Ry,DocumentReference:Vy,DocumentSnapshot:zy,Query:nv,QueryDocumentSnapshot:Ky,QuerySnapshot:iv,CollectionReference:ov,FieldPath:Ee,FieldValue:h,setLogLevel:function(t){Tr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function vv(){return null!==lv&&lv.apply(this,arguments)||this}function gv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return pv.call(this,new(cd.bind.apply(cd,i([void 0],t))))||this}(dv=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Sy(e,new sy(e,t),new Ay);var e},"PUBLIC").setServiceProps(Object.assign({},yv))),dv.registerVersion("@firebase/firestore","2.0.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
