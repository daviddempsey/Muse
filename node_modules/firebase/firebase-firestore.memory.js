!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Mp){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Mp),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function v(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function y(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Te=u=u||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},c=u.INFO,h=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=c,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k={},D=O||self;function R(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function S(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),C=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:V).apply(null,arguments)}function j(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++C))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function Y(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function X(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function J(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var K=D.navigator;if(K){K=K.userAgent;if(K){H=K;break t}}H=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=R;var rt,it=J(H,"Opera"),ot=J(H,"Trident")||J(H,"MSIE"),st=J(H,"Edge"),ut=st||ot,at=J(H,"Gecko")&&!(J(H.toLowerCase(),"webkit")&&!J(H,"Edge"))&&!(J(H,"Trident")||J(H,"MSIE"))&&!J(H,"Edge"),ct=J(H.toLowerCase(),"webkit")&&!J(H,"Edge");function ht(){var t=D.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=H,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ct?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ht();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=W(String(rt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var vt=D.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,yt=!ot||9<=Number(vt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",R,e),D.removeEventListener("test",R,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},F(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),It=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),Lt={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[Tt]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Tt]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=xt(t);if(c||(t[Rt]=c=new Ot(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Tt]?kt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(kt(n,t),0==n.b&&(n.src=null,e[Rt]=null)):Nt(t)))}function Ct(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Ut(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new bt(e,this))}function xt(t){return(t=t[Rt])instanceof Ot?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==L(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Ft(){q.call(this),this.c=new Ot(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Gt(o,r,!0,e)&&s;if(s=Gt(o=e.a=t,r,!0,e)&&s,s=Gt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Gt(o=e.a=n[i],r,!1,e)&&s}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&kt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,q),Ft.prototype[Tt]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Mt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=D.JSON.stringify;function zt(){this.b=this.a=null}var Yt,Xt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Wt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Jt(t,e){var n;Yt||(n=D.Promise.resolve(void 0),Yt=function(){n.then($t)}),Qt||(Yt(),Qt=!0),Kt.add(t,e)}zt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new zt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=Xt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function Zt(t,e){Ft.call(this),this.b=t||1,this.a=e||D,this.f=x(this.Xa,this),this.g=M()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==L(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}F(Zt,Ft),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(I(re=ue,ie=ne=q),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){q.call(this),this.b=t,this.a={}}F(ae,q);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function fe(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),le(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var de=null;function ve(){return de=de||new Ft}function ye(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ve();qt(e,new ye(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ve();qt(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}F(ye,wt),F(me,wt),F(be,wt);var Te={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ie={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Ae.prototype.a=null;var ke,O={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function De(){wt.call(this,"d")}function Re(){wt.call(this,"c")}function Le(){}function Se(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(De,wt),F(Re,wt),F(Le,Ae),ke=new Le;var Pe=45e3,_e={},Ce={};function Ue(t,e,n){t.H=1,t.i=nn(Qe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=M(),je(t),t.l=Qe(t.i);var s,u,a,c,h,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(x(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function xe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),qe(t))}function je(t){t.T=M()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(x(t.Ta,t),e)}function Fe(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function Ge(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Xn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(x(u.Qa,u),6e3));if(Tn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!X(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(J(r,"spdy")||J(r,"quic")||J(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),je(o)),n.a=i):Zn(n),0<u.g.length&&Jn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Yn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(S(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(S(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(S(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ye)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Se.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Ge(this),qe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(xe(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Be(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Ge(this),qe(this)}}}catch(t){}var u,a,c,h,l,f},N.Ua=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),xe(this,t,e),this.b&&4!=t&&je(this)))},N.cancel=function(){this.A=!0,Ge(this)},N.Ta=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Ge(this),this.h=2,qe(this)):Me(this,this.T-n)},(N=Ye.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Xe(this),this.a.concat()},N.get=function(t,e){return He(this.b,t)?this.b[t]:e},N.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Qe(t){return new Je(t)}function Ke(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ye,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function vn(t,e){return pn(t),e=gn(t,e),He(t.a.b,e)}function yn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),Y(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,vn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return Y(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function kn(){}function Dn(){this.a=new kn}function Rn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},kn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},kn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Ln=D.JSON.parse;function Sn(t){Ft.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}F(Sn,Ft);var Pn="",_n=/^https?$/i,Cn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),Mn(t)}function xn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function jn(t){if(t.b&&void 0!==k&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))ee(t.za,0,t);else if(qt(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n),e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",xn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Pa=Bn("retryDelaySeedMs",1e4,t),this.Ka=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Dn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Yn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,en(n=Qe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Kn(t,n),(e=new Se(t,t.c,e,void 0)).H=2,e.i=nn(Qe(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),je(e)),ur(t)}function Xn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Hn(t){Xn(t),t.j&&(D.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Jn(t)}function Jn(t){En(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new Se(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ue(n,r,e)}function Kn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;P(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Jt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(x(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Se(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Kn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Qe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,qt(i=ve(),new be(i)),Jn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=Ee(x(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=x(t.Wa,t),r||(r=new Je("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ke(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,D.Image?((i=new Image).onload=j(Rn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=j(Rn,o,i,"TestLoadImage: error",!1,r),i.onabort=j(Rn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=j(Rn,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Hn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,Y(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Je?Qe(s):new Je(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=D.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Je(null,void 0),r&&Ke(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Kn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sn(t.La)).F=t.C,e}function hr(){}function lr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function fr(t,e){Ft.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!X(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!X(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function pr(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Re.call(this),this.status=1}function vr(t){this.a=t}(N=Sn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(ke),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ye(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=G(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==k&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Sn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Sa())},N.Sa=function(){jn(this)},N.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=zn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Se(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Qe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Gn(i,this.i,r),An(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||En(this.b)||Qn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(x(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Xn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Xn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},lr.prototype.a=function(t,e){return new fr(t,e)},F(fr,Ft),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Jn(t)},fr.prototype.close=function(){Yn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.l?((e={}).__data__=Bt(t),Wn(this.a,e)):Wn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,Yn(this.a),delete this.a,fr.X.G.call(this)},F(pr,De),F(dr,Re),F(vr,hr),vr.prototype.ta=function(){qt(this.a,"a")},vr.prototype.sa=function(t){qt(this.a,new pr(t))},vr.prototype.ra=function(t){qt(this.a,new dr)},vr.prototype.qa=function(){qt(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ie.COMPLETE="complete",(Oe.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Sn.prototype.listenOnce=Sn.prototype.wa,Sn.prototype.getLastError=Sn.prototype.Oa,Sn.prototype.getLastErrorCode=Sn.prototype.ua,Sn.prototype.getStatus=Sn.prototype.W,Sn.prototype.getResponseJson=Sn.prototype.Na,Sn.prototype.getResponseText=Sn.prototype.$,Sn.prototype.send=Sn.prototype.ba;var yr=Te,gr=Ie,mr=Oe,wr=Sn,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Tr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ir=(Object.defineProperty(Nr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Nr.prototype.isEqual=function(t){return t instanceof Nr&&t.projectId===this.projectId&&t.database===this.database},Nr),Ar=new l("@firebase/firestore");function Nr(t,e){this.projectId=t,this.database=e||"(default)"}function Or(){return Ar.logLevel}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,i(["Firestore (8.0.2): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,i(["Firestore (8.0.2): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,i(["Firestore (8.0.2): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Sr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.0.2) INTERNAL ASSERTION FAILED: "+t;throw Dr(t),new Error(t)}function Pr(t){t||Sr()}var _r=(Cr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function xr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Fr,qr,Gr,Br=(oi.prototype.get=function(t){var e=this.h(t),e=this._[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.l(o,t))return i}},oi.prototype.has=function(t){return void 0!==this.get(t)},oi.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},oi.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},oi.prototype.forEach=function(s){jr(this._,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},oi.prototype.T=function(){return Mr(this._)},oi),zr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=(n(ii,Gr=Error),ii),Xr=(ri.now=function(){return ri.fromMillis(Date.now())},ri.fromDate=function(t){return ri.fromMillis(t.getTime())},ri.fromMillis=function(t){var e=Math.floor(t/1e3);return new ri(e,1e6*(t-1e3*e))},ri.prototype.toDate=function(){return new Date(this.toMillis())},ri.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ri.prototype.m=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},ri.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ri.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ri.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ri.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ri),Hr=(ni.I=function(t){return new ni(t)},ni.min=function(){return new ni(new Xr(0,0))},ni.prototype.A=function(t){return this.timestamp.m(t.timestamp)},ni.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ni.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ni.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ni.prototype.P=function(){return this.timestamp},ni),Ie=(Object.defineProperty(ei.prototype,"length",{get:function(){return this.V},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return 0===ei.g(this,t)},ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ei?t.forEach(function(t){e.push(t)}):e.push(t),this.p(e)},ei.prototype.limit=function(){return this.offset+this.length},ei.prototype.v=function(t){return t=void 0===t?1:t,this.p(this.segments,this.offset+t,this.length-t)},ei.prototype.C=function(){return this.p(this.segments,this.offset,this.length-1)},ei.prototype.S=function(){return this.segments[this.offset]},ei.prototype.D=function(){return this.get(this.length-1)},ei.prototype.get=function(t){return this.segments[this.offset+t]},ei.prototype.T=function(){return 0===this.length},ei.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ei.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},ei.g=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ei),Wr=(n(ti,qr=Ie),ti.prototype.p=function(t,e,n){return new ti(t,e,n)},ti.prototype.k=function(){return this.O().join("/")},ti.prototype.toString=function(){return this.k()},ti.L=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ti(n)},ti.$=function(){return new ti([])},ti),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Qr=(n(Zr,Fr=Ie),Zr.prototype.p=function(t,e,n){return new Zr(t,e,n)},Zr.M=function(t){return Jr.test(t)},Zr.prototype.k=function(){return this.O().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Zr.M(t)||(t="`"+t+"`"),t}).join(".")},Zr.prototype.toString=function(){return this.k()},Zr.prototype.U=function(){return 1===this.length&&"__name__"===this.get(0)},Zr.q=function(){return new Zr(["__name__"])},Zr.B=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Yr(zr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yr(zr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Yr(zr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Zr(e)},Zr.$=function(){return new Zr([])},Zr),Kr=($r.j=function(t){return new $r(Wr.L(t))},$r.W=function(t){return new $r(Wr.L(t).v(5))},$r.prototype.K=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},$r.prototype.isEqual=function(t){return null!==t&&0===Wr.g(this.path,t.path)},$r.prototype.toString=function(){return this.path.toString()},$r.g=function(t,e){return Wr.g(t.path,e.path)},$r.G=function(t){return t.length%2==0},$r.H=function(t){return new $r(new Wr(t.slice()))},$r);function $r(t){this.path=t}function Zr(){return null!==Fr&&Fr.apply(this,arguments)||this}function ti(){return null!==qr&&qr.apply(this,arguments)||this}function ei(t,e,n){void 0===e?e=0:e>t.length&&Sr(),void 0===n?n=t.length-e:n>t.length-e&&Sr(),this.segments=t,this.offset=e,this.V=n}function ni(t){this.timestamp=t}function ri(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ii(t,e){var n=this;return(n=Gr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function oi(t,e){this.h=t,this.l=e,this._={}}function si(t){return null==t}function ui(t){return 0===t&&1/t==-1/0}var ai=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Y=null};function ci(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ai(t,e,n,r,i,o,s)}function hi(t){var e=t;return null===e.Y&&(t=e.path.k(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.k()+t.op.toString()+lo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.k()+t.dir}).join(","),si(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=qu(e.startAt)),e.endAt&&(t+="|ub:",t+=qu(e.endAt)),e.Y=t),e.Y}function li(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function fi(t){return Kr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var pi=(di.fromBase64String=function(t){return new di(atob(t))},di.fromUint8Array=function(t){return new di(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},di.prototype.toBase64=function(){return t=this.J,btoa(t);var t},di.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.J)},di.prototype.X=function(){return 2*this.J.length},di.prototype.A=function(t){return Ur(this.J,t.J)},di.prototype.isEqual=function(t){return this.J===t.J},di);function di(t){this.J=t}pi.Z=new pi("");function vi(t){this.count=t}var yi,gi=(mi.prototype.et=function(t){return new mi(this.target,this.targetId,this.tt,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},mi.prototype.st=function(t,e){return new mi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},mi.prototype.it=function(t){return new mi(this.target,this.targetId,this.tt,this.sequenceNumber,this.nt,t,this.resumeToken)},mi);function mi(t,e,n,r,i,o,s){void 0===i&&(i=Hr.min()),void 0===o&&(o=Hr.min()),void 0===s&&(s=pi.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function wi(t){switch(t){case zr.OK:return Sr(),0;case zr.CANCELLED:case zr.UNKNOWN:case zr.DEADLINE_EXCEEDED:case zr.RESOURCE_EXHAUSTED:case zr.INTERNAL:case zr.UNAVAILABLE:case zr.UNAUTHENTICATED:return;case zr.INVALID_ARGUMENT:case zr.NOT_FOUND:case zr.ALREADY_EXISTS:case zr.PERMISSION_DENIED:case zr.FAILED_PRECONDITION:case zr.ABORTED:case zr.OUT_OF_RANGE:case zr.UNIMPLEMENTED:case zr.DATA_LOSS:return 1;default:return Sr(),0}}function bi(t){if(void 0===t)return Dr("GRPC error has no .code"),zr.UNKNOWN;switch(t){case yi.OK:return zr.OK;case yi.CANCELLED:return zr.CANCELLED;case yi.UNKNOWN:return zr.UNKNOWN;case yi.DEADLINE_EXCEEDED:return zr.DEADLINE_EXCEEDED;case yi.RESOURCE_EXHAUSTED:return zr.RESOURCE_EXHAUSTED;case yi.INTERNAL:return zr.INTERNAL;case yi.UNAVAILABLE:return zr.UNAVAILABLE;case yi.UNAUTHENTICATED:return zr.UNAUTHENTICATED;case yi.INVALID_ARGUMENT:return zr.INVALID_ARGUMENT;case yi.NOT_FOUND:return zr.NOT_FOUND;case yi.ALREADY_EXISTS:return zr.ALREADY_EXISTS;case yi.PERMISSION_DENIED:return zr.PERMISSION_DENIED;case yi.FAILED_PRECONDITION:return zr.FAILED_PRECONDITION;case yi.ABORTED:return zr.ABORTED;case yi.OUT_OF_RANGE:return zr.OUT_OF_RANGE;case yi.UNIMPLEMENTED:return zr.UNIMPLEMENTED;case yi.DATA_LOSS:return zr.DATA_LOSS;default:return Sr()}}(l=yi=yi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ei=(Oi.prototype.rt=function(t,e){return new Oi(this.g,this.root.rt(t,e,this.g).copy(null,null,Ii.ot,null,null))},Oi.prototype.remove=function(t){return new Oi(this.g,this.root.remove(t,this.g).copy(null,null,Ii.ot,null,null))},Oi.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.g(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Oi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.g(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Oi.prototype.T=function(){return this.root.T()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Oi.prototype.ut=function(){return this.root.ut()},Oi.prototype.ct=function(){return this.root.ct()},Oi.prototype.at=function(t){return this.root.at(t)},Oi.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},Oi.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Oi.prototype.ht=function(t){return this.root.ht(t)},Oi.prototype.lt=function(){return new Ti(this.root,null,this.g,!1)},Oi.prototype._t=function(t){return new Ti(this.root,t,this.g,!1)},Oi.prototype.ft=function(){return new Ti(this.root,null,this.g,!0)},Oi.prototype.dt=function(t){return new Ti(this.root,t,this.g,!0)},Oi),Ti=(Ni.prototype.Tt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Et.push(t),t=t.right;else for(t=t.right;!t.T();)this.Et.push(t),t=t.left;return e},Ni.prototype.It=function(){return 0<this.Et.length},Ni.prototype.At=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Ni),Ii=(Ai.prototype.copy=function(t,e,n,r,i){return new Ai(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ai.prototype.T=function(){return!1},Ai.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Ai.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ai.prototype.min=function(){return this.left.T()?this:this.left.min()},Ai.prototype.ut=function(){return this.min().key},Ai.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},Ai.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Ai.prototype.Pt=function(){if(this.left.T())return Ai.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},Ai.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.T()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.gt()),r.right.T()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.T())return Ai.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Ai.prototype.Vt=function(){return this.color},Ai.prototype.Rt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.Ct()),t},Ai.prototype.yt=function(){var t=this.Ct();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).bt()).Ct()),t},Ai.prototype.vt=function(){var t=this.Ct();return t.left.left.Vt()&&(t=(t=t.gt()).Ct()),t},Ai.prototype.bt=function(){var t=this.copy(null,null,Ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ai.prototype.gt=function(){var t=this.copy(null,null,Ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ai.prototype.Ct=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ai.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},Ai.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw Sr();if(this.right.Vt())throw Sr();var t=this.left.Dt();if(t!==this.right.Dt())throw Sr();return t+(this.Vt()?0:1)},Ai);function Ai(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ai.RED,this.left=null!=r?r:Ai.EMPTY,this.right=null!=i?i:Ai.EMPTY,this.size=this.left.size+1+this.right.size}function Ni(t,e,n,r){this.wt=r,this.Et=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.wt?t.right:t.left}}function Oi(t,e){this.g=t,this.root=e||Ii.EMPTY}function ki(){this.size=0}Ii.EMPTY=null,Ii.RED=!0,Ii.ot=!1,Ii.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.rt=function(t,e,n){return new Ii(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype.T=function(){return!0},ki.prototype.at=function(t){return!1},ki.prototype.ht=function(t){return!1},ki.prototype.ut=function(){return null},ki.prototype.ct=function(){return null},ki.prototype.Vt=function(){return!1},ki.prototype.St=function(){return!0},ki.prototype.Dt=function(){return 0},new ki);var Di=(Pi.prototype.has=function(t){return null!==this.data.get(t)},Pi.prototype.first=function(){return this.data.ut()},Pi.prototype.last=function(){return this.data.ct()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Pi.prototype.indexOf=function(t){return this.data.indexOf(t)},Pi.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},Pi.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Tt();if(0<=this.g(r.key,t[1]))return;e(r.key)}},Pi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Tt().key))return},Pi.prototype.xt=function(t){t=this.data._t(t);return t.It()?t.Tt().key:null},Pi.prototype.lt=function(){return new Ri(this.data.lt())},Pi.prototype._t=function(t){return new Ri(this.data._t(t))},Pi.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},Pi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Pi.prototype.T=function(){return this.data.T()},Pi.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Pi.prototype.isEqual=function(t){if(!(t instanceof Pi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Tt().key,i=n.Tt().key;if(0!==this.g(r,i))return!1}return!0},Pi.prototype.O=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Pi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Pi.prototype.copy=function(t){var e=new Pi(this.g);return e.data=t,e},Pi),Ri=(Si.prototype.Tt=function(){return this.kt.Tt().key},Si.prototype.It=function(){return this.kt.It()},Si),Li=new Ei(Kr.g);function Si(t){this.kt=t}function Pi(t){this.g=t,this.data=new Ei(this.g)}var _i=new Ei(Kr.g);var Ci=new Ei(Kr.g),Ui=new Di(Kr.g);function Vi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ui,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var xi=new Di(Ur);var ji=(to.Mt=function(t){return new to(t.g)},to.prototype.has=function(t){return null!=this.Lt.get(t)},to.prototype.get=function(t){return this.Lt.get(t)},to.prototype.first=function(){return this.$t.ut()},to.prototype.last=function(){return this.$t.ct()},to.prototype.T=function(){return this.$t.T()},to.prototype.indexOf=function(t){t=this.Lt.get(t);return t?this.$t.indexOf(t):-1},Object.defineProperty(to.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),to.prototype.forEach=function(n){this.$t.at(function(t,e){return n(t),!1})},to.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Lt.rt(t.key,t),e.$t.rt(t,null))},to.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Lt.remove(t),this.$t.remove(e)):this},to.prototype.isEqual=function(t){if(!(t instanceof to))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.lt(),n=t.$t.lt();e.It();){var r=e.Tt().key,i=n.Tt().key;if(!r.isEqual(i))return!1}return!0},to.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},to.prototype.copy=function(t,e){var n=new to;return n.g=this.g,n.Lt=t,n.$t=e,n},to),Mi=(Zi.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.rt(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):Sr()},Zi.prototype.qt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},Zi),Fi=($i.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new $i(t,e,ji.Mt(e),i,n,r,!0,!1)},Object.defineProperty($i.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),$i.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&hu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},$i),qi=(Ki.Jt=function(t,e){var n=new Map;return n.set(t,Gi.Xt(t,e)),new Ki(Hr.min(),n,xi,Li,Vi())},Ki),Gi=(Qi.Xt=function(t,e){return new Qi(pi.Z,e,Vi(),Vi(),Vi())},Qi),Bi=function(t,e,n,r){this.sn=t,this.removedTargetIds=e,this.key=n,this.rn=r},zi=function(t,e){this.targetId=t,this.on=e},Yi=function(t,e,n,r){void 0===n&&(n=pi.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Xi=(Object.defineProperty(Ji.prototype,"Zt",{get:function(){return this.hn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"resumeToken",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"_n",{get:function(){return 0!==this.un},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"fn",{get:function(){return this.ln},enumerable:!1,configurable:!0}),Ji.prototype.dn=function(t){0<t.X()&&(this.ln=!0,this.an=t)},Ji.prototype.wn=function(){var n=Vi(),r=Vi(),i=Vi();return this.cn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Sr()}}),new Gi(this.an,this.hn,n,r,i)},Ji.prototype.En=function(){this.ln=!1,this.cn=no()},Ji.prototype.Tn=function(t,e){this.ln=!0,this.cn=this.cn.rt(t,e)},Ji.prototype.mn=function(t){this.ln=!0,this.cn=this.cn.remove(t)},Ji.prototype.In=function(){this.un+=1},Ji.prototype.An=function(){--this.un},Ji.prototype.Rn=function(){this.ln=!0,this.hn=!0},Ji),Hi=(Wi.prototype.vn=function(t){for(var e=0,n=t.sn;e<n.length;e++){var r=n[e];t.rn instanceof Xs?this.bn(r,t.rn):t.rn instanceof Hs&&this.Cn(r,t.key,t.rn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Cn(s,t.key,t.rn)}},Wi.prototype.Sn=function(n){var r=this;this.Dn(n,function(t){var e=r.Nn(t);switch(n.state){case 0:r.Fn(t)&&e.dn(n.resumeToken);break;case 1:e.An(),e._n||e.En(),e.dn(n.resumeToken);break;case 2:e.An(),e._n||r.removeTarget(t);break;case 3:r.Fn(t)&&(e.Rn(),e.dn(n.resumeToken));break;case 4:r.Fn(t)&&(r.xn(t),e.dn(n.resumeToken));break;default:Sr()}})},Wi.prototype.Dn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Vn.forEach(function(t,e){r.Fn(e)&&n(e)})},Wi.prototype.On=function(t){var e=t.targetId,n=t.on.count,t=this.kn(e);t&&(fi(t=t.target)?0===n?(t=new Kr(t.path),this.Cn(e,t,new Hs(t,Hr.min()))):Pr(1===n):this.Ln(e)!==n&&(this.xn(e),this.pn=this.pn.add(e)))},Wi.prototype.$n=function(r){var i=this,o=new Map;this.Vn.forEach(function(t,e){var n=i.kn(e);n&&(t.Zt&&fi(n.target)&&(n=new Kr(n.target.path),null!==i.yn.get(n)||i.Mn(e,n)||i.Cn(e,n,new Hs(n,r))),t.fn&&(o.set(e,t.wn()),t.En()))});var s=Vi();this.gn.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.kn(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new qi(r,o,this.pn,this.yn,s);return this.yn=Li,this.gn=eo(),this.pn=new Di(Ur),t},Wi.prototype.bn=function(t,e){var n;this.Fn(t)&&(n=this.Mn(t,e.key)?2:0,this.Nn(t).Tn(e.key,n),this.yn=this.yn.rt(e.key,e),this.gn=this.gn.rt(e.key,this.Un(e.key).add(t)))},Wi.prototype.Cn=function(t,e,n){var r;this.Fn(t)&&(r=this.Nn(t),this.Mn(t,e)?r.Tn(e,1):r.mn(e),this.gn=this.gn.rt(e,this.Un(e).delete(t)),n&&(this.yn=this.yn.rt(e,n)))},Wi.prototype.removeTarget=function(t){this.Vn.delete(t)},Wi.prototype.Ln=function(t){var e=this.Nn(t).wn();return this.Pn.qn(t).size+e.tn.size-e.en.size},Wi.prototype.In=function(t){this.Nn(t).In()},Wi.prototype.Nn=function(t){var e=this.Vn.get(t);return e||(e=new Xi,this.Vn.set(t,e)),e},Wi.prototype.Un=function(t){var e=this.gn.get(t);return e||(e=new Di(Ur),this.gn=this.gn.rt(t,e)),e},Wi.prototype.Fn=function(t){var e=null!==this.kn(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},Wi.prototype.kn=function(t){var e=this.Vn.get(t);return e&&e._n?null:this.Pn.Bn(t)},Wi.prototype.xn=function(e){var n=this;this.Vn.set(e,new Xi),this.Pn.qn(e).forEach(function(t){n.Cn(e,t,null)})},Wi.prototype.Mn=function(t,e){return this.Pn.qn(t).has(e)},Wi);function Wi(t){this.Pn=t,this.Vn=new Map,this.yn=Li,this.gn=eo(),this.pn=new Di(Ur)}function Ji(){this.un=0,this.cn=no(),this.an=pi.Z,this.hn=!1,this.ln=!0}function Qi(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.tn=n,this.nn=r,this.en=i}function Ki(t,e,n,r,i){this.nt=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}function $i(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function Zi(){this.Ut=new Ei(Kr.g)}function to(n){this.g=n?function(t,e){return n(t,e)||Kr.g(t.key,e.key)}:function(t,e){return Kr.g(t.key,e.key)},this.Lt=_i,this.$t=new Ei(this.g)}function eo(){return new Ei(Kr.g)}function no(){return new Ei(Kr.g)}function ro(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function io(t){t=fo(t.mapValue.fields.__local_write_time__.timestampValue);return new Xr(t.seconds,t.nanos)}var oo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function so(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ro(t)?4:10:Sr()}function uo(r,i){var t,e=so(r);if(e!==so(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return io(r).isEqual(io(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=fo(r.timestampValue),t=fo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,vo(r.bytesValue).isEqual(vo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,po((t=r).geoPointValue.latitude)===po(e.geoPointValue.latitude)&&po(t.geoPointValue.longitude)===po(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return po(t.integerValue)===po(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=po(t.doubleValue),e=po(e.doubleValue);return t===e?ui(t)===ui(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(xr(e)!==xr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!uo(e[t],n[t])))return!1;return!0}();default:return Sr()}}function ao(t,e){return void 0!==(t.values||[]).find(function(t){return uo(t,e)})}function co(t,e){var n,r,i=so(t),o=so(e);if(i!==o)return Ur(i,o);switch(i){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return n=e,r=po(t.integerValue||t.doubleValue),n=po(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return ho(t.timestampValue,e.timestampValue);case 4:return ho(io(t),io(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return function(t,e){t=vo(t),e=vo(e);return t.A(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Ur(po(i.latitude),po(r.latitude)))?n:Ur(po(i.longitude),po(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=co(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;u=co(n[r[s]],i[o[s]]);if(0!==u)return u}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Sr()}}function ho(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=fo(t),t=fo(e),e=Ur(n.seconds,t.seconds);return 0!==e?e:Ur(n.nanos,t.nanos)}function lo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=fo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?vo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Kr.W(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Sr();var e}(t)}function fo(t){if(Pr(!!t),"string"!=typeof t)return{seconds:po(t.seconds),nanos:po(t.nanos)};var e=0,n=oo.exec(t);Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function po(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vo(t){return"string"==typeof t?pi.fromBase64String(t):pi.fromUint8Array(t)}function yo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.k()}}function go(t){return t&&"integerValue"in t}function mo(t){return!!t&&"arrayValue"in t}function wo(t){return t&&"nullValue"in t}function bo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Eo(t){return t&&"mapValue"in t}var To={asc:"ASCENDING",desc:"DESCENDING"},Io={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ao=function(t,e){this.t=t,this.Qn=e};function No(t){return{integerValue:""+t}}function Oo(t,e){if(t.Qn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function ko(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?No(e):Oo(t,e);var n}function Do(t,e){return t.Qn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ro(t,e){return t.Qn?e.toBase64():e.toUint8Array()}function Lo(t){return Pr(!!t),Hr.I((t=fo(t),new Xr(t.seconds,t.nanos)))}function So(t,e){return new Wr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).k()}function Po(t){t=Wr.L(t);return Pr(Ho(t)),t}function _o(t,e){return So(t.t,e.path)}function Co(t,e){e=Po(e);if(e.get(1)!==t.t.projectId)throw new Yr(zr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Yr(zr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new Kr(xo(e))}function Uo(t,e){return So(t.t,e)}function Vo(t){return new Wr(["projects",t.t.projectId,"databases",t.t.database]).k()}function xo(t){return Pr(4<t.length&&"documents"===t.get(4)),t.v(5)}function jo(t,e,n){return{name:_o(t,e),fields:n.proto.mapValue.fields}}function Mo(t,e){var n,r,i;if(e instanceof As)n={update:jo(t,e.key,e.value)};else if(e instanceof Us)n={delete:_o(t,e.key)};else if(e instanceof Ns)n={update:jo(t,e.key,e.data),updateMask:(i=e.jn,r=[],i.fields.forEach(function(t){return r.push(t.k())}),{fieldPaths:r})};else if(e instanceof Ls)n={transform:{document:_o(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ko)return{fieldPath:t.field.k(),setToServerValue:"REQUEST_TIME"};if(e instanceof $o)return{fieldPath:t.field.k(),appendMissingElements:{values:e.elements}};if(e instanceof rs)return{fieldPath:t.field.k(),removeAllFromArray:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.k(),increment:e.Wn};throw Sr()})}};else{if(!(e instanceof Vs))return Sr();n={verify:_o(t,e.key)}}return e.Gn.Kn||(n.currentDocument=void 0!==(i=e.Gn).updateTime?{updateTime:(e=t,t=i.updateTime,Do(e,t.P()))}:void 0!==i.exists?{exists:i.exists}:Sr()),n}function Fo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Uo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Uo(t,r.C()),n.structuredQuery.from=[{collectionId:r.D()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(bo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NAN"}};if(wo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(bo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NAN"}};if(wo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(t.field),op:(e=t.op,Io[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:zo((t=t).field),direction:(t=t.dir,To[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Qn||si(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Go(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Go(e.endAt)),n}function qo(t){var e=4===(o=Po(t.parent)).length?Wr.$():xo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[Xo(t)]:void 0!==t.fieldFilter?[(n=t,yu.create(Yo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Sr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Sr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new zu(Yo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=si(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Bo(n.startAt));var u=null;return n.endAt&&(u=Bo(n.endAt)),new Js(e,i,t,o,r,"F",s,u)}function Go(t){return{before:t.before,values:t.position}}function Bo(t){var e=!!t.before,t=t.values||[];return new Vu(t,e)}function zo(t){return{fieldPath:t.k()}}function Yo(t){return Qr.B(t.fieldPath)}function Xo(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Yo(t.unaryFilter.field);return yu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Yo(t.unaryFilter.field);return yu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=Yo(t.unaryFilter.field);return yu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=Yo(t.unaryFilter.field);return yu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Sr()}}function Ho(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}Ie=function(){this.zn=void 0};function Wo(t,e){return t instanceof us?go(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Jo,Qo,Ko=(n(ts,Qo=Ie),ts),$o=(n(Zo,Jo=Ie),Zo);function Zo(t){var e=this;return(e=Jo.call(this)||this).elements=t,e}function ts(){return null!==Qo&&Qo.apply(this,arguments)||this}function es(t,e){for(var n=hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ns,rs=(n(is,ns=Ie),is);function is(t){var e=this;return(e=ns.call(this)||this).elements=t,e}function os(t,e){for(var n=hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ss,us=(n(as,ss=Ie),as);function as(t,e){var n=this;return(n=ss.call(this)||this).serializer=t,n.Wn=e,n}function cs(t){return po(t.integerValue||t.doubleValue)}function hs(t){return mo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ls(t,e){this.field=t,this.transform=e}var fs=(ps.prototype.Hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},ps.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ps);function ps(t){(this.fields=t).sort(Qr.g)}function ds(t,e){this.version=t,this.transformResults=e}var vs=(ys.Yn=function(){return new ys},ys.exists=function(t){return new ys(void 0,t)},ys.updateTime=function(t){return new ys(t)},Object.defineProperty(ys.prototype,"Kn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ys.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ys);function ys(t,e){this.updateTime=t,this.exists=e}function gs(t,e){return void 0!==t.updateTime?e instanceof Xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xs}l=function(){};function ms(t,e,n){return t instanceof As?new Xs(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ns?function(t,e,n){if(!gs(t.Gn,e))return new Ws(t.key,n.version);e=Ds(t,e);return new Xs(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ls?function(t,e,n){if(Pr(null!=n.transformResults),!gs(t.Gn,e))return new Ws(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Xs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof $o?es(o,s):o instanceof rs?os(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ps(t,r.data(),e);return new Xs(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new Hs(t.key,n.version,{hasCommittedMutations:!0})}function ws(t,e,n,r){return t instanceof As?function(t,e){if(!gs(t.Gn,e))return e;e=Es(e);return new Xs(t.key,e,t.value,{Jn:!0})}(t,e):t instanceof Ns?function(t,e){if(!gs(t.Gn,e))return e;var n=Es(e),e=Ds(t,e);return new Xs(t.key,n,e,{Jn:!0})}(t,e):t instanceof Ls?function(t,e,n,r){if(!gs(t.Gn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Xs&&(h=n.field(a.field)),null===h&&r instanceof Xs&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ko?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof $o?es(c,i):c instanceof rs?os(c,i):(c=Wo(h=c,i),i=cs(c)+cs(h.Wn),go(c)&&go(h.Wn)?No(i):Oo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ps(t,i.data(),r);return new Xs(t.key,i.version,r,{Jn:!0})}(t,e,r,n):(e=e,gs((t=t).Gn,e)?new Hs(t.key,Hr.min()):e)}function bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gn.isEqual(e.Gn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.jn.isEqual(e.jn):2!==t.type||Vr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof $o&&e instanceof $o||t instanceof rs&&e instanceof rs?Vr(t.elements,e.elements,uo):t instanceof us&&e instanceof us?uo(t.Wn,e.Wn):t instanceof Ko&&e instanceof Ko)}))}function Es(t){return t instanceof Xs?t.version:Hr.min()}var Ts,Is,As=(n(ks,Is=l),ks),Ns=(n(Os,Ts=l),Os);function Os(t,e,n,r){var i=this;return(i=Ts.call(this)||this).key=t,i.data=e,i.jn=n,i.Gn=r,i.type=1,i}function ks(t,e,n){var r=this;return(r=Is.call(this)||this).key=t,r.value=e,r.Gn=n,r.type=0,r}function Ds(t,e){return n=t,e=e instanceof Xs?e.data():xs.empty(),r=new js(e),n.jn.fields.forEach(function(t){var e;t.T()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xn();var n,r}var Rs,Ls=(n(Ss,Rs=l),Ss);function Ss(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Gn=vs.exists(!0),n}function Ps(t,e,n){for(var r=new js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xn()}var _s,Cs,Us=(n(Gs,Cs=l),Gs),Vs=(n(qs,_s=l),qs),xs=(Fs.empty=function(){return new Fs({mapValue:{}})},Fs.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Eo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.D()])||null},Fs.prototype.isEqual=function(t){return uo(this.proto,t.proto)},Fs),js=(Ms.prototype.set=function(t,e){return this.ne(t,e),this},Ms.prototype.delete=function(t){return this.ne(t,null),this},Ms.prototype.ne=function(t,e){for(var n=this.te,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===so(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.D(),e)},Ms.prototype.Xn=function(){var t=this.ee(Qr.$(),this.te);return null!=t?new xs(t):this.Zn},Ms.prototype.ee=function(r,t){var i=this,o=!1,e=this.Zn.field(r),s=Eo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.ee(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ms);function Ms(t){void 0===t&&(t=xs.empty()),this.Zn=t,this.te=new Map}function Fs(t){this.proto=t}function qs(t,e){var n=this;return(n=_s.call(this)||this).key=t,n.Gn=e,n.type=4,n}function Gs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.Gn=e,n.type=3,n}var Bs,zs,Ys,Ie=function(t,e){this.key=t,this.version=e},Xs=(n($s,Ys=Ie),$s.prototype.field=function(t){return this.se.field(t)},$s.prototype.data=function(){return this.se},$s.prototype.ie=function(){return this.se.proto},$s.prototype.isEqual=function(t){return t instanceof $s&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jn===t.Jn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.se.isEqual(t.se)},$s.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.se.toString()+", {hasLocalMutations: "+this.Jn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return this.Jn||this.hasCommittedMutations},enumerable:!1,configurable:!0}),$s),Hs=(n(Ks,zs=Ie),Ks.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ks.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ks.prototype.isEqual=function(t){return t instanceof Ks&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ks),Ws=(n(Qs,Bs=Ie),Qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs),Js=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.re=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.oe=null,this.ue=null,this.startAt,this.endAt};function Qs(){return null!==Bs&&Bs.apply(this,arguments)||this}function Ks(t,e,n){var r=this;return(r=zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function $s(t,e,n,r){var i=this;return(i=Ys.call(this,t,e)||this).se=n,i.Jn=!!r.Jn,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Zs(t){return new Js(t)}function tu(t){return!si(t.limit)&&"F"===t.limitType}function eu(t){return!si(t.limit)&&"L"===t.limitType}function nu(t){return 0<t.re.length?t.re[0].field:null}function ru(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ce())return r.field}return null}function iu(t){return null!==t.collectionGroup}function ou(t){var e=t;if(null===e.oe){e.oe=[];var n=ru(e),t=nu(e);if(null!==n&&null===t)n.U()||e.oe.push(new zu(n)),e.oe.push(new zu(Qr.q(),"asc"));else{for(var r=!1,i=0,o=e.re;i<o.length;i++){var s=o[i];e.oe.push(s),s.field.U()&&(r=!0)}r||(n=0<e.re.length?e.re[e.re.length-1].dir:"asc",e.oe.push(new zu(Qr.q(),n)))}}return e.oe}function su(t){var e=t;if(!e.ue)if("F"===e.limitType)e.ue=ci(e.path,e.collectionGroup,ou(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ou(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zu(o.field,s))}var u=e.endAt?new Vu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Vu(e.startAt.position,!e.startAt.before):null;e.ue=ci(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.ue}function uu(t,e,n){return new Js(t.path,t.collectionGroup,t.re.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function au(t,e){return new Js(t.path,t.collectionGroup,t.re.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function cu(t,e){return new Js(t.path,t.collectionGroup,t.re.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function hu(t,e){return li(su(t),su(e))&&t.limitType===e.limitType}function lu(t){return hi(su(t))+"|lt:"+t.limitType}function fu(t){return"Query(target="+(e=su(t),n=e.path.k(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.k()+" "+t.op+" "+lo(t.value)}).join(", ")+"]"),si(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.k()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+qu(e.startAt)),e.endAt&&(n+=", endAt: "+qu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function pu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.K(e.collectionGroup)&&e.path.N(n):Kr.G(e.path)?e.path.isEqual(n):e.path.F(n))&&function(t){for(var e=0,n=i.re;e<n.length;e++){var r=n[e];if(!r.field.U()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Gu(t.startAt,ou(t),n))&&(!t.endAt||!Gu(t.endAt,ou(t),n)));var e,n}function du(u){return function(t,e){for(var n=!1,r=0,i=ou(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.U()?Kr.g(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?co(n,t):Sr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Sr()}}(o,t,e);if(0!==s)return s;n=n||o.field.U()}return 0}}var vu,yu=(n(gu,vu=function(){}),gu.create=function(t,e,n){return t.U()?"in"===e||"not-in"===e?this.ae(t,e,n):new Eu(t,e,n):"array-contains"===e?new Pu(t,n):"in"===e?new _u(t,n):"not-in"===e?new Cu(t,n):"array-contains-any"===e?new Uu(t,n):new gu(t,e,n)},gu.ae=function(t,e,n){return new("in"===e?Tu:Iu)(t,n)},gu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.he(co(t,this.value)):null!==t&&so(this.value)===so(t)&&this.he(co(t,this.value))},gu.prototype.he=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Sr()}},gu.prototype.ce=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},gu);function gu(t,e,n){var r=this;return(r=vu.call(this)||this).field=t,r.op=e,r.value=n,r}var mu,wu,bu,Eu=(n(Ou,bu=yu),Ou.prototype.matches=function(t){t=Kr.g(t.key,this.key);return this.he(t)},Ou),Tu=(n(Nu,wu=yu),Nu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Nu),Iu=(n(Au,mu=yu),Au.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Au);function Au(t,e){var n=this;return(n=mu.call(this,t,"not-in",e)||this).keys=ku(0,e),n}function Nu(t,e){var n=this;return(n=wu.call(this,t,"in",e)||this).keys=ku(0,e),n}function Ou(t,e,n){var r=this;return(r=bu.call(this,t,e,n)||this).key=Kr.W(n.referenceValue),r}function ku(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Kr.W(t.referenceValue)})}var Du,Ru,Lu,Su,Pu=(n(Fu,Su=yu),Fu.prototype.matches=function(t){t=t.field(this.field);return mo(t)&&ao(t.arrayValue,this.value)},Fu),_u=(n(Mu,Lu=yu),Mu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ao(this.value.arrayValue,t)},Mu),Cu=(n(ju,Ru=yu),ju.prototype.matches=function(t){if(ao(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ao(this.value.arrayValue,t)},ju),Uu=(n(xu,Du=yu),xu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!mo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ao(e.value.arrayValue,t)})},xu),Vu=function(t,e){this.position=t,this.before=e};function xu(t,e){return Du.call(this,t,"array-contains-any",e)||this}function ju(t,e){return Ru.call(this,t,"not-in",e)||this}function Mu(t,e){return Lu.call(this,t,"in",e)||this}function Fu(t,e){return Su.call(this,t,"array-contains",e)||this}function qu(t){return(t.before?"b":"a")+":"+t.position.map(lo).join(",")}function Gu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.U()?Kr.g(Kr.W(s.referenceValue),n.key):co(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!uo(t.position[n],e.position[n]))return!1;return!0}var zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Yu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Xu=(Ju.prototype.reset=function(){this.Ee=0},Ju.prototype.Ie=function(){this.Ee=this.we},Ju.prototype.Ae=function(t){var e=this;this.cancel();var n=Math.floor(this.Ee+this.Re()),r=Math.max(0,Date.now()-this.me),i=Math.max(0,n-r);0<i&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ee+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Te=this.le.Pe(this._e,i,function(){return e.me=Date.now(),t()}),this.Ee*=this.de,this.Ee<this.fe&&(this.Ee=this.fe),this.Ee>this.we&&(this.Ee=this.we)},Ju.prototype.Ve=function(){null!==this.Te&&(this.Te.ye(),this.Te=null)},Ju.prototype.cancel=function(){null!==this.Te&&(this.Te.cancel(),this.Te=null)},Ju.prototype.Re=function(){return(Math.random()-.5)*this.Ee},Ju),Hu=(Wu.prototype.catch=function(t){return this.next(void 0,t)},Wu.prototype.next=function(r,i){var o=this;return this.be&&Sr(),this.be=!0,this.ve?this.error?this.Ce(i,this.error):this.Se(r,this.result):new Wu(function(e,n){o.ge=function(t){o.Se(r,t).next(e,n)},o.pe=function(t){o.Ce(i,t).next(e,n)}})},Wu.prototype.De=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Wu.prototype.Ne=function(t){try{var e=t();return e instanceof Wu?e:Wu.resolve(e)}catch(t){return Wu.reject(t)}},Wu.prototype.Se=function(t,e){return t?this.Ne(function(){return t(e)}):Wu.resolve(e)},Wu.prototype.Ce=function(t,e){return t?this.Ne(function(){return t(e)}):Wu.reject(e)},Wu.resolve=function(n){return new Wu(function(t,e){t(n)})},Wu.reject=function(n){return new Wu(function(t,e){e(n)})},Wu.Fe=function(t){return new Wu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Wu.xe=function(t){for(var n=Wu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Wu.resolve(t):e()})}(r[e]);return n},Wu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Fe(i)},Wu);function Wu(t){var e=this;this.ge=null,this.pe=null,this.result=void 0,this.error=void 0,this.ve=!1,this.be=!1,t(function(t){e.ve=!0,e.result=t,e.ge&&e.ge(t)},function(t){e.ve=!0,e.error=t,e.pe&&e.pe(t)})}function Ju(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.le=t,this._e=e,this.fe=n,this.de=r,this.we=i,this.Ee=0,this.Te=null,this.me=Date.now(),this.reset()}function Qu(t){return"IndexedDbTransactionError"===t.name}function Ku(){return"undefined"!=typeof document?document:null}var $u=(ea.Me=function(t,e,n,r,i){i=new ea(t,e,Date.now()+n,r,i);return i.start(n),i},ea.prototype.start=function(t){var e=this;this.Ue=setTimeout(function(){return e.qe()},t)},ea.prototype.ye=function(){return this.qe()},ea.prototype.cancel=function(t){null!==this.Ue&&(this.clearTimeout(),this.$e.reject(new Yr(zr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ea.prototype.qe=function(){var e=this;this.Oe.Be(function(){return null!==e.Ue?(e.clearTimeout(),e.op().then(function(t){return e.$e.resolve(t)})):Promise.resolve()})},ea.prototype.clearTimeout=function(){null!==this.Ue&&(this.Le(this),clearTimeout(this.Ue),this.Ue=null)},ea),Zu=(Object.defineProperty(ta.prototype,"Xe",{get:function(){return this.We},enumerable:!1,configurable:!0}),ta.prototype.Be=function(t){this.enqueue(t)},ta.prototype.Ze=function(t){this.ts(),this.ns(t)},ta.prototype.es=function(){var t;this.We||(this.We=!0,(t=Ku())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Je))},ta.prototype.enqueue=function(t){return this.ts(),this.We?new Promise(function(t){}):this.ns(t)},ta.prototype.ss=function(t){var e=this;this.Be(function(){return e.je.push(t),e.rs()})},ta.prototype.rs=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.je.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.je[0]()];case 2:return t.sent(),this.je.shift(),this.Ye.reset(),[3,4];case 3:if(!Qu(e=t.sent()))throw e;return kr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.je.length&&this.Ye.Ae(function(){return n.rs()}),t.label=5;case 5:return[2]}})})},ta.prototype.ns=function(t){var r=this,e=this.Qe.then(function(){return r.ze=!0,t().catch(function(t){throw r.Ge=t,r.ze=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.ze=!1,t})});return this.Qe=e},ta.prototype.Pe=function(t,e,n){var r=this;this.ts(),-1<this.He.indexOf(t)&&(e=0);n=$u.Me(this,t,e,n,function(t){return r.os(t)});return this.Ke.push(n),n},ta.prototype.ts=function(){this.Ge&&Sr()},ta.prototype.us=function(){},ta.prototype.cs=function(){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Qe];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qe)return[3,0];t.label=3;case 3:return[2]}})})},ta.prototype.hs=function(t){for(var e=0,n=this.Ke;e<n.length;e++)if(n[e]._e===t)return!0;return!1},ta.prototype.ls=function(r){var i=this;return this.cs().then(function(){i.Ke.sort(function(t,e){return t.ke-e.ke});for(var t=0,e=i.Ke;t<e.length;t++){var n=e[t];if(n.ye(),"all"!==r&&n._e===r)break}return i.cs()})},ta.prototype._s=function(t){this.He.push(t)},ta.prototype.os=function(t){t=this.Ke.indexOf(t);this.Ke.splice(t,1)},ta);function ta(){var e=this;this.Qe=Promise.resolve(),this.je=[],this.We=!1,this.Ke=[],this.Ge=null,this.ze=!1,this.He=[],this.Ye=new Xu(this,"async_queue_retry"),this.Je=function(){var t=Ku();t&&kr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ye.Ve()};var t=Ku();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Je)}function ea(t,e,n,r,i){this.Oe=t,this._e=e,this.ke=n,this.op=r,this.Le=i,this.$e=new Yu,this.then=this.$e.promise.then.bind(this.$e.promise),this.$e.promise.catch(function(t){})}function na(t,e){if(Dr("AsyncQueue",e+": "+t),Qu(t))return new Yr(zr.UNAVAILABLE,e+": "+t);throw t}function ra(){this.queries=new Br(lu,hu),this.onlineState="Unknown",this.ds=new Set}var ia=function(){this.fs=void 0,this.listeners=[]};function oa(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ia),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ws(n)];case 2:return o.fs=t.sent(),[3,4];case 3:return o=t.sent(),o=na(o,"Initialization of query '"+fu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Es(e.onlineState),i.fs&&u.Ts(i.fs)&&ua(e),[2]}})})}function sa(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Is(n))]:[2]})})}function ua(t){t.ds.forEach(function(t){t.next()})}var aa=(la.prototype.Ts=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Fi(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Rs?this.Vs(t)&&(this.As.next(t),o=!0):this.ys(t,this.onlineState)&&(this.gs(t),o=!0),this.Ps=t,o},la.prototype.onError=function(t){this.As.error(t)},la.prototype.Es=function(t){this.onlineState=t;var e=!1;return this.Ps&&!this.Rs&&this.ys(this.Ps,t)&&(this.gs(this.Ps),e=!0),e},la.prototype.ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.ps&&n||t.docs.T()&&"Offline"!==e)},la.prototype.Vs=function(t){if(0<t.docChanges.length)return!0;var e=this.Ps&&this.Ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},la.prototype.gs=function(t){t=Fi.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Rs=!0,this.As.next(t)},la),ca=(ha.prototype.vs=function(){return null!=this.uid},ha.prototype.bs=function(){return this.vs()?"uid:"+this.uid:"anonymous-user"},ha.prototype.isEqual=function(t){return t.uid===this.uid},ha);function ha(t){this.uid=t}function la(t,e,n){this.query=t,this.As=e,this.Rs=!1,this.Ps=null,this.onlineState="Unknown",this.options=n||{}}ca.UNAUTHENTICATED=new ca(null),ca.Cs=new ca("google-credentials-uid"),ca.Ss=new ca("first-party-uid");function fa(t,e){this.user=e,this.type="OAuth",this.Ds={},this.Ds.Authorization="Bearer "+t}var pa=(Aa.prototype.getToken=function(){return Promise.resolve(null)},Aa.prototype.Fs=function(){},Aa.prototype.xs=function(t){(this.Ns=t)(ca.UNAUTHENTICATED)},Aa.prototype.Os=function(){this.Ns=null},Aa),da=(Ia.prototype.getToken=function(){var e=this,n=this.$s,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.$s!==n?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new fa(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ia.prototype.Fs=function(){this.forceRefresh=!0},Ia.prototype.xs=function(t){this.Ns=t,this.Ls&&t(this.currentUser)},Ia.prototype.Os=function(){this.auth&&this.auth.removeAuthTokenListener(this.ks),this.ks=null,this.Ns=null},Ia.prototype.Ms=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new ca(t)},Ia),va=(Object.defineProperty(Ta.prototype,"Ds",{get:function(){var t={"X-Goog-AuthUser":this.qs},e=this.Us.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ta),ya=(Ea.prototype.getToken=function(){return Promise.resolve(new va(this.Us,this.qs))},Ea.prototype.xs=function(t){t(ca.Ss)},Ea.prototype.Os=function(){},Ea.prototype.Fs=function(){},Ea),ga=(ba.prototype.Qs=function(t,e,n){for(var r=n.js,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ms(o,e,r[i]))}return e},ba.prototype.Ws=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ws(i,e,e,this.Bs))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ws(a,e,o,this.Bs))}return e},ba.prototype.Ks=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Ws(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Vi())},ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,bs)&&Vr(this.baseMutations,t.baseMutations,bs)},ba),ma=(wa.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=Ci,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new wa(t,e,n,r)},wa);function wa(t,e,n,r){this.batch=t,this.Gs=e,this.js=n,this.zs=r}function ba(t,e,n,r){this.batchId=t,this.Bs=e,this.baseMutations=n,this.mutations=r}function Ea(t,e){this.Us=t,this.qs=e}function Ta(t,e){this.Us=t,this.qs=e,this.type="FirstParty",this.user=ca.Ss}function Ia(t){var e=this;this.ks=null,this.currentUser=ca.UNAUTHENTICATED,this.Ls=!1,this.$s=0,this.Ns=null,this.forceRefresh=!1,this.ks=function(){e.$s++,e.currentUser=e.Ms(),e.Ls=!0,e.Ns&&e.Ns(e.currentUser)},this.$s=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ks):(this.ks(null),t.get().then(function(t){e.auth=t,e.ks&&e.auth.addAuthTokenListener(e.ks)},function(){}))}function Aa(){this.Ns=null}function Na(t){return new Ao(t,!0)}function Oa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ka=(Pa.prototype.Xs=function(e,n){var r=this;return this.Ys.Zs(e,n).next(function(t){return r.ti(e,n,t)})},Pa.prototype.ti=function(t,r,i){return this.Hs.ni(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Ws(r,t);return t})},Pa.prototype.ei=function(t,e,i){var o=Li;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Ws(t,e);o=o.rt(t,e)}),o},Pa.prototype.si=function(e,t){var n=this;return this.Hs.getEntries(e,t).next(function(t){return n.ii(e,t)})},Pa.prototype.ii=function(e,r){var i=this;return this.Ys.ri(e,r).next(function(t){var t=i.ei(e,r,t),n=Li;return t.forEach(function(t,e){e=e||new Hs(t,Hr.min()),n=n.rt(t,e)}),n})},Pa.prototype.oi=function(t,e,n){return r=e,Kr.G(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ui(t,e.path):iu(e)?this.ci(t,e,n):this.ai(t,e,n);var r},Pa.prototype.ui=function(t,e){return this.Xs(t,new Kr(e)).next(function(t){var e=_i;return t instanceof Xs&&(e=e.rt(t.key,t)),e})},Pa.prototype.ci=function(n,r,i){var o=this,s=r.collectionGroup,u=_i;return this.Js.hi(n,s).next(function(t){return Hu.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Js(t,null,e.re.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ai(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Pa.prototype.ai=function(e,n,t){var c,h,r=this;return this.Hs.oi(e,n,t).next(function(t){return c=t,r.Ys.li(e,n)}).next(function(t){return h=t,r._i(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=ws(s,a,a,r.Bs);c=a instanceof Xs?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){pu(n,e)||(c=c.remove(t))}),c})},Pa.prototype._i=function(t,e,n){for(var r=Vi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ns&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Hs.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xs&&(c=c.rt(t,e))}),c})},Pa),Da=(Sa.wi=function(t,e){for(var n=Vi(),r=Vi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Sa(t,e.fromCache,n,r)},Sa),Ra=(La.prototype.Ti=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},La.prototype.next=function(){var t=++this.previousValue;return this.mi&&this.mi(t),t},La);function La(t,e){var n=this;this.previousValue=t,e&&(e.Ei=function(t){return n.Ti(t)},this.mi=function(t){return e.Ii(t)})}function Sa(t,e,n,r){this.targetId=t,this.fromCache=e,this.fi=n,this.di=r}function Pa(t,e,n){this.Hs=t,this.Ys=e,this.Js=n}Ra.Ai=-1;function _a(t){this.Ri=t}var Ca=(qa.prototype.Vi=function(t,e){return this.Pi.add(e),Hu.resolve()},qa.prototype.hi=function(t,e){return Hu.resolve(this.Pi.getEntries(e))},qa),Ua=(Fa.prototype.add=function(t){var e=t.D(),n=t.C(),r=this.index[e]||new Di(Wr.g),t=!r.has(n);return this.index[e]=r.add(n),t},Fa.prototype.has=function(t){var e=t.D(),t=t.C(),e=this.index[e];return e&&e.has(t)},Fa.prototype.getEntries=function(t){return(this.index[t]||new Di(Wr.g)).O()},Fa),Va=(Ma.prototype.next=function(){return this.yi+=2,this.yi},Ma.gi=function(){return new Ma(0)},Ma.pi=function(){return new Ma(-1)},Ma),xa=(ja.prototype.qi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bi(t,n.bi)})},ja);function ja(t,e,n,r){this.persistence=t,this.vi=e,this.serializer=r,this.bi=new Ei(Ur),this.Ci=new Br(hi,li),this.Si=Hr.min(),this.Ys=t.Di(n),this.Ni=t.Fi(),this.xi=t.Oi(),this.ki=new ka(this.Ni,this.Ys,this.persistence.Li()),this.$i=t.Mi(),this.vi.Ui(this.ki)}function Ma(t){this.yi=t}function Fa(){this.index={}}function qa(){this.Pi=new Ua}function Ga(i,o){return v(this,void 0,void 0,function(){var e,n,m,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).Ys,m=e.ki,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.Ys.Qi(y).next(function(t){return g=t,n=e.persistence.Di(o),m=new ka(e.Ni,n,e.persistence.Li()),n.Qi(y)}).next(function(t){for(var e=[],n=[],r=Vi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.si(y,r).next(function(t){return{ji:t,Wi:e,Ki:n}})})})];case 1:return r=t.sent(),[2,(e.Ys=n,e.ki=m,e.vi.Ui(e.ki),r)]}})})}function Ba(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=l.Ni.Gi({zi:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),u=Hu.resolve(),n.forEach(function(n){u=u.next(function(){return o.ni(r,n)}).next(function(t){var e=t,t=i.zs.get(n);Pr(null!==t),(!e||e.version.A(t)<0)&&(e=s.Qs(n,e,i))&&o.Hi(e,i.Gs)})}),u.next(function(){return e.Ys.Yi(r,s)}).next(function(){return c.apply(t)}).next(function(){return l.Ys.Ji(t)}).next(function(){return l.ki.si(t,a)})})}function za(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.xi.Xi(t)})}function Ya(t,o){var h=t,l=o.nt,f=h.bi;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.Ni.Gi({zi:!0});f=h.bi;var u=[];o.Gt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(h.xi.Zi(s,t.en,e).next(function(){return h.xi.tr(s,t.tn,e)})),0<(i=t.resumeToken).X()&&(n=o.st(i,l).et(s.nr),f=f.rt(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.X()),(0===r.resumeToken.X()||3e8<=o.nt.R()-r.nt.R()||0<i.tn.size+i.nn.size+i.en.size)&&u.push(h.xi.er(s,n))))});var e,a,n,c,r,i=Li;return o.Ht.forEach(function(t,e){o.Yt.has(t)&&u.push(h.persistence.ir.sr(s,t))}),u.push((e=s,a=t,n=o.Ht,c=l,r=Vi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Li;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof Hs&&e.version.isEqual(Hr.min())?(a.rr(t,r),o=o.rt(t,e)):null==n||0<e.version.A(n.version)||0===e.version.A(n.version)&&n.hasPendingWrites?(a.Hi(e,r),o=o.rt(t,e)):kr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(Hr.min())||(e=h.xi.Xi(s).next(function(t){return h.xi.ur(s,s.nr,l)}),u.push(e)),Hu.Fe(u).next(function(){return t.apply(s)}).next(function(){return h.ki.ii(s,i)})}).then(function(t){return h.bi=f,t})}function Xa(i,o,s){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:n=(e=i).bi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.ir.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Qu(r=t.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bi=e.bi.remove(o),e.Ci.delete(n.target),[2]}})})}function Ha(t,o,s){var u=t,a=Hr.min(),c=Vi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=su(o),(void 0!==(t=(i=t).Ci.get(r))?Hu.resolve(i.bi.get(t)):i.xi.ar(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.xi.hr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.vi.oi(e,o,s?a:Hr.min(),s?c:Vi())}).next(function(t){return{documents:t,lr:c}});var t,n,r,i})}function Wa(e){return v(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==zr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return kr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ja(t,e,n,r,i){var o=this;this.io=t,this.ro=e,this.Oe=n,this.oo={},this.uo=[],this.co=new Map,this.ao=new Set,this.ho=[],this.lo=i,this.lo._o(function(t){n.Be(function(){return v(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return yc(this)?(kr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).ao.add(4),[4,cc(e)];case 1:return t.sent(),e.fo.set("Unknown"),e.ao.delete(4),[4,ac(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.fo=new nc(n,r)}var Qa,Ka,$a,l=(uc.prototype.mr=function(){return 1===this.state||2===this.state||4===this.state},uc.prototype.Ir=function(){return 2===this.state},uc.prototype.start=function(){3!==this.state?this.auth():this.Ar()},uc.prototype.stop=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.mr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},uc.prototype.Rr=function(){this.state=0,this.Ye.reset()},uc.prototype.Pr=function(){var t=this;this.Ir()&&null===this.Tr&&(this.Tr=this.le.Pe(this._r,6e4,function(){return t.Vr()}))},uc.prototype.yr=function(t){this.gr(),this.stream.send(t)},uc.prototype.Vr=function(){return v(this,void 0,void 0,function(){return y(this,function(t){return this.Ir()?[2,this.close(0)]:[2]})})},uc.prototype.gr=function(){this.Tr&&(this.Tr.cancel(),this.Tr=null)},uc.prototype.close=function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gr(),this.Ye.cancel(),this.Er++,3!==e?this.Ye.reset():n&&n.code===zr.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Ye.Ie()):n&&n.code===zr.UNAUTHENTICATED&&this.wr.Fs(),null!==this.stream&&(this.pr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.vr(n)];case 1:return t.sent(),[2]}})})},uc.prototype.pr=function(){},uc.prototype.auth=function(){var n=this;this.state=1;var t=this.br(this.Er),e=this.Er;this.wr.getToken().then(function(t){n.Er===e&&n.Cr(t)},function(e){t(function(){var t=new Yr(zr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sr(t)})})},uc.prototype.Cr=function(t){var e=this,n=this.br(this.Er);this.stream=this.Dr(t),this.stream.Nr(function(){n(function(){return e.state=2,e.listener.Nr()})}),this.stream.vr(function(t){n(function(){return e.Sr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},uc.prototype.Ar=function(){var t=this;this.state=4,this.Ye.Ae(function(){return v(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},uc.prototype.Sr=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},uc.prototype.br=function(e){var n=this;return function(t){n.le.Be(function(){return n.Er===e?t():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},uc),Za=(n(sc,$a=l),sc.prototype.Dr=function(t){return this.dr.Fr("Listen",t)},sc.prototype.onMessage=function(t){this.Ye.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Sr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qn?(Pr(void 0===o||"string"==typeof o),pi.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),pi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?zr.UNKNOWN:bi(s.code),new Yr(o,s.message||"")),r=new Yi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Co(t,u.document.name),a=Lo(u.document.updateTime),s=new xs({mapValue:{fields:u.document.fields}}),a=new Xs(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Bi(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Co(t,u.document),c=u.readTime?Lo(u.readTime):Hr.min(),c=new Hs(a,c),u=u.removedTargetIds||[];r=new Bi([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Co(t,c.document),c=c.removedTargetIds||[];r=new Bi([],c,h,null)}else{if(!("filter"in e))return Sr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new vi(e),h=h.targetId;r=new zi(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Hr.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Lo(t.readTime):Hr.min()}(t);return this.listener.Or(e,t)},sc.prototype.kr=function(t){var e,n,r,i={};i.database=Vo(this.serializer),i.addTarget=(e=this.serializer,(r=fi(r=(n=t).target)?{documents:{documents:[Uo(e,r.path)]}}:{query:Fo(e,r)}).targetId=n.targetId,0<n.resumeToken.X()?r.resumeToken=Ro(e,n.resumeToken):0<n.nt.A(Hr.min())&&(r.readTime=Do(e,n.nt.P())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Sr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.yr(i)},sc.prototype.Lr=function(t){var e={};e.database=Vo(this.serializer),e.removeTarget=t,this.yr(e)},sc),tc=(n(oc,Ka=l),Object.defineProperty(oc.prototype,"Mr",{get:function(){return this.$r},enumerable:!1,configurable:!0}),oc.prototype.start=function(){this.$r=!1,this.lastStreamToken=void 0,Ka.prototype.start.call(this)},oc.prototype.pr=function(){this.$r&&this.Ur([])},oc.prototype.Dr=function(t){return this.dr.Fr("Write",t)},oc.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.$r){this.Ye.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Lo(t.updateTime):Lo(e);n.isEqual(Hr.min())&&(n=Lo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new ds(n,e)}(t,r)})):[]),n=Lo(t.commitTime);return this.listener.qr(n,e)}var n,r;return Pr(!t.writeResults||0===t.writeResults.length),this.$r=!0,this.listener.Br()},oc.prototype.Qr=function(){var t={};t.database=Vo(this.serializer),this.yr(t)},oc.prototype.Ur=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Mo(e.serializer,t)})};this.yr(t)},oc),ec=(n(ic,Qa=function(){}),ic.prototype.Wr=function(){if(this.jr)throw new Yr(zr.FAILED_PRECONDITION,"The client has already been terminated.")},ic.prototype.Kr=function(e,n,r){var i=this;return this.Wr(),this.credentials.getToken().then(function(t){return i.dr.Kr(e,n,r,t)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&i.credentials.Fs(),t})},ic.prototype.Gr=function(e,n,r){var i=this;return this.Wr(),this.credentials.getToken().then(function(t){return i.dr.Gr(e,n,r,t)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&i.credentials.Fs(),t})},ic.prototype.terminate=function(){this.jr=!1},ic),nc=(rc.prototype.Xr=function(){var t=this;0===this.Hr&&(this.Zr("Unknown"),this.Yr=this.Oe.Pe("online_state_timeout",1e4,function(){return t.Yr=null,t.no("Backend didn't respond within 10 seconds."),t.Zr("Offline"),Promise.resolve()}))},rc.prototype.eo=function(t){"Online"===this.state?this.Zr("Unknown"):(this.Hr++,1<=this.Hr&&(this.so(),this.no("Connection failed 1 times. Most recent error: "+t.toString()),this.Zr("Offline")))},rc.prototype.set=function(t){this.so(),this.Hr=0,"Online"===t&&(this.Jr=!1),this.Zr(t)},rc.prototype.Zr=function(t){t!==this.state&&(this.state=t,this.zr(t))},rc.prototype.no=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Jr?(Dr(t),this.Jr=!1):kr("OnlineStateTracker",t)},rc.prototype.so=function(){null!==this.Yr&&(this.Yr.cancel(),this.Yr=null)},rc);function rc(t,e){this.Oe=t,this.zr=e,this.state="Unknown",this.Hr=0,this.Yr=null,this.Jr=!0}function ic(t,e,n){var r=this;return(r=Qa.call(this)||this).credentials=t,r.dr=e,r.serializer=n,r.jr=!1,r}function oc(t,e,n,r,i){var o=this;return(o=Ka.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.$r=!1,o}function sc(t,e,n,r,i){var o=this;return(o=$a.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function uc(t,e,n,r,i,o){this.le=t,this._r=n,this.dr=r,this.wr=i,this.listener=o,this.state=0,this.Er=0,this.Tr=null,this.stream=null,this.Ye=new Xu(t,e)}function ac(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:if(!yc(r))return[3,4];e=0,n=r.ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function cc(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:e=0,n=r.ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function hc(t,e){t.co.has(e.targetId)||(t.co.set(e.targetId,e),vc(t)?dc(t):Ac(t).Ir()&&fc(t,e))}function lc(t,e){var n=t,t=Ac(n);n.co.delete(e),t.Ir()&&pc(n,e),0===n.co.size&&(t.Ir()?t.Pr():yc(n)&&n.fo.set("Unknown"))}function fc(t,e){t.wo.In(e.targetId),Ac(t).kr(e)}function pc(t,e){t.wo.In(e),Ac(t).Lr(e)}function dc(e){e.wo=new Hi({qn:function(t){return e.oo.qn(t)},Bn:function(t){return e.co.get(t)||null}}),Ac(e).start(),e.fo.Xr()}function vc(t){return yc(t)&&!Ac(t).mr()&&0<t.co.size}function yc(t){return 0===t.ao.size}function gc(t){t.wo=void 0}function mc(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:if(s.fo.set("Online"),!(u instanceof Yi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.co.has(i)?[4,o.oo.Eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.co.delete(i),o.wo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,wc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Bi?s.wo.vn(u):u instanceof zi?s.wo.On(u):s.wo.Sn(u),a.isEqual(Hr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,za(s.io)];case 8:return o=t.sent(),0<=a.A(o)?[4,(i=a,(e=(r=s).wo.$n(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.X()&&((n=r.co.get(e))&&r.co.set(e,n.st(t.resumeToken,i)))}),e.zt.forEach(function(t){var e=r.co.get(t);e&&(r.co.set(t,e.st(pi.Z,e.nt)),pc(r,t),e=new gi(e.target,t,1,e.sequenceNumber),fc(r,e))}),r.oo.To(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,wc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function wc(n,r,i){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!Qu(r))throw r;return n.ao.add(1),[4,cc(n)];case 1:return t.sent(),n.fo.set("Offline"),i=i||function(){return za(n.io)},n.Oe.ss(function(){return v(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ao.delete(1),[4,ac(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function bc(e,n){return n().catch(function(t){return wc(e,t,n)})}function Ec(a){return v(this,void 0,void 0,function(){var i,o,s,u;return y(this,function(t){switch(t.label){case 0:o=Nc(i=a),s=0<i.uo.length?i.uo[i.uo.length-1].batchId:-1,t.label=1;case 1:if(!(yc(i)&&i.uo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.io,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ys.cr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.uo.length&&o.Pr(),[3,7]):(s=u.batchId,function(t,e){t.uo.push(e);t=Nc(t);t.Ir()&&t.Mr&&t.Ur(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,wc(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Tc(i)&&Ic(i),[2]}var e,n,r})})}function Tc(t){return yc(t)&&!Nc(t).mr()&&0<t.uo.length}function Ic(t){Nc(t).start()}function Ac(n){var t,e,r,i=this;return n.Ao||(n.Ao=(t=n.ro,e=n.Oe,r={Nr:function(n){return v(this,void 0,void 0,function(){return y(this,function(t){return n.co.forEach(function(t,e){fc(n,t)}),[2]})})}.bind(null,n),vr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){return gc(e),vc(e)?(e.fo.eo(n),dc(e)):e.fo.set("Unknown"),[2]})})}.bind(null,n),Or:mc.bind(null,n)},t.Wr(),new Za(e,t.dr,t.credentials,t.serializer,r)),n.ho.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.Ao.Rr(),vc(n)?dc(n):n.fo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Ao.stop()];case 2:t.sent(),gc(n),t.label=3;case 3:return[2]}})})})),n.Ao}function Nc(n){var t,e,r,i=this;return n.Ro||(n.Ro=(t=n.ro,e=n.Oe,r={Nr:function(e){return v(this,void 0,void 0,function(){return y(this,function(t){return Nc(e).Qr(),[2]})})}.bind(null,n),vr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return n&&Nc(e).Mr?[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return wi(n=i.code)&&n!==zr.ABORTED?(e=r.uo.shift(),Nc(r).Rr(),[4,bc(r,function(){return r.oo.Io(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Ec(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Tc(e)&&Ic(e),[2]}})})}.bind(null,n),Br:function(o){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){for(e=Nc(o),n=0,r=o.uo;n<r.length;n++)i=r[n],e.Ur(i.mutations);return[2]})})}.bind(null,n),qr:function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=r.uo.shift(),n=ma.from(e,i,o),[4,bc(r,function(){return r.oo.mo(n)})];case 1:return t.sent(),[4,Ec(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Wr(),new tc(e,t.dr,t.credentials,t.serializer,r)),n.ho.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.Ro.Rr(),[4,Ec(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Ro.stop()];case 3:t.sent(),0<n.uo.length&&(kr("RemoteStore","Stopping write stream with "+n.uo.length+" pending writes"),n.uo=[]),t.label=4;case 4:return[2]}})})})),n.Ro}var Oc=(qc.prototype.T=function(){return this.Po.T()},qc.prototype.vo=function(t,e){e=new kc(t,e);this.Po=this.Po.add(e),this.yo=this.yo.add(e)},qc.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},qc.prototype.Co=function(t,e){this.So(new kc(t,e))},qc.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},qc.prototype.No=function(t){var e=this,n=new Kr(new Wr([])),r=new kc(n,t),t=new kc(n,t+1),i=[];return this.yo.Nt([r,t],function(t){e.So(t),i.push(t.key)}),i},qc.prototype.Fo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},qc.prototype.So=function(t){this.Po=this.Po.delete(t),this.yo=this.yo.delete(t)},qc.prototype.xo=function(t){var e=new Kr(new Wr([])),n=new kc(e,t),t=new kc(e,t+1),r=Vi();return this.yo.Nt([n,t],function(t){r=r.add(t.key)}),r},qc.prototype.Oo=function(t){var e=new kc(t,0),e=this.Po.xt(e);return null!==e&&t.isEqual(e.key)},qc),kc=(Fc.Vo=function(t,e){return Kr.g(t.key,e.key)||Ur(t.ko,e.ko)},Fc.po=function(t,e){return Ur(t.ko,e.ko)||Kr.g(t.key,e.key)},Fc),Dc=(Mc.prototype.Lo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Mc.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Mc.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},Mc),Rc=(jc.prototype.Bo=function(t){},jc.prototype.Qo=function(t,e,n){},jc.prototype.jo=function(t){return this.Uo.Lo(t),this.qo[t]||"not-current"},jc.prototype.Wo=function(t,e,n){this.qo[t]=e},jc.prototype.Ko=function(t){this.Uo.$o(t)},jc.prototype.Go=function(t){return this.Uo.activeTargetIds.has(t)},jc.prototype.zo=function(t){delete this.qo[t]},jc.prototype.Ho=function(){return this.Uo.activeTargetIds},jc.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},jc.prototype.start=function(){return this.Uo=new Dc,Promise.resolve()},jc.prototype.Jo=function(t,e,n){},jc.prototype.Xo=function(t){},jc.prototype.Zo=function(){},jc.prototype.Ii=function(t){},jc.prototype.tu=function(){},jc),Lc=function(t){this.key=t},Sc=function(t){this.key=t},Pc=(Object.defineProperty(xc.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),xc.prototype.uu=function(t,e){var s=this,u=e?e.cu:new Mi,a=(e||this).ru,c=(e||this).Qt,h=a,l=!1,f=tu(this.query)&&a.size===this.query.limit?a.last():null,p=eu(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof Xs?e:null)&&(pu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Jn||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),tu(this.query)||eu(this.query))for(;h.size>this.query.limit;){var n=tu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ru:h,cu:u,hu:l,Qt:c}},xc.prototype.au=function(t,e){return t.Jn&&e.hasCommittedMutations&&!e.Jn},xc.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.Qt=t.Qt;var i=t.cu.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sr()}}var r,i}),this._u(n);var s=e?this.fu():[],n=0===this.su.size&&this.Zt?1:0,e=n!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Fi(this.query,t.ru,r,i,t.Qt,0==n,e,!1),du:s}:{du:s}},xc.prototype.Es=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.lu({ru:this.ru,cu:new Mi,Qt:this.Qt,hu:!1},!1)):{du:[]}},xc.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).Jn},xc.prototype._u=function(t){var e=this;t&&(t.tn.forEach(function(t){return e.nu=e.nu.add(t)}),t.nn.forEach(function(t){}),t.en.forEach(function(t){return e.nu=e.nu.delete(t)}),this.Zt=t.Zt)},xc.prototype.fu=function(){var e=this;if(!this.Zt)return[];var n=this.su;this.su=Vi(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new Sc(t))}),this.su.forEach(function(t){n.has(t)||r.push(new Lc(t))}),r},xc.prototype.Eu=function(t){this.nu=t.lr,this.su=Vi();t=this.uu(t.documents);return this.lu(t,!0)},xc.prototype.Tu=function(){return Fi.Kt(this.query,this.ru,this.Qt,0===this.eu)},xc),_c=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Cc=function(t){this.key=t,this.mu=!1},Uc=(Object.defineProperty(Vc.prototype,"xu",{get:function(){return!0===this.Fu},enumerable:!1,configurable:!0}),Vc);function Vc(t,e,n,r,i,o){this.io=t,this.Iu=e,this.Au=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.Vu={},this.yu=new Br(lu,hu),this.gu=new Map,this.pu=[],this.vu=new Ei(Kr.g),this.bu=new Map,this.Cu=new Oc,this.Su={},this.Du=new Map,this.Nu=Va.pi(),this.onlineState="Unknown",this.Fu=void 0}function xc(t,e){this.query=t,this.nu=e,this.eu=null,this.Zt=!1,this.su=Vi(),this.Qt=Vi(),this.iu=du(t),this.ru=new ji(this.iu)}function jc(){this.Uo=new Dc,this.qo={},this.zr=null,this.Ei=null}function Mc(){this.activeTargetIds=xi}function Fc(t,e){this.key=t,this.ko=e}function qc(){this.Po=new Di(kc.Vo),this.yo=new Di(kc.po)}function Gc(c,h){return v(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return(e=c).Iu.oo.To=zc.bind(null,e),e.Iu.oo.qn=function(t,e){var n=t,t=n.bu.get(e);if(t&&t.mu)return Vi().add(t.key);var r=Vi(),e=n.gu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.yu.get(s);r=r.Ot(s.view.ou)}return r}.bind(null,e),e.Iu.oo.Eo=function(o,s,u){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Ei(Kr.g)).rt(n,new Hs(n,Hr.min())),i=Vi().add(n),i=new qi(Hr.min(),new Map,new Di(Ur),r,i),[4,zc(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),$c(e),[3,4];case 2:return[4,Xa(e.io,s,!1).then(function(){return Jc(e,s,u)}).catch(Wa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Vu.Or=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ts(s)&&(r=!0);u.fs=s}}r&&ua(n)}.bind(null,e.Au),e.Vu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Au),(a=(n=e).yu.get(h))?(o=a.targetId,n.Ru.jo(o),s=a.view.Tu(),[3,4]):[3,1];case 1:return[4,(e=n.io,r=su(h),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.xi.ar(e,r).next(function(t){return t?(n=t,Hu.resolve(n)):i.xi.ku(e).next(function(t){return n=new gi(r,t,0,e.nr),i.xi.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.bi.get(t.targetId);return(null===e||0<t.nt.A(e.nt))&&(i.bi=i.bi.rt(t.targetId,t),i.Ci.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return i.$u=function(t,e,n){return function(r,i,o,s){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,Ha(r.io,i.query,!1).then(function(t){t=t.documents;return i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.lu(e,r.xu,n),[2,(Kc(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,Ha(i.io,o,!0)];case 1:return n=t.sent(),r=new Pc(o,n.lr),e=r.uu(n.documents),n=Gi.Xt(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.xu,n),Kc(i,s,n.du),r=new _c(o,s,r),i.yu.set(o,r),i.gu.has(s)?i.gu.get(s).push(o):i.gu.set(s,[o]),[2,n.snapshot]}})})}(n,h,o,"current"===a)];case 3:s=t.sent(),n.xu&&hc(n.Iu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function Bc(f,p,d){return v(this,void 0,void 0,function(){var s,u;return y(this,function(t){switch(t.label){case 0:(o=f).Iu.oo.mo=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ba(e.io,o)];case 2:return r=t.sent(),Wc(e,n,null),Hc(e,n),e.Ru.Qo(n,"acknowledged"),[4,Zc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Wa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Iu.oo.Io=function(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ys.qu(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.Ys.Yi(e,t)}).next(function(){return i.Ys.Ji(e)}).next(function(){return i.ki.si(e,n)})}))];case 2:return o=t.sent(),Wc(n,u,a),Hc(n,u),n.Ru.Qo(u,"rejected",a),[4,Zc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Wa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.io,a=p,h=r,l=Xr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Vi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.ki.si(u,i).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Ls?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Xs?t.field(i.field):void 0,o=Wo(i.transform,o||null);null!=o&&(e=(null==e?new js:e).set(i.field,o))}return e?e.Xn():null}(o):null);null!=o&&e.push(new Ns(i.key,o,function s(t){var u=[];return jr(t.fields||{},function(t,e){var n=new Qr([t]);if(Eo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new fs(u)}(o.proto.mapValue),vs.exists(!0)))}return h.Ys.Mu(u,l,e,a)})}).then(function(t){var e=t.Ks(c);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.bs()])||new Ei(Ur)).rt(n,o),e.Su[e.currentUser.bs()]=r,[4,Zc(u,s.Uu)];case 3:return t.sent(),[4,Ec(u.Iu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=na(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,l,i,o})})}function zc(r,i){return v(this,void 0,void 0,function(){var n,e;return y(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ya(n.io,i)];case 2:return e=t.sent(),i.Gt.forEach(function(t,e){e=n.bu.get(e);e&&(Pr(t.tn.size+t.nn.size+t.en.size<=1),0<t.tn.size?e.mu=!0:0<t.nn.size?Pr(e.mu):0<t.en.size&&(Pr(e.mu),e.mu=!1))}),[4,Zc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Wa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Yc(t,n,e){var r,t=t;(t.xu&&0===e||!t.xu&&1===e)&&(r=[],t.yu.forEach(function(t,e){e=e.view.Es(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Es(i)&&(o=!0)}),o&&ua(t)}(t.Au,n),r.length&&t.Vu.Or(r),t.onlineState=n,t.xu&&t.Ru.Xo(n))}function Xc(o,s){return v(this,void 0,void 0,function(){var n,r,i;return y(this,function(t){switch(t.label){case 0:yc((n=o).Iu)||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.io).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ys.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=t.sent(),i=na(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Hc(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Wc(t,e,n){var r=t,i=r.Su[r.currentUser.bs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.bs()]=i)}function Jc(e,t,n){void 0===n&&(n=null),e.Ru.Ko(t);for(var r=0,i=e.gu.get(t);r<i.length;r++){var o=i[r];e.yu.delete(o),n&&e.Vu.Ou(o,n)}e.gu.delete(t),e.xu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||Qc(e,t)})}function Qc(t,e){var n=t.vu.get(e);null!==n&&(lc(t.Iu,n),t.vu=t.vu.remove(e),t.bu.delete(n),$c(t))}function Kc(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Lc?(t.Cu.vo(o.key,e),function(t,e){e=e.key;t.vu.get(e)||(kr("SyncEngine","New document in limbo: "+e),t.pu.push(e),$c(t))}(t,o)):o instanceof Sc?(kr("SyncEngine","Document no longer in limbo: "+o.key),t.Cu.Co(o.key,e),t.Cu.Oo(o.key)||Qc(t,o.key)):Sr()}}function $c(t){for(;0<t.pu.length&&t.vu.size<t.Pu;){var e=t.pu.shift(),n=t.Nu.next();t.bu.set(n,new Cc(e)),t.vu=t.vu.rt(e,n),hc(t.Iu,new gi(su(Zs(e.path)),n,2,Ra.Ai))}}function Zc(e,s,u){return v(this,void 0,void 0,function(){var n,r,i,o;return y(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).yu.T()?[3,3]:(n.yu.forEach(function(t,e){o.push(n.$u(e,s,u).then(function(t){t&&(n.xu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Da.wi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Vu.Or(r),[4,function(a,c){return v(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return y(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Hu.forEach(c,function(e){return Hu.forEach(e.fi,function(t){return r.persistence.ir.vo(n,e.targetId,t)}).next(function(){return Hu.forEach(e.di,function(t){return r.persistence.ir.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Qu(e=t.sent()))throw e;return kr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bi.get(o),u=s.nt,u=s.it(u),r.bi=r.bi.rt(o,u));return[2]}})})}(n.io,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function th(i,o){return v(this,void 0,void 0,function(){var n,r;return y(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(kr("SyncEngine","User change. New user:",o.bs()),[4,Ga(n.io,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Yr(zr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Wi,r.Ki),[4,Zc(n,r.ji)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var eh,nh,rh,ih=(Fh.prototype.Ui=function(t){this.Qu=t},Fh.prototype.oi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.re.length||1===r.re.length&&r.re[0].field.U())||i.isEqual(Hr.min())?this.ju(e,r):this.Qu.si(e,o).next(function(t){var n=s.Wu(r,t);return(tu(r)||eu(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Or()<=u.DEBUG&&kr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fu(r)),s.Qu.oi(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Fh.prototype.Wu=function(n,t){var r=new Di(du(n));return t.forEach(function(t,e){e instanceof Xs&&pu(n,e)&&(r=r.add(e))}),r},Fh.prototype.hu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.A(r))},Fh.prototype.ju=function(t,e){return Or()<=u.DEBUG&&kr("IndexFreeQueryEngine","Using full collection scan to execute query:",fu(e)),this.Qu.oi(t,e,Hr.min())},Fh),oh=(Mh.prototype.zu=function(t){return Hu.resolve(0===this.Ys.length)},Mh.prototype.Mu=function(t,e,n,r){var i=this.Ku;this.Ku++,0<this.Ys.length&&this.Ys[this.Ys.length-1];n=new ga(i,e,n,r);this.Ys.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Gu=this.Gu.add(new kc(u.key,i)),this.Js.Vi(t,u.key.path.C())}return Hu.resolve(n)},Mh.prototype.qu=function(t,e){return Hu.resolve(this.Hu(e))},Mh.prototype.cr=function(t,e){e+=1,e=this.Yu(e),e=e<0?0:e;return Hu.resolve(this.Ys.length>e?this.Ys[e]:null)},Mh.prototype.Bu=function(){return Hu.resolve(0===this.Ys.length?-1:this.Ku-1)},Mh.prototype.Qi=function(t){return Hu.resolve(this.Ys.slice())},Mh.prototype.Zs=function(t,e){var n=this,r=new kc(e,0),e=new kc(e,Number.POSITIVE_INFINITY),i=[];return this.Gu.Nt([r,e],function(t){t=n.Hu(t.ko);i.push(t)}),Hu.resolve(i)},Mh.prototype.ri=function(t,e){var n=this,r=new Di(Ur);return e.forEach(function(t){var e=new kc(t,0),t=new kc(t,Number.POSITIVE_INFINITY);n.Gu.Nt([e,t],function(t){r=r.add(t.ko)})}),Hu.resolve(this.Ju(r))},Mh.prototype.li=function(t,e){var n=e.path,r=n.length+1,e=n;Kr.G(e)||(e=e.child(""));var e=new kc(new Kr(e),0),i=new Di(Ur);return this.Gu.Ft(function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(i=i.add(t.ko)),!0)},e),Hu.resolve(this.Ju(i))},Mh.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Hu(t);null!==t&&n.push(t)}),n},Mh.prototype.Yi=function(n,r){var i=this;Pr(0===this.Xu(r.batchId,"removed")),this.Ys.shift();var o=this.Gu;return Hu.forEach(r.mutations,function(t){var e=new kc(t.key,r.batchId);return o=o.delete(e),i.ir.Zu(n,t.key)}).next(function(){i.Gu=o})},Mh.prototype.tc=function(t){},Mh.prototype.Oo=function(t,e){var n=new kc(e,0),n=this.Gu.xt(n);return Hu.resolve(e.isEqual(n&&n.key))},Mh.prototype.Ji=function(t){return this.Ys.length,Hu.resolve()},Mh.prototype.Xu=function(t,e){return this.Yu(t)},Mh.prototype.Yu=function(t){return 0===this.Ys.length?0:t-this.Ys[0].batchId},Mh.prototype.Hu=function(t){t=this.Yu(t);return t<0||t>=this.Ys.length?null:this.Ys[t]},Mh),sh=(jh.prototype.Hi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.nc(e);return this.docs=this.docs.rt(r,{ec:e,size:i,readTime:n}),this.size+=i-o,this.Js.Vi(t,r.path.C())},jh.prototype.rr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},jh.prototype.ni=function(t,e){e=this.docs.get(e);return Hu.resolve(e?e.ec:null)},jh.prototype.getEntries=function(t,e){var n=this,r=Li;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.ec:null)}),Hu.resolve(r)},jh.prototype.oi=function(t,e,n){for(var r=_i,i=new Kr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Tt(),u=s.key,a=s.value,s=a.ec,a=a.readTime;if(!e.path.N(u.path))break;a.A(n)<=0||s instanceof Xs&&pu(e,s)&&(r=r.rt(s.key,s))}return Hu.resolve(r)},jh.prototype.sc=function(t,e){return Hu.forEach(this.docs,function(t){return e(t)})},jh.prototype.Gi=function(t){return new uh(this)},jh.prototype.ic=function(t){return Hu.resolve(this.size)},jh),uh=(xh.prototype.oc=function(t){t=this.Uu.get(t);return t?t.readTime:Hr.min()},xh.prototype.Hi=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},xh.prototype.rr=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},xh.prototype.ni=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?Hu.resolve(n.ec):this.cc(t,e)},xh.prototype.getEntries=function(t,e){return this.ac(t,e)},xh.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},xh.prototype.uc=function(){},n(Vh,rh=xh),Vh.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.Hi(n,e.ec,r.oc(t))):r.hc.rr(t)}),Hu.Fe(i)},Vh.prototype.cc=function(t,e){return this.hc.ni(t,e)},Vh.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Vh),ah=(Uh.prototype.Dn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),Hu.resolve()},Uh.prototype.Xi=function(t){return Hu.resolve(this.lastRemoteSnapshotVersion)},Uh.prototype.wc=function(t){return Hu.resolve(this._c)},Uh.prototype.ku=function(t){return this.highestTargetId=this.dc.next(),Hu.resolve(this.highestTargetId)},Uh.prototype.ur=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),Hu.resolve()},Uh.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new Va(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},Uh.prototype.Lu=function(t,e){return this.Ec(e),this.targetCount+=1,Hu.resolve()},Uh.prototype.er=function(t,e){return this.Ec(e),Hu.resolve()},Uh.prototype.Tc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,Hu.resolve()},Uh.prototype.mc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ic(n,e.targetId)),s++)}),Hu.Fe(u).next(function(){return s})},Uh.prototype.Ac=function(t){return Hu.resolve(this.targetCount)},Uh.prototype.ar=function(t,e){e=this.lc.get(e)||null;return Hu.resolve(e)},Uh.prototype.tr=function(t,e,n){return this.fc.bo(e,n),Hu.resolve()},Uh.prototype.Zi=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.ir,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),Hu.Fe(i)},Uh.prototype.Ic=function(t,e){return this.fc.No(e),Hu.resolve()},Uh.prototype.hr=function(t,e){e=this.fc.xo(e);return Hu.resolve(e)},Uh.prototype.Oo=function(t,e){return Hu.resolve(this.fc.Oo(e))},Uh),ch=(Ch.prototype.Vc=function(t,e){return Hu.resolve(this.Rc.get(e))},Ch.prototype.yc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Lo(e.createTime)}),Hu.resolve()},Ch.prototype.gc=function(t,e){return Hu.resolve(this.Pc.get(e))},Ch.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(r=n.bundledQuery,e=qo({parent:r.parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?uu(e,e.limit,"L"):e),readTime:Lo(n.readTime)}),Hu.resolve()},Ch),hh=(_h.prototype.start=function(){return Promise.resolve()},_h.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(_h.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),_h.prototype.Fc=function(){},_h.prototype.xc=function(){},_h.prototype.Li=function(){return this.Js},_h.prototype.Di=function(t){var e=this.bc[t.bs()];return e||(e=new oh(this.Js,this.ir),this.bc[t.bs()]=e),e},_h.prototype.Oi=function(){return this.xi},_h.prototype.Fi=function(){return this.Hs},_h.prototype.Mi=function(){return this.$i},_h.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new lh(this.Cc.next());return this.ir.Oc(),n(i).next(function(t){return r.ir.kc(i).next(function(){return t})}).De().then(function(t){return i.Lc(),t})},_h.prototype.$c=function(e,n){return Hu.xe(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},_h),lh=(Ph.prototype.Uc=function(t){this.Mc.push(t)},Ph.prototype.Lc=function(){this.Mc.forEach(function(t){return t()})},n(Sh,nh=Ph),Sh),fh=(Lh.Qc=function(t){return new Lh(t)},Object.defineProperty(Lh.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw Sr()},enumerable:!1,configurable:!0}),Lh.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),Hu.resolve()},Lh.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),Hu.resolve()},Lh.prototype.Zu=function(t,e){return this.jc.add(e.toString()),Hu.resolve()},Lh.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Oi();return r.hr(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.Tc(t,e)})},Lh.prototype.Oc=function(){this.Bc=new Set},Lh.prototype.kc=function(n){var r=this,i=this.persistence.Fi().Gi();return Hu.forEach(this.jc,function(t){var e=Kr.j(t);return r.Wc(n,e).next(function(t){t||i.rr(e)})}).next(function(){return r.Bc=null,i.apply(n)})},Lh.prototype.sr=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},Lh.prototype.Dc=function(t){return 0},Lh.prototype.Wc=function(t,e){var n=this;return Hu.xe([function(){return Hu.resolve(n.qc.Oo(e))},function(){return n.persistence.Oi().Oo(t,e)},function(){return n.persistence.$c(t,e)}])},Lh),ph=(Rh.prototype.Nr=function(t){this.zc=t},Rh.prototype.vr=function(t){this.Hc=t},Rh.prototype.onMessage=function(t){this.Yc=t},Rh.prototype.close=function(){this.Gc()},Rh.prototype.send=function(t){this.Kc(t)},Rh.prototype.Jc=function(){this.zc()},Rh.prototype.Xc=function(t){this.Hc(t)},Rh.prototype.Zc=function(t){this.Yc(t)},Rh),dh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},vh=(Dh.prototype.Kr=function(e,t,n,r){var i=this.sa(e,t);kr("RestConnection","Sending: ",i,n);t={};return this.ia(t,r),this.ra(e,i,t,n).then(function(t){return kr("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Dh.prototype.Gr=function(t,e,n,r){return this.Kr(t,e,n,r)},Dh.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2",t["Content-Type"]="text/plain",e)for(var n in e.Ds)e.Ds.hasOwnProperty(n)&&(t[n]=e.Ds[n])},Dh.prototype.sa=function(t,e){t=dh[t];return this.na+"/v1/"+e+":"+t},n(kh,eh=Dh),kh.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();kr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:kr("Connection",'RPC "'+o+'" timed out'),r(new Yr(zr.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();kr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(zr).indexOf(e)?e:zr.UNKNOWN,r(new Yr(e,t.message))):r(new Yr(zr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Yr(zr.UNAVAILABLE,"Connection failed."));break;default:Sr()}}finally{kr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},kh.prototype.Fr=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");kr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new ph({Kc:function(t){u?kr("Connection","Not sending because WebChannel is closed:",t):(s||(kr("Connection","Opening WebChannel transport."),o.open(),s=!0),kr("Connection","WebChannel sending:",t),o.send(t))},Gc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||kr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,kr("Connection","WebChannel transport closed"),a.Xc())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Rr("Connection","WebChannel transport errored:",t),a.Xc(new Yr(zr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(kr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=yi[r];if(void 0!==t)return bi(t)}(),i=n.message,void 0===t&&(t=zr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Xc(new Yr(t,i)),o.close()):(kr("Connection","WebChannel received:",e),a.Zc(e)))}),setTimeout(function(){a.Jc()},0),a},kh),yh=(Oh.prototype._o=function(t){this.ha.push(t)},Oh.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},Oh.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},Oh.prototype.ua=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},Oh.prototype.aa=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},Oh._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Oh),gh=(Nh.prototype._o=function(t){},Nh.prototype.Zo=function(){},Nh),mh=(Ah.prototype.initialize=function(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.serializer=Na(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.io=this.Ta(e),[2]}})})},Ah.prototype.Ea=function(t){return null},Ah.prototype.Ta=function(t){return e=this.persistence,n=new ih,r=t.ma,t=this.serializer,new xa(e,n,r,t);var e,n,r},Ah.prototype.da=function(t){return new hh(fh.Qc,this.serializer)},Ah.prototype.fa=function(t){return new Rc},Ah.prototype.terminate=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},Ah),wh=(Ih.prototype.initialize=function(n,r){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.io?[3,2]:(this.io=n.io,this.Ru=n.Ru,this.ro=this.Ia(r),this.Iu=this.Aa(r),this.Au=this.Ra(r),this.Pa=this.Va(r,!n.synchronizeTabs),this.Ru.zr=function(t){return Yc(e.Pa,t,1)},this.Iu.oo.ya=th.bind(null,this.Pa),[4,function(n,r){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,r?(e.ao.delete(2),[4,ac(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ao.add(2),[4,cc(e)]);case 3:t.sent(),e.fo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Iu,this.Pa.xu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ih.prototype.Ra=function(t){return new ra},Ih.prototype.Ia=function(t){var e=Na(t.ta.t),n=(n=t.ta,new vh(n));return t=t.credentials,new ec(t,n,e)},Ih.prototype.Aa=function(t){var e=this,n=this.io,r=this.ro,i=t.Oe,o=function(t){return Yc(e.Pa,t,0)},t=new(yh._a()?yh:gh);return new Ja(n,r,i,o,t)},Ih.prototype.Va=function(t,e){return function(t,e,n,r,i,o,s){o=new Uc(t,e,n,r,i,o);return s&&(o.Fu=!0),o}(this.io,this.Iu,this.Au,this.Ru,t.ma,t.Pu,e)},Ih.prototype.terminate=function(){return function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,kr("RemoteStore","RemoteStore shutting down."),e.ao.add(5),[4,cc(e)];case 1:return t.sent(),e.lo.Zo(),e.fo.set("Unknown"),[2]}})})}(this.Iu)},Ih),bh=(Th.prototype.next=function(t){this.observer.next&&this.ga(this.observer.next,t)},Th.prototype.error=function(t){this.observer.error?this.ga(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Th.prototype.pa=function(){this.muted=!0},Th.prototype.ga=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Th),Eh=function(t){this.va=t};function Th(t){this.observer=t,this.muted=!1}function Ih(){}function Ah(){this.synchronizeTabs=!1}function Nh(){}function Oh(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function kh(t){var e=this;return(e=eh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Dh(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Rh(t){this.Kc=t.Kc,this.Gc=t.Gc}function Lh(t){this.persistence=t,this.qc=new Oc,this.Bc=null}function Sh(t){var e=this;return(e=nh.call(this)||this).nr=t,e}function Ph(){this.Mc=[]}function _h(t,e){var n=this;this.bc={},this.Cc=new Ra(0),this.Sc=!1,this.Sc=!0,this.ir=t(this),this.xi=new ah(this),this.Js=new Ca,this.Hs=(t=this.Js,new sh(t,function(t){return n.ir.Dc(t)})),this.serializer=new _a(e),this.$i=new ch(this.serializer)}function Ch(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function Uh(t){this.persistence=t,this.lc=new Br(hi,li),this.lastRemoteSnapshotVersion=Hr.min(),this.highestTargetId=0,this._c=0,this.fc=new Oc,this.targetCount=0,this.dc=Va.gi()}function Vh(t){var e=this;return(e=rh.call(this)||this).hc=t,e}function xh(){this.Uu=new Br(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function jh(t,e){this.Js=t,this.nc=e,this.docs=new Ei(Kr.g),this.size=0}function Mh(t,e){this.Js=t,this.ir=e,this.Ys=[],this.Ku=1,this.Gu=new Di(kc.Vo)}function Fh(){}function qh(t,e,n){if(!n)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Gh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(zr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Bh(t,e,n,r){if(!0===e&&!0===r)throw new Yr(zr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function zh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Sr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Yh(t,e){if(t instanceof Eh&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Yr(zr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=zh(t);throw new Yr(zr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Xh(t,e){if(e<=0)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Hh,Wh=function(t){this.ba=t},Jh=(n(Qh,Hh=Wh),Qh.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.jn.push(t.path),null},Qh.prototype.isEqual=function(t){return t instanceof Qh},Qh);function Qh(){return null!==Hh&&Hh.apply(this,arguments)||this}function Kh(t,e,n){return new Hl({Sa:3,Na:e.settings.Na,methodName:t.ba,Fa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var $h,Zh,tl,el,nl=(n(yl,el=Wh),yl.prototype.Ca=function(t){return new ls(t.path,new Ko)},yl.prototype.isEqual=function(t){return t instanceof yl},yl),rl=(n(vl,tl=Wh),vl.prototype.Ca=function(t){var e=Kh(this,t,!0),n=this.xa.map(function(t){return ef(t,e)}),n=new $o(n);return new ls(t.path,n)},vl.prototype.isEqual=function(t){return this===t},vl),il=(n(dl,Zh=Wh),dl.prototype.Ca=function(t){var e=Kh(this,t,!0),n=this.xa.map(function(t){return ef(t,e)}),n=new rs(n);return new ls(t.path,n)},dl.prototype.isEqual=function(t){return this===t},dl),ol=(n(pl,$h=Wh),pl.prototype.Ca=function(t){var e=new us(t.serializer,ko(t.serializer,this.Oa));return new ls(t.path,e)},pl.prototype.isEqual=function(t){return this===t},pl),sl=(Object.defineProperty(fl.prototype,"latitude",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Object.defineProperty(fl.prototype,"longitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),fl.prototype.isEqual=function(t){return this.ka===t.ka&&this.La===t.La},fl.prototype.toJSON=function(){return{latitude:this.ka,longitude:this.La}},fl.prototype.m=function(t){return Ur(this.ka,t.ka)||Ur(this.La,t.La)},fl),ul=(ll.fromBase64String=function(t){try{return new ll(pi.fromBase64String(t))}catch(t){throw new Yr(zr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},ll.fromUint8Array=function(t){return new ll(pi.fromUint8Array(t))},ll.prototype.toBase64=function(){return this.$a.toBase64()},ll.prototype.toUint8Array=function(){return this.$a.toUint8Array()},ll.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},ll.prototype.isEqual=function(t){return this.$a.isEqual(t.$a)},ll),al=new Map,cl=(hl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},hl);function hl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(zr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Yr(zr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Bh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function ll(t){this.$a=t}function fl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Yr(zr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yr(zr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ka=t,this.La=e}function pl(t,e){var n=this;return(n=$h.call(this,t)||this).Oa=e,n}function dl(t,e){var n=this;return(n=Zh.call(this,t)||this).xa=e,n}function vl(t,e){var n=this;return(n=tl.call(this,t)||this).xa=e,n}function yl(){return null!==el&&el.apply(this,arguments)||this}function gl(){if("undefined"==typeof Uint8Array)throw new Yr(zr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ml(){if("undefined"==typeof atob)throw new Yr(zr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var wl,bl,El,Tl=(n(Rl,El=ul),Rl.fromBase64String=function(t){ml();try{return new Rl(pi.fromBase64String(t))}catch(t){throw new Yr(zr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Rl.fromUint8Array=function(t){return gl(),new Rl(pi.fromUint8Array(t))},Rl.prototype.toBase64=function(){return ml(),El.prototype.toBase64.call(this)},Rl.prototype.toUint8Array=function(){return gl(),El.prototype.toUint8Array.call(this)},Rl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Rl),Ie=(Dl.prototype.Ma=function(t,e){switch(void 0===e&&(e="none"),so(t)){case 0:return null;case 1:return t.booleanValue;case 2:return po(t.integerValue||t.doubleValue);case 3:return this.Ua(t.timestampValue);case 4:return this.qa(t,e);case 5:return t.stringValue;case 6:return this.Ba(vo(t.bytesValue));case 7:return this.Qa(t.referenceValue);case 8:return this.ja(t.geoPointValue);case 9:return this.Wa(t.arrayValue,e);case 10:return this.Ka(t.mapValue,e);default:throw Sr()}},Dl.prototype.Ka=function(t,n){var r=this,i={};return jr(t.fields||{},function(t,e){i[t]=r.Ma(e,n)}),i},Dl.prototype.ja=function(t){return new sl(po(t.latitude),po(t.longitude))},Dl.prototype.Wa=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Ma(t,e)})},Dl.prototype.qa=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return ro(e)?t(e):e}(t);return null==n?null:this.Ma(n,e);case"estimate":return this.Ua(io(t));default:return null}},Dl.prototype.Ua=function(t){t=fo(t);return new Xr(t.seconds,t.nanos)},Dl.prototype.Ga=function(t,e){var n=Wr.L(t);Pr(Ho(n));t=new Ir(n.get(1),n.get(3)),n=new Kr(n.v(5));return t.isEqual(e)||Dr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Dl),Il=(n(kl,bl=Ie),kl.prototype.Ba=function(t){return new Tl(t)},kl.prototype.Qa=function(t){t=this.Ga(t,this.firestore.za);return rp.Ha(t,this.firestore,null)},kl),l=(Object.defineProperty(Ol.prototype,"id",{get:function(){return this.Xa.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(Ol.prototype,"ref",{get:function(){return new _l(this.Ya,this.th,this.Xa)},enumerable:!1,configurable:!0}),Ol.prototype.exists=function(){return null!==this.Za},Ol.prototype.data=function(){if(this.Za){if(this.th){var t=new Al(this.Ya,this.Ja,this.Xa,this.Za,null);return this.th.fromFirestore(t)}return this.Ja.Ma(this.Za.ie())}},Ol.prototype.get=function(t){if(this.Za){t=this.Za.data().field(Ll("DocumentSnapshot.get",t));if(null!==t)return this.Ja.Ma(t)}},Ol),Al=(n(Nl,wl=l),Nl.prototype.data=function(){return wl.prototype.data.call(this)},Nl);function Nl(){return null!==wl&&wl.apply(this,arguments)||this}function Ol(t,e,n,r,i){this.Ya=t,this.Ja=e,this.Xa=n,this.Za=r,this.th=i}function kl(t){var e=this;return(e=bl.call(this)||this).firestore=t,e}function Dl(){}function Rl(){return null!==El&&El.apply(this,arguments)||this}function Ll(t,e){return"string"==typeof e?af(t,e):(e instanceof Eh?e.va:e).nh}var Sl,Pl=(Ml.prototype.isEqual=function(t){return this.nh.isEqual(t.nh)},Ml),_l=(Object.defineProperty(jl.prototype,"eh",{get:function(){return this.Xa.path},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"id",{get:function(){return this.Xa.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"path",{get:function(){return this.Xa.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"parent",{get:function(){return new Ul(this.firestore,this.th,this.Xa.path.C())},enumerable:!1,configurable:!0}),jl.prototype.withConverter=function(t){return new jl(this.firestore,t,this.Xa)},jl),Cl=(xl.prototype.withConverter=function(t){return new xl(this.firestore,t,this.sh)},xl),Ul=(n(Vl,Sl=Cl),Object.defineProperty(Vl.prototype,"id",{get:function(){return this.sh.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"path",{get:function(){return this.sh.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"parent",{get:function(){var t=this.eh.C();return t.T()?null:new _l(this.firestore,null,new Kr(t))},enumerable:!1,configurable:!0}),Vl.prototype.withConverter=function(t){return new Vl(this.firestore,t,this.eh)},Vl);function Vl(t,e,n){var r=this;return(r=Sl.call(this,t,e,Zs(n))||this).firestore=t,r.eh=n,r.type="collection",r}function xl(t,e,n){this.th=e,this.sh=n,this.type="query",this.firestore=t}function jl(t,e,n){this.th=e,this.Xa=n,this.type="document",this.firestore=t}function Ml(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.nh=new Qr(t)}function Fl(t){var e=t.ih(),n=Na(t.za);return new Wl(t.za,!!e.ignoreUndefinedProperties,n)}var ql=/^__.*__$/,Gl=(Yl.prototype.rh=function(t,e){var n=[];return null!==this.jn?n.push(new Ns(t,this.data,this.jn,e)):n.push(new As(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ls(t,this.fieldTransforms)),n},Yl),Bl=(zl.prototype.rh=function(t,e){e=[new Ns(t,this.data,this.jn,e)];return 0<this.fieldTransforms.length&&e.push(new Ls(t,this.fieldTransforms)),e},zl);function zl(t,e,n){this.data=t,this.jn=e,this.fieldTransforms=n}function Yl(t,e,n){this.data=t,this.jn=e,this.fieldTransforms=n}function Xl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Sr()}}var Hl=(Object.defineProperty(Ql.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Ql.prototype.uh=function(t){return new Ql(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.jn)},Ql.prototype.ah=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.uh({path:e,Fa:!1});return e.hh(t),e},Ql.prototype.lh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.uh({path:t,Fa:!1});return t.oh(),t},Ql.prototype._h=function(t){return this.uh({path:void 0,Fa:!0})},Ql.prototype.Da=function(t){return cf(t,this.settings.methodName,this.settings.fh||!1,this.path,this.settings.Na)},Ql.prototype.contains=function(e){return void 0!==this.jn.find(function(t){return e.N(t)})||void 0!==this.fieldTransforms.find(function(t){return e.N(t.field)})},Ql.prototype.oh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.hh(this.path.get(t))},Ql.prototype.hh=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Xl(this.Sa)&&ql.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Ql),Wl=(Jl.prototype.dh=function(t,e,n,r){return void 0===r&&(r=!1),new Hl({Sa:t,methodName:e,Na:n,path:Qr.$(),Fa:!1,fh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Jl);function Jl(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Na(t)}function Ql(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.oh(),this.fieldTransforms=i||[],this.jn=o||[]}function Kl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.dh(o.merge||o.mergeFields?2:0,e,n,i);of("Data must be an object, but it was:",s,r);var u,a,r=nf(r,s);if(o.merge)u=new fs(s.jn),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=sf(e,l[h],n);if(!s.contains(f))throw new Yr(zr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");hf(c,f)||c.push(f)}u=new fs(c),a=s.fieldTransforms.filter(function(t){return u.Hn(t.field)})}else u=null,a=s.fieldTransforms;return new Gl(new xs(r),u,a)}function $l(t,r,i,e){var o=t.dh(1,r,i);of("Data must be an object, but it was:",o,e);var s=[],u=new js;jr(e,function(t,e){var n=af(r,t,i);e instanceof Eh&&(e=e.va);t=o.lh(n);e instanceof Jh?s.push(n):null!=(t=ef(e,t))&&(s.push(n),u.set(n,t))});e=new fs(s);return new Bl(u.Xn(),e,o.fieldTransforms)}function Zl(t,e,n,r,i,o){var s=t.dh(1,e,n),u=[sf(e,r,n)],a=[i];if(o.length%2!=0)throw new Yr(zr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(sf(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new js,v=u.length-1;0<=v;--v){hf(p,u[v])||(h=u[v],(l=a[v])instanceof Eh&&(l=l.va),f=s.lh(h),l instanceof Jh?p.push(h):null!=(f=ef(l,f))&&(p.push(h),d.set(h,f)))}i=new fs(p);return new Bl(d.Xn(),i,s.fieldTransforms)}function tf(t,e,n,r){return void 0===r&&(r=!1),ef(n,t.dh(r?4:3,e))}function ef(s,t){if(s instanceof Eh&&(s=s.va),rf(s))return of("Unsupported field value:",t,s),nf(s,t);if(s instanceof Wh)return function(t,e){if(!Xl(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");t=t.Ca(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.jn.push(t.path),s instanceof Array){if(t.settings.Fa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ef(i[r],t._h(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Eh&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ko(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Xr.fromDate(t);return{timestampValue:Do(e.serializer,n)}}if(t instanceof Xr){var r=new Xr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Do(e.serializer,r)}}if(t instanceof sl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ul)return{bytesValue:Ro(e.serializer,t.$a)};if(t instanceof _l){n=e.t,r=t.firestore.za;if(!r.isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:So(t.firestore.za||e.t,t.Xa.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+zh(t))}(s,t)}function nf(t,n){var r={};return Mr(t)?n.path&&0<n.path.length&&n.jn.push(n.path):jr(t,function(t,e){e=ef(e,n.ah(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function rf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Xr||t instanceof sl||t instanceof ul||t instanceof _l||t instanceof Wh)}function of(t,e,n){if(!rf(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=zh(n);throw"an object"===n?e.Da(t+" a custom object"):e.Da(t+" "+n)}var r}function sf(t,e,n){if(e instanceof Eh&&(e=e.va),e instanceof Pl)return e.nh;if("string"==typeof e)return af(t,e);throw cf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var uf=new RegExp("[~\\*/\\[\\]]");function af(e,n,r){if(0<=n.search(uf))throw cf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Pl.bind.apply(Pl,i([void 0],n.split("."))))).nh}catch(t){throw cf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function cf(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Yr(zr.INVALID_ARGUMENT,(e+=". ")+t+n)}function hf(t,e){return t.some(function(t){return t.isEqual(e)})}var lf=(yf.prototype.Ih=function(r){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Ah(),0<this.mutations.length)throw new Yr(zr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return v(this,void 0,void 0,function(){var n,e,r,i,o;return y(this,function(t){switch(t.label){case 0:return e=Vo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return _o(n.serializer,t)})},[4,n.Gr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=Co(t,e.found.name),t=Lo(e.found.updateTime),e=new xs({mapValue:{fields:e.found.fields}});return new Xs(n,t,e,{})}(e,t):"missing"in t?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);t=Co(t,e.missing),e=Lo(e.readTime);return new Hs(t,e)}(e,t):Sr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Pr(!!t),o.push(t)}),o)]}})})}(this.ro,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Hs||t instanceof Xs?n.Rh(t):Sr()}),e)]}})})},yf.prototype.set=function(t,e){this.write(e.rh(t,this.Gn(t))),this.mh.add(t.toString())},yf.prototype.update=function(t,e){try{this.write(e.rh(t,this.Ph(t)))}catch(t){this.Th=t}this.mh.add(t.toString())},yf.prototype.delete=function(t){this.write([new Us(t,this.Gn(t))]),this.mh.add(t.toString())},yf.prototype.commit=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Ah(),this.Th)throw this.Th;return e=this.wh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Kr.j(e);n.mutations.push(new Vs(e,n.Gn(e)))}),[4,function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=Vo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Mo(e.serializer,t)})},[4,e.Kr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ro,this.mutations)];case 1:return t.sent(),this.Eh=!0,[2]}})})},yf.prototype.Rh=function(t){var e;if(t instanceof Xs)e=t.version;else{if(!(t instanceof Hs))throw Sr();e=Hr.min()}var n=this.wh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(zr.ABORTED,"Document version changed between two reads.")}else this.wh.set(t.key.toString(),e)},yf.prototype.Gn=function(t){var e=this.wh.get(t.toString());return!this.mh.has(t.toString())&&e?vs.updateTime(e):vs.Yn()},yf.prototype.Ph=function(t){var e=this.wh.get(t.toString());if(this.mh.has(t.toString())||!e)return vs.exists(!0);if(e.isEqual(Hr.min()))throw new Yr(zr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)},yf.prototype.write=function(t){this.Ah(),this.mutations=this.mutations.concat(t)},yf.prototype.Ah=function(){},yf),ff=(vf.prototype.run=function(){this.yh()},vf.prototype.yh=function(){var t=this;this.Ye.Ae(function(){return v(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new lf(this.ro),(n=this.gh(e))&&n.then(function(t){r.Oe.Be(function(){return e.commit().then(function(){r.$e.resolve(t)}).catch(function(t){r.ph(t)})})}).catch(function(t){r.ph(t)}),[2]})})})},vf.prototype.gh=function(t){try{var e=this.updateFunction(t);return!si(e)&&e.catch&&e.then?e:(this.$e.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.$e.reject(t),null}},vf.prototype.ph=function(t){var e=this;0<this.Vh&&this.bh(t)?(--this.Vh,this.Oe.Be(function(){return e.yh(),Promise.resolve()})):this.$e.reject(t)},vf.prototype.bh=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!wi(t)},vf),pf=(df.prototype.getConfiguration=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Ls.promise];case 1:return[2,(t.sent(),{Oe:this.Oe,ta:this.ta,clientId:this.clientId,credentials:this.credentials,ma:this.user,Pu:100})]}})})},df.prototype.Sh=function(t){var e=this;this.Ch=t,this.Ls.promise.then(function(){return e.Ch(e.user)})},df.prototype.Dh=function(){if(this.Oe.Xe)throw new Yr(zr.FAILED_PRECONDITION,"The client has already been terminated.")},df.prototype.terminate=function(){var t=this;this.Oe.es();var n=new Yu;return this.Oe.Ze(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.Nh?[4,this.Nh.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Fh?[4,this.Fh.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.Os(),n.resolve(),[3,6];case 5:return e=t.sent(),e=na(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},df);function df(t,e,n){var r=this;this.credentials=t,this.Oe=e,this.ta=n,this.user=ca.UNAUTHENTICATED,this.clientId=_r.u(),this.Ch=function(){},this.Ls=new Yu,this.credentials.xs(function(t){kr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Ch(t)),r.Ls.resolve()})}function vf(t,e,n,r){this.Oe=t,this.ro=e,this.updateFunction=n,this.$e=r,this.Vh=5,this.Ye=new Xu(this.Oe,"transaction_retry")}function yf(t){this.ro=t,this.wh=new Map,this.mutations=[],this.Eh=!1,this.Th=null,this.mh=new Set}function gf(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.Fh?[3,2]:(kr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return r.Oe.us(),kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Sh(function(e){return r.Oe.ss(function(){return v(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,Ga(i.io,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Fc(function(){return r.terminate()}),r.Fh=i,[2]}})})}(e,new mh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Fh]}})})}function mf(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.Nh?[3,2]:(kr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return r.Oe.us(),[4,gf(r)];case 1:return e=t.sent(),kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Sh(function(t){return r.Oe.ss(function(){return function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=r).Oe.us(),kr("RemoteStore","RemoteStore received new credentials"),n=yc(e),e.ao.add(3),[4,cc(e)];case 1:return t.sent(),n&&e.fo.set("Unknown"),[4,e.oo.ya(i)];case 2:return t.sent(),e.ao.delete(3),[4,ac(e)];case 3:return t.sent(),[2]}})})}(i.Iu,t)})}),r.Nh=i,[2]}})})}(e,new wh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Nh]}})})}function wf(t){return gf(t).then(function(t){return t.persistence})}function bf(t){return gf(t).then(function(t){return t.io})}function Ef(t){return mf(t).then(function(t){return t.Iu})}function Tf(t){return mf(t).then(function(t){return t.Pa})}function If(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,mf(r)];case 1:return e=t.sent(),[2,((n=e.Au).ws=Gc.bind(null,e.Pa),n.Is=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).yu.get(o),1<(r=e.gu.get(n.targetId)).length?[2,(e.gu.set(n.targetId,r.filter(function(t){return!hu(t,o)})),void e.yu.delete(o))]:e.xu?(e.Ru.Ko(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Xa(e.io,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),lc(e.Iu,n.targetId),Jc(e,n.targetId)}).catch(Wa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Jc(e,n.targetId),[4,Xa(e.io,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function Af(n,r){var t=this,i=new Yu;return n.Oe.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Bc,[4,Tf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function Nf(i,o,s){return v(this,void 0,void 0,function(){var r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.ki.Xs(t,e)}))];case 1:return(r=t.sent())instanceof Xs?s.resolve(r):r instanceof Hs?s.resolve(null):s.reject(new Yr(zr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=na(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}function Of(n,r,i,o,s){var t=new bh({next:function(t){r.Be(function(){return sa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Yr(zr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Yr(zr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new aa(Zs(i.path),t,{includeMetadataChanges:!0,ps:!0});return oa(n,u)}var kf,Df=(Object.defineProperty(Lf.prototype,"app",{get:function(){if(!this.$h)throw new Yr(zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.$h},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"Mh",{get:function(){return this.kh},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"Uh",{get:function(){return void 0!==this.qh},enumerable:!1,configurable:!0}),Lf.prototype.Bh=function(t){if(this.kh)throw new Yr(zr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Oh=new cl(t),void 0!==t.credentials&&(this.Lh=function(t){if(!t)return new pa;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ya(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Yr(zr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Lf.prototype.Qh=function(){return this.Oh},Lf.prototype.ih=function(){return this.kh=!0,this.Oh},Lf.prototype._delete=function(){return this.qh||(this.qh=this.jh()),this.qh},Lf.prototype.jh=function(){return t=this,(e=al.get(t))&&(kr("ComponentProvider","Removing Datastore"),al.delete(t),e.terminate()),Promise.resolve();var t,e},n(Rf,kf=Lf),Rf.prototype.jh=function(){return this.Kh||Zf(this),this.Kh.terminate()},Rf);function Rf(t,e){var n=this;return(n=kf.call(this,t,e)||this).Wh=new Zu,n.xh="name"in t?t.name:"[DEFAULT]",n}function Lf(t,e){this.xh="(lite)",this.Oh=new cl({}),this.kh=!1,t instanceof Ir?(this.za=t,this.Lh=new pa):(this.$h=t,this.za=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Yr(zr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(t.options.projectId)}(t),this.Lh=new da(e))}var Sf,Pf,_f=(n(jf,Pf=l),jf.prototype.exists=function(){return Pf.prototype.exists.call(this)},jf.prototype.data=function(t){if(void 0===t&&(t={}),this.Za){if(this.th){var e=new Cf(this.Ya,this.Ja,this.Xa,this.Za,this.metadata,null);return this.th.fromFirestore(e,t)}return this.Ja.Ma(this.Za.ie(),t.serverTimestamps)}},jf.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Za){t=this.Za.data().field(Ll("DocumentSnapshot.get",t));if(null!==t)return this.Ja.Ma(t,e.serverTimestamps)}},jf),Cf=(n(xf,Sf=_f),xf.prototype.data=function(t){return void 0===t&&(t={}),Sf.prototype.data.call(this,t)},xf),Uf=(Object.defineProperty(Vf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"size",{get:function(){return this.zh.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Vf.prototype.forEach=function(e,n){var r=this;this.zh.docs.forEach(function(t){e.call(n,new Cf(r.Ya,r.Ja,t.key,t,new hp(r.zh.Qt.has(t.key),r.zh.fromCache),r.query.th))})},Vf.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.zh.Wt)throw new Yr(zr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Hh&&this.Yh===t||(this.Hh=function(i,e){if(i.zh.Bt.T()){var n=0;return i.zh.docChanges.map(function(t){var e=new Cf(i.Ya,i.Ja,t.doc.key,t.doc,new hp(i.zh.Qt.has(t.doc.key),i.zh.fromCache),i.query.th);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.zh.Bt;return i.zh.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Cf(i.Ya,i.Ja,t.doc.key,t.doc,new hp(i.zh.Qt.has(t.doc.key),i.zh.fromCache),i.query.th),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Yh=t),this.Hh},Vf);function Vf(t,e,n,r){this.Ya=t,this.Ja=e,this.zh=r,this.metadata=new hp(r.hasPendingWrites,r.fromCache),this.query=n}function xf(){return null!==Sf&&Sf.apply(this,arguments)||this}function jf(t,e,n,r,i,o){var s=this;return(s=Pf.call(this,t,e,n,r,o)||this).Ya=t,s.Gh=t,s.metadata=i,s}function Mf(t,e){return t instanceof _f&&e instanceof _f?t.Ya===e.Ya&&t.Xa.isEqual(e.Xa)&&(null===t.Za?null===e.Za:t.Za.isEqual(e.Za))&&t.th===e.th:t instanceof Uf&&e instanceof Uf&&t.Ya===e.Ya&&(n=t.query,r=e.query,n instanceof Cl&&r instanceof Cl&&n.firestore===r.firestore&&hu(n.sh,r.sh)&&n.th===r.th)&&t.metadata.isEqual(e.metadata)&&t.zh.isEqual(e.zh);var n,r}var Ff,qf=(n(Gf,Ff=Ie),Gf.prototype.Ba=function(t){return new ul(t)},Gf.prototype.Qa=function(t){t=this.Ga(t,this.firestore.za);return new _l(this.firestore,null,t)},Gf);function Gf(t){var e=this;return(e=Ff.call(this)||this).firestore=t,e}function Bf(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Yh(t.firestore,Df),s=Fl(o);return e instanceof Eh&&(e=e.va),zf(o,("string"==typeof e||e instanceof Pl?Zl(s,"updateDoc",t.Xa,e,n,r):$l(s,"updateDoc",t.Xa,e)).rh(t.Xa,vs.exists(!0)))}function zf(t,e){return Af($f(t),e)}function Yf(t,e,n){var r=n.docs.get(e.Xa),i=new qf(t);return new _f(t,i,e.Xa,r,new hp(n.hasPendingWrites,n.fromCache),e.th)}var Xf,Hf="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Wf=(Kf.prototype.enableIndexedDbPersistence=function(t,e){throw new Yr(zr.FAILED_PRECONDITION,Hf)},Kf.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Yr(zr.FAILED_PRECONDITION,Hf)},Kf.prototype.clearIndexedDbPersistence=function(t){throw new Yr(zr.FAILED_PRECONDITION,Hf)},Kf),Jf=(n(Qf,Xf=Eh),Object.defineProperty(Qf.prototype,"za",{get:function(){return this.va.za},enumerable:!1,configurable:!0}),Qf.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Qh()),t)).merge,this.va.Bh(t)},Qf.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Qh().host&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Qf.prototype.enableNetwork=function(){return function(r){var t=this;return r.Oe.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,wf(r)];case 1:return e=t.sent(),[4,Ef(r)];case 2:return n=t.sent(),[2,(e.xc(!0),(t=n).ao.delete(0),ac(t))]}})})})}($f(this.va))},Qf.prototype.disableNetwork=function(){return function(r){var t=this;return r.Oe.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,wf(r)];case 1:return e=t.sent(),[4,Ef(r)];case 2:return n=t.sent(),[2,(e.xc(!1),function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).ao.add(0),[4,cc(e)];case 1:return t.sent(),e.fo.set("Offline"),[2]}})})}(n))]}})})})}($f(this.va))},Qf.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Bh("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Jh.enableMultiTabIndexedDbPersistence(this):this.Jh.enableIndexedDbPersistence(this,n)},Qf.prototype.clearPersistence=function(){return this.Jh.clearIndexedDbPersistence(this)},Qf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},Qf.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Yu;return n.Oe.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Xc,[4,Tf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}($f(this.va))},Qf.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=$f(t),e=Oa(e)?e:{next:e},i=new bh(e);return t.Wh.Be(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ds.add(e),e.next()},[4,If(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.pa(),t.Wh.Be(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ds.delete(e)},[4,If(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(Qf.prototype,"app",{get:function(){if(!this.Xh)throw new Yr(zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Xh},enumerable:!1,configurable:!0}),Qf.prototype.collection=function(t){return qh("Firestore.collection","path",t),$f(this.va),new Op(Wr.L(t),this,null)},Qf.prototype.doc=function(t){return qh("Firestore.doc","path",t),$f(this.va),rp.Zh(Wr.L(t),this,null)},Qf.prototype.collectionGroup=function(t){if(qh("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return $f(this.va),new Ip((t=t,new Js(Wr.$(),t)),this,null)},Qf.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new Yu;return n.Oe.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,mf(n).then(function(t){return t.ro})];case 1:return e=t.sent(),new ff(n.Oe,e,r,i).run(),[2]}})})}),i.promise}($f(this.va),function(t){return e(new ep(n,t))})},Qf.prototype.batch=function(){return $f(this.va),new np(this)},Qf);function Qf(t,e,n){var r=this;return(r=Xf.call(this,e)||this).Jh=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ir||(r.Xh=t),r}function Kf(){}function $f(t){return t.Kh||Zf(t),t.Kh.Dh(),t.Kh}function Zf(t){var e,n,r=t.ih(),r=(e=t.za,n=t.xh,new Tr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Kh=new pf(t.Lh,t.Wh,r)}var tp,ep=(sp.prototype.get=function(t){var e=this,n=Sp(0,t,this.Ya),r=new Il(this.Ya);return this.tl.Ih([n.Xa]).then(function(t){if(!t||1!==t.length)return Sr();t=t[0];if(t instanceof Hs)return new lp(e.Ya,new _f(e.Ya.va,r,n.Xa,null,new hp(!1,!1),n.th));if(t instanceof Xs)return new lp(e.Ya,new _f(e.Ya.va,r,n.Xa,t,new hp(!1,!1),n.th));throw Sr()})},sp.prototype.set=function(t,e,n){t=Sp(0,t,this.Ya);n=Gh("Transaction.set",n);e=Pp(t.th,e,n),n=Kl(this.nl,"Transaction.set",t.Xa,e,null!==t.th,n);return this.tl.set(t.Xa,n),this},sp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Sp(0,t,this.Ya);return e instanceof Eh&&(e=e.va),e="string"==typeof e||e instanceof Pl?Zl(this.nl,"Transaction.update",t.Xa,e,n,r):$l(this.nl,"Transaction.update",t.Xa,e),this.tl.update(t.Xa,e),this},sp.prototype.delete=function(t){t=Sp(0,t,this.Ya);return this.tl.delete(t.Xa),this},sp),np=(op.prototype.set=function(t,e,n){this.il();t=Sp(0,t,this.Ya);n=Gh("WriteBatch.set",n);e=Pp(t.th,e,n),n=Kl(this.nl,"WriteBatch.set",t.Xa,e,null!==t.th,n);return this.el=this.el.concat(n.rh(t.Xa,vs.Yn())),this},op.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.il();t=Sp(0,t,this.Ya);return e instanceof Eh&&(e=e.va),e="string"==typeof e||e instanceof Pl?Zl(this.nl,"WriteBatch.update",t.Xa,e,n,r):$l(this.nl,"WriteBatch.update",t.Xa,e),this.el=this.el.concat(e.rh(t.Xa,vs.exists(!0))),this},op.prototype.delete=function(t){this.il();t=Sp(0,t,this.Ya);return this.el=this.el.concat(new Us(t.Xa,vs.Yn())),this},op.prototype.commit=function(){return this.il(),this.sl=!0,0<this.el.length?Af($f(this.Ya.va),this.el):Promise.resolve()},op.prototype.il=function(){if(this.sl)throw new Yr(zr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},op),rp=(n(ip,tp=Eh),ip.Zh=function(t,e,n){if(t.length%2!=0)throw new Yr(zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.k()+" has "+t.length);return new ip(e,new _l(e.va,n,new Kr(t)))},ip.Ha=function(t,e,n){return new ip(e,new _l(e.va,n,t))},Object.defineProperty(ip.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(ip.prototype,"parent",{get:function(){return new Op(this.va.eh.C(),this.firestore,this.va.th)},enumerable:!1,configurable:!0}),Object.defineProperty(ip.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),ip.prototype.collection=function(t){if(qh("DocumentReference.collection","path",t),!t)throw new Yr(zr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=Wr.L(t);return new Op(this.va.eh.child(t),this.firestore,null)},ip.prototype.isEqual=function(t){return t instanceof Eh&&(t=t.va),t instanceof _l&&(((e=this.va)instanceof _l||e instanceof Ul)&&(t instanceof _l||t instanceof Ul)&&e.firestore===t.firestore&&e.path===t.path&&e.th===t.th);var e},ip.prototype.set=function(t,e){e=Gh("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=Yh(n.firestore,Df),r=Pp(n.th,r,i),zf(o,Kl(Fl(o),"setDoc",n.Xa,r,null!==n.th,i).rh(n.Xa,vs.Yn()))}catch(t){throw up(t,"setDoc","DocumentReference.set")}var n,r,i,o},ip.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Bf(this.va,t):Bf.apply(void 0,i([this.va,t,e],n))}catch(t){throw up(t,"updateDoc","DocumentReference.update")}},ip.prototype.delete=function(){return zf(Yh((t=this.va).firestore,Df),[new Us(t.Xa,vs.Yn())]);var t},ip.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i,o=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!Oa(n))return n}return{}}(),n={next:function(t){i.next&&i.next(new lp(e.firestore,new _f(e.firestore.va,e.Ja,t.Xa,t.Za,t.metadata,e.va.th)))},error:null===(n=(i=Oa((n=r)[0])?n[0]:Oa(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(n=i.complete)||void 0===n?void 0:n.bind(i)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||Oa(n[o])||(i=n[o],o++);var s,u,a,c,h,l={includeMetadataChanges:i.includeMetadataChanges};Oa(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof _l?(s=Yh(e.firestore,Df),u=Zs(e.Xa.path),h={next:function(t){n[o]&&n[o](Yf(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Yh(e.firestore,Df),u=e.sh,c=new qf(s),h={next:function(t){n[o]&&n[o](new Uf(s,c,e,t))},error:n[o+1],complete:n[o+2]},wp(e.sh));var f=$f(s),p=new bh(h),d=new aa(u,p,l);return s.Wh.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=oa,[4,If(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.pa(),s.Wh.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=sa,[4,If(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}(this.va,o,n)},ip.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Yh(e.firestore,Df),r=$f(n),i=new qf(n),o=new Yu;return n.Wh.Be(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bf(r)];case 1:return[4,Nf(t.sent(),e.Xa,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new _f(n,i,e.Xa,t,new hp(t instanceof Xs&&t.Jn,!0),e.th)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Yh(e.firestore,Df),r=$f(n),i=new Yu;return n.Wh.Be(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,If(r)];case 1:return[4,Of(t.sent(),n.Wh,e.Xa,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Yf(n,e,t)})}:function(e){var t=this,n=Yh(e.firestore,Df),r=$f(n),i=new Yu;return n.Wh.Be(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,If(r)];case 1:return[4,Of(t.sent(),n.Wh,e.Xa,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Yf(n,e,t)})})(this.va).then(function(t){return new lp(e.firestore,new _f(e.firestore.va,e.Ja,t.Xa,t.Za,t.metadata,e.va.th))})},ip.prototype.withConverter=function(t){return new ip(this.firestore,this.va.withConverter(t))},ip);function ip(t,e){var n=this;return(n=tp.call(this,e)||this).firestore=t,n.Ja=new Il(t),n}function op(t){this.Ya=t,this.el=[],this.sl=!1,this.nl=Fl(this.Ya.va)}function sp(t,e){this.Ya=t,this.tl=e,this.nl=Fl(this.Ya.va)}function up(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var ap,cp,hp=(vp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},vp),lp=(n(dp,cp=Eh),Object.defineProperty(dp.prototype,"ref",{get:function(){return new rp(this.Ya,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),dp.prototype.data=function(t){return this.va.data(t)},dp.prototype.get=function(t,e){return this.va.get(t,e)},dp.prototype.isEqual=function(t){return Mf(this.va,t.va)},dp),fp=(n(pp,ap=lp),pp.prototype.data=function(t){return this.va.data(t)},pp);function pp(){return null!==ap&&ap.apply(this,arguments)||this}function dp(t,e){var n=this;return(n=cp.call(this,e)||this).Ya=t,n}function vp(t,e){this.hasPendingWrites=t,this.fromCache=e}function yp(t,e,n){if(n instanceof Eh&&(n=n.va),"string"==typeof n){if(""===n)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!iu(e)&&-1!==n.indexOf("/"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Wr.L(n));if(!Kr.G(e))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return yo(t,new Kr(e))}if(n instanceof _l)return yo(t,n.Xa);throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zh(n)+".")}function gp(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function mp(t,e,n){if(!n.isEqual(e))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function wp(t){if(eu(t)&&0===t.re.length)throw new Yr(zr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bp,Ep,Tp,Ip=(Lp.prototype.where=function(t,e,n){t=sf("Query.where",t),e=function(t,e,n,r,i,o){if(r.U()){if("array-contains"===i||"array-contains-any"===i)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){gp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(yp(n,t,c))}h={arrayValue:{values:s}}}else h=yp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||gp(o,i),h=tf(e,"Query.where",o,"in"===i||"not-in"===i);var h=yu.create(r,i,h);return function(t,e){if(e.ce()){var n=ru(t);if(null!==n&&!n.isEqual(e.field))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=nu(t);null!==n&&mp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Yr(zr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(zr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.sh,this.rl,this.firestore.za,t,e,n);return new Lp((n=this.sh,e=n.filters.concat([e]),new Js(n.path,n.collectionGroup,n.re.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.th)},Lp.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yr(zr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=sf("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new zu(e,n);return n=e,null!==nu(t)||null!==(t=ru(t))&&mp(0,t,n.field),e}(this.sh,t,n);return new Lp((n=this.sh,t=n.re.concat([t]),new Js(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.th)},Lp.prototype.limit=function(t){return Xh("Query.limit",t),new Lp(uu(this.sh,t,"F"),this.firestore,this.th)},Lp.prototype.limitToLast=function(t){return Xh("Query.limitToLast",t),new Lp(uu(this.sh,t,"L"),this.firestore,this.th)},Lp.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ol("Query.startAt",t,e,!0);return new Lp(au(this.sh,t),this.firestore,this.th)},Lp.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ol("Query.startAfter",t,e,!1);return new Lp(au(this.sh,t),this.firestore,this.th)},Lp.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ol("Query.endBefore",t,e,!0);return new Lp(cu(this.sh,t),this.firestore,this.th)},Lp.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ol("Query.endAt",t,e,!1);return new Lp(cu(this.sh,t),this.firestore,this.th)},Lp.prototype.isEqual=function(t){return t instanceof Lp&&this.firestore===t.firestore&&hu(this.sh,t.sh)&&this.th===t.th},Lp.prototype.withConverter=function(t){return new Lp(this.sh,this.firestore,t)},Lp.prototype.ol=function(c,t,e,n){if(t instanceof lp)return function(t,e,n,r){if(!n)throw new Yr(zr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ou(t);o<s.length;o++){var u=s[o];if(u.field.U())i.push(yo(e,n.key));else{var a=n.field(u.field);if(ro(a))throw new Yr(zr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.k();throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Vu(i,r)}(this.sh,this.firestore.za,t.va.Za,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.re;if(i.length>s.length)throw new Yr(zr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.U()){if("string"!=typeof c)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!iu(t)&&-1!==c.indexOf("/"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Wr.L(c));if(!Kr.G(h))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Kr(h);u.push(yo(e,h))}else{c=tf(n,r,c);u.push(c)}}return new Vu(u,o)}(this.sh,this.firestore.za,this.rl,c,e,n)},Lp.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||Oa(n[s])||(o=n[s],s++),Oa(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new Np(e.firestore,new Uf(e.firestore.va,e.Ja,new Cl(e.firestore.va,e.th,e.sh),t)))},error:n[s+1],complete:n[s+2]};return wp(this.sh),function(n,t,e){var r=this,i=new bh(u),o=new aa(t,i,e);return n.Oe.Be(function(){return v(r,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=oa,[4,If(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.pa(),n.Oe.Be(function(){return v(r,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=sa,[4,If(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}($f(this.firestore.va),this.sh,o)},Lp.prototype.get=function(t){var e=this;wp(this.sh);var n=$f(this.firestore.va);return(t&&"cache"===t.source?function(n,r){var t=this,i=new Yu;return n.Oe.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ha(r,i,!0)];case 1:return n=t.sent(),e=new Pc(i,n.lr),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=na(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,bf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.sh):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Yu;return n.Oe.Be(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new bh({next:function(t){n.Be(function(){return sa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Yr(zr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new aa(t,o,{includeMetadataChanges:!0,ps:!0});return oa(e,s)},[4,If(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Oe,r,i,o])]}})})}),o.promise}(n,this.sh,t)).then(function(t){return new Np(e.firestore,new Uf(e.firestore.va,e.Ja,new Cl(e.firestore.va,e.th,e.sh),t))})},Lp),Ap=(n(Rp,Tp=Eh),Object.defineProperty(Rp.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"doc",{get:function(){return new fp(this.Ya,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"newIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Rp),Np=(n(Dp,Ep=Eh),Object.defineProperty(Dp.prototype,"query",{get:function(){return new Ip(this.va.query.sh,this.Ya,this.va.query.th)},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new fp(e.Ya,t)})},enumerable:!1,configurable:!0}),Dp.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new Ap(e.Ya,t)})},Dp.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new fp(r.Ya,t))})},Dp.prototype.isEqual=function(t){return Mf(this.va,t.va)},Dp),Op=(n(kp,bp=Ip),Object.defineProperty(kp.prototype,"id",{get:function(){return this.sh.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(kp.prototype,"parent",{get:function(){var t=this.sh.path.C();return t.T()?null:rp.Zh(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(kp.prototype,"path",{get:function(){return this.sh.path.k()},enumerable:!1,configurable:!0}),kp.prototype.doc=function(t){0===arguments.length&&(t=_r.u()),qh("CollectionReference.doc","path",t);t=Wr.L(t);return rp.Zh(this.sh.path.child(t),this.firestore,this.th)},kp.prototype.add=function(t){var t=this.th?this.th.toFirestore(t):t,e=this.doc();return rp.Ha(e.va.Xa,this.firestore,null).set(t).then(function(){return e})},kp.prototype.withConverter=function(t){return new kp(this.eh,this.firestore,t)},kp);function kp(t,e,n){var r=this;if(((r=bp.call(this,Zs(t),e,n)||this).eh=t).length%2!=1)throw new Yr(zr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.k()+" has "+t.length);return r}function Dp(t,e){var n=this;return(n=Ep.call(this,e)||this).Ya=t,n}function Rp(t,e){var n=this;return(n=Tp.call(this,e)||this).Ya=t,n}function Lp(t,e,n){this.sh=t,this.firestore=e,this.th=n,this.rl=Fl(e.va),this.Ja=new Il(e)}function Sp(t,e,n){e=Yh(e,_l);if(e.firestore!==n.va)throw new Yr(zr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Pp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var _p,Cp,Up,l=(n(jp,Cp=Eh),jp.documentId=function(){return new jp(Qr.q().k())},jp.prototype.isEqual=function(t){return t instanceof Eh&&(t=t.va),t instanceof Pl&&this.va.nh.isEqual(t.nh)},jp),Ie=(n(xp,_p=Eh),xp.serverTimestamp=function(){var t=new nl("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new xp(t)},xp.delete=function(){var t=new Jh("deleteField");return t.ba="FieldValue.delete",new xp(t)},xp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rl("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new xp(n)},xp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new il("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new xp(n)},xp.increment=function(t){t=new ol("increment",t);return t.ba="FieldValue.increment",new xp(t)},xp.prototype.isEqual=function(t){return this.va.isEqual(t.va)},xp),Vp={Firestore:Jf,GeoPoint:sl,Timestamp:Xr,Blob:Tl,Transaction:ep,WriteBatch:np,DocumentReference:rp,DocumentSnapshot:lp,Query:Ip,QueryDocumentSnapshot:fp,QuerySnapshot:Np,CollectionReference:Op,FieldPath:l,FieldValue:Ie,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function xp(){return null!==_p&&_p.apply(this,arguments)||this}function jp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cp.call(this,new(Pl.bind.apply(Pl,i([void 0],t))))||this}(Up=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Jf(e,new Df(e,t),new Wf);var e},"PUBLIC").setServiceProps(Object.assign({},Vp))),Up.registerVersion("@firebase/firestore","2.0.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
